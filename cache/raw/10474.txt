## SEARCH

## MENU

- [打赏](https://kexue.fm/reward.html)
- [公式](https://kexue.fm/latex.html)
- [天象](https://kexue.fm/ac.html)
- [链接](https://kexue.fm/links.html)
- [时光](https://kexue.fm/me.html)
- [博览](https://kexue.fm/science.html)
- [归档](https://kexue.fm/content.html)

## CATEGORIES

- [千奇百怪](https://kexue.fm/category/Everything)
- [天文探索](https://kexue.fm/category/Astronomy)
- [数学研究](https://kexue.fm/category/Mathematics)
- [物理化学](https://kexue.fm/category/Phy-chem)
- [信息时代](https://kexue.fm/category/Big-Data)
- [生物自然](https://kexue.fm/category/Biology)
- [图片摄影](https://kexue.fm/category/Photograph)
- [问题百科](https://kexue.fm/category/Questions)
- [生活/情感](https://kexue.fm/category/Life-Feeling)
- [资源共享](https://kexue.fm/category/Resources)

## NEWPOSTS

- [msign的导数](https://kexue.fm/archives/11025)
- [通过msign来计算mclip（奇...](https://kexue.fm/archives/11006)
- [msign算子的Newton-Sc...](https://kexue.fm/archives/10996)
- [等值振荡定理：最优多项式逼近的充要条件](https://kexue.fm/archives/10972)
- [生成扩散模型漫谈（三十）：从瞬时速...](https://kexue.fm/archives/10958)
- [MoE环游记：5、均匀分布的反思](https://kexue.fm/archives/10945)
- [msign算子的Newton-Sc...](https://kexue.fm/archives/10922)
- [Transformer升级之路：2...](https://kexue.fm/archives/10907)
- [一道概率不等式：盯着它到显然成立为止！](https://kexue.fm/archives/10902)
- [SVD的导数](https://kexue.fm/archives/10878)

## COMMENTS

- [rpsun: 老师您好，最近在自己的任务上尝试了muon，甚至只修改了学习率...](https://kexue.fm/archives/10592/comment-page-2#comment-27912)
- [盏一: 我之前做的笔记:Q: 公式 (14) 的理解.A: 首先基于 ...](https://kexue.fm/archives/8265/comment-page-8#comment-27911)
- [盏一: 哦哦哦 你是说 $\\exp nB$ 是正交矩阵! 并不是说 B.](https://kexue.fm/archives/8397/comment-page-3#comment-27910)
- [盏一: 呃, 是我脑子乱了... 忘了 $\\exp(0) = I$. ...](https://kexue.fm/archives/8397/comment-page-3#comment-27908)
- [盏一: 苏神, 请教一下\> 并且还可以证明它一定是正交矩阵是怎么证明的...](https://kexue.fm/archives/8397/comment-page-3#comment-27907)
- [sk: 请问公式14是怎么得出来的？](https://kexue.fm/archives/8265/comment-page-8#comment-27906)
- [tll1945tll1937: 真心实意的向大家请教问题：看了文章“对齐全量微调！这是我看过最...](https://kexue.fm/archives/10266/comment-page-1#comment-27901)
- [oYo\_logan: \[comment=27017\]苏剑林\[/comment\]苏神，...](https://kexue.fm/archives/10757/comment-page-1#comment-27897)
- [z123: 在参数矩阵较多的CNN小模型上，Muon会明显慢于Adam，这...](https://kexue.fm/archives/10592/comment-page-1#comment-27896)
- [dry: 苏神好，一直有个疑问，ReFlow构建的ODE是$dx\_t/d...](https://kexue.fm/archives/10958/comment-page-2#comment-27895)

## USERLOGIN

- [登录](https://kexue.fm/admin/login.php)

[科学空间\|Scientific Spaces](https://kexue.fm)

- [登录](https://kexue.fm/admin/login.php)
- [打赏](https://kexue.fm/reward.html)
- [公式](https://kexue.fm/latex.html)
- [天象](https://kexue.fm/ac.html)
- [链接](https://kexue.fm/links.html)
- [时光](https://kexue.fm/me.html)
- [博览](https://kexue.fm/science.html)
- [归档](https://kexue.fm/content.html)

渴望成为一个小飞侠

- [欢迎订阅](https://kexue.fm/feed)
- [个性邮箱](https://kexue.fm/archives/119)
- [天象信息](https://kexue.fm/ac.html)
- [观测ISS](https://kexue.fm/archives/41)
- [LaTeX](https://kexue.fm/latex.html)
- [关于博主](https://kexue.fm/me.html)

欢迎访问“科学空间”，这里将与您共同探讨自然科学，回味人生百态；也期待大家的分享～

- [**千奇百怪** Everything](https://kexue.fm/category/Everything)
- [**天文探索** Astronomy](https://kexue.fm/category/Astronomy)
- [**数学研究** Mathematics](https://kexue.fm/category/Mathematics)
- [**物理化学** Phy-chem](https://kexue.fm/category/Phy-chem)
- [**信息时代** Big-Data](https://kexue.fm/category/Big-Data)
- [**生物自然** Biology](https://kexue.fm/category/Biology)
- [**图片摄影** Photograph](https://kexue.fm/category/Photograph)
- [**问题百科** Questions](https://kexue.fm/category/Questions)
- [**生活/情感** Life-Feeling](https://kexue.fm/category/Life-Feeling)
- [**资源共享** Resources](https://kexue.fm/category/Resources)

- [**千奇百怪**](https://kexue.fm/category/Everything)
- [**天文探索**](https://kexue.fm/category/Astronomy)
- [**数学研究**](https://kexue.fm/category/Mathematics)
- [**物理化学**](https://kexue.fm/category/Phy-chem)
- [**信息时代**](https://kexue.fm/category/Big-Data)
- [**生物自然**](https://kexue.fm/category/Biology)
- [**图片摄影**](https://kexue.fm/category/Photograph)
- [**问题百科**](https://kexue.fm/category/Questions)
- [**生活/情感**](https://kexue.fm/category/Life-Feeling)
- [**资源共享**](https://kexue.fm/category/Resources)

[首页](https://kexue.fm) [信息时代](https://kexue.fm/category/Big-Data) [问题百科](https://kexue.fm/category/Questions) 让MathJax的数学公式随窗口大小自动缩放

15Oct

# [让MathJax的数学公式随窗口大小自动缩放](https://kexue.fm/archives/10474)

By 苏剑林 \|
2024-10-15 \|
19854位读者\|

随着MathJax的出现和流行，在网页上显示数学公式便逐渐有了标准答案。然而，MathJax（包括其竞品KaTeX）只是负责将网页LaTeX代码转化为数学公式，对于自适应分辨率方面依然没有太好的办法。像本站一些数学文章，因为是在PC端排版好的，所以在PC端浏览效果尚可，但转到手机上看就可能有点难以入目了。

经过测试，笔者得到了一个方案，让MathJax的数学公式也能像图片一样，随着窗口大小而自适应缩放，从而尽量保证移动端的显示效果，在此跟大家分享一波。

## 背景思路 [\#](https://kexue.fm/archives/10474\#%E8%83%8C%E6%99%AF%E6%80%9D%E8%B7%AF)

这个问题的起源是，即便在PC端进行排版，有时候也会遇到一些单行公式的长度超出了网页宽度，但又不大好换行的情况，这时候一个解决方案是用HTML代码手动调整一下公式的字体大小，比如

```
 
 \begin{equation}一个超长的数学公式\end{equation}
 
```

这样就将数学公式大小调整为原来的90%，基本能解决大部分问题，但手动调整终究是有点麻烦，90%这个数字需要人工调试几次才能得到最优值，并且只能适应单一宽度。前几天突然意识到一个问题：为什么数学公式不能像图片一样设置一个max-width来自动缩放大小呢？比如下面的图片代码

```
 
```

实现的效果就是图片大小在不超过上级元素的前提下尽可能接近400px。测试了一翻，MathJax的数学公式是文本的block，没有现成的方法可以实现类似图片的max-width缩放特性，但我们可以通过JS来计算公式超出上级元素宽度的比例，然后自动给数学公式设置font-size来实现同样的效果。

## 代码参考 [\#](https://kexue.fm/archives/10474\#%E4%BB%A3%E7%A0%81%E5%8F%82%E8%80%83)

首先给出最终的参考答案，用如下的代码替换掉原本MathJax配置代码：

```
 
 MathJax.Hub.Config({
 tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
 TeX: {equationNumbers: {autoNumber: ["AMS"], useLabelIds: true}, extensions: ["AMSmath.js", "AMSsymbols.js", "extpfeil.js"]},
 "HTML-CSS": {noReflows: false, availableFonts: ["tex"], styles: {".MathJax_Display": {margin: "1em 0em 0.7em;", display: "inline-block!important;"}}},
 "CommonHTML": {noReflows: false, availableFonts: ["tex"], styles: {".MJXc-display": {margin: "1em 0em 0.7em;", display: "inline-block!important;"}}},
 "SVG": {noReflows: false, availableFonts: ["tex"], styles: {".MathJax_SVG_Display": {margin: "1em 0em 0.7em;", display: "inline-block!important;"}}}
 });
 MathJax.Hub.Queue(function() {
 document.querySelectorAll('span[id^="MathJax-Element"]').forEach(function(e) {
 parentWidth = e.parentNode.offsetWidth;
 if (e.parentNode.className.endsWith('isplay')) {
 parentWidth = e.parentNode.parentNode.offsetWidth;
 }
 if (e.offsetWidth > parentWidth) {
 e.style.fontSize = parentWidth * 100 / e.offsetWidth + '%';
 }
 });
 });
 
```

相比在 [《让MathJax更好地兼容谷歌翻译和延时加载》](https://kexue.fm/archives/10320) 提到的配置代码，它有两个关键变化。首先是去掉了配置项 `{linebreaks: {automatic: true, width: "95% container"}`，这个配置项的作用是自动换行，原本用意就是提高对分辨率的自适应能力，但实际上用途不大，很多写好的数学公式如果自动换行的话反而不好看了，所以去掉自动换行才能保证数学公式在不同宽度下的一致性。

接下来的关键改动就是 `MathJax.Hub.Queue` 部分了，这是公式渲染完毕后执行的函数，它首先找到所有id以“MathJax-Element”开头的span，这就是所有的数学公式，然后通过 `e.offsetWidth` 获取它的宽度，以及通过 `e.parentNode.offsetWidth` 或 `e.parentNode.parentNode.offsetWidth` 获取它的上级宽度，根据这个结果计算和设置font-size要缩小的比例。

什么时候用 `e.parentNode.offsetWidth` 或 `e.parentNode.parentNode.offsetWidth` 呢？数学公式分“行内公式”和“单行公式”，“行内公式”就直接用前者而“单行公式”则用后者。在代码上，“单行公式”多嵌套了一层div，所以祖父节点才是上级元素，而div的class以Display或display结束，所以就加了个 `e.parentNode.className.endsWith('isplay')` 的判据。

以上就是参考代码的所有原理。

## 文章小结 [\#](https://kexue.fm/archives/10474\#%E6%96%87%E7%AB%A0%E5%B0%8F%E7%BB%93)

本文分享了一种让MathJax公式自动随着窗口大小而缩放的方案，能够尽可能兼容移动端设备的窄屏浏览需求。经过调整之后，即便在小屏幕下也能显示出跟PC端一样的数学公式——除了可能有点费眼睛，但用来应应急总是可以的。

修改后的窄屏显示效果

_**转载到请包括本文地址：** [https://kexue.fm/archives/10474](https://kexue.fm/archives/10474)_

_**更详细的转载事宜请参考：**_ [《科学空间FAQ》](https://kexue.fm/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8)

**如果您还有什么疑惑或建议，欢迎在下方评论区继续讨论。**

**如果您觉得本文还不错，欢迎 [分享](https://kexue.fm/archives/10474#share)/ [打赏](https://kexue.fm/archives/10474#pay) 本文。打赏并非要从中获得收益，而是希望知道科学空间获得了多少读者的真心关注。当然，如果你无视它，也不会影响你的阅读。再次表示欢迎和感谢！**

打赏

微信打赏

支付宝打赏

因为网站后台对打赏并无记录，因此欢迎在打赏时候备注留言。你还可以 [**点击这里**](http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=tN7d1drY3drrx8H0xcWa19vZ) 或在下方评论区留言来告知你的建议或需求。

**如果您需要引用本文，请参考：**

苏剑林. (Oct. 15, 2024). 《让MathJax的数学公式随窗口大小自动缩放 》\[Blog post\]. Retrieved from [https://kexue.fm/archives/10474](https://kexue.fm/archives/10474)

@online{kexuefm-10474,
        title={让MathJax的数学公式随窗口大小自动缩放},
        author={苏剑林},
        year={2024},
        month={Oct},
        url={\\url{https://kexue.fm/archives/10474}},
}

分类： [信息时代](https://kexue.fm/category/Big-Data), [问题百科](https://kexue.fm/category/Questions)    标签： [网站](https://kexue.fm/tag/%E7%BD%91%E7%AB%99/), [latex](https://kexue.fm/tag/latex/)[3 评论](https://kexue.fm/archives/10474#comments)

< [低秩近似之路（三）：CR](https://kexue.fm/archives/10427) \| [Cool Papers浏览器扩展升级至v0.2.0](https://kexue.fm/archives/10480) >

### 你也许还对下面的内容感兴趣

- [Cool Papers浏览器扩展升级至v0.2.0](https://kexue.fm/archives/10480)
- [近乎完美地解决MathJax与Marked的冲突](https://kexue.fm/archives/10332)
- [让MathJax更好地兼容谷歌翻译和延时加载](https://kexue.fm/archives/10320)
- [“Cool Papers + 站内搜索”的一些新尝试](https://kexue.fm/archives/10311)
- [Cool Papers更新：简单搭建了一个站内检索系统](https://kexue.fm/archives/10088)
- [更便捷的Cool Papers打开方式：Chrome重定向扩展](https://kexue.fm/archives/9978)
- [新年快乐！记录一下 Cool Papers 的开发体验](https://kexue.fm/archives/9920)
- [写了个刷论文的辅助网站：Cool Papers](https://kexue.fm/archives/9907)
- [科学空间浏览指南（FAQ）](https://kexue.fm/archives/6508)
- [网站更新记录（2018年01月）](https://kexue.fm/archives/5066)

[发表你的看法](https://kexue.fm/archives/10474#comment_form)

breezewu

April 1st, 2025

怎么在chrome选择打印成pdf的时候也能适配这个就好了。否则现在打印成适合kindle看的尺寸大小的pdf，但是公式就会被裁剪

[回复评论](https://kexue.fm/archives/10474/comment-page-1?replyTo=27298#respond-post-10474)

Namoe 发表于
April 2nd, 2025

分享一下我现在的打印方案：
1\. 获取博客的markdown格式输入：使用edge浏览器的沉浸式阅读功能，在本文链接前面加上 read: 并打开
2\. markdown转latex，使用Gemini 2.0 Flash，根据自制的markdown转latex的prompt进行转换
3\. latex放进overleaf编译生成pdf（需要微调）

[回复评论](https://kexue.fm/archives/10474/comment-page-1?replyTo=27301#respond-post-10474)

[苏剑林](https://kexue.fm) 发表于
April 3rd, 2025

如果在PC浏览器中打印，可以先将浏览器窗口调整到适合大小，然后刷新页面，这时候的公式就会按照你的窗口大小来缩放，然后打印就不会被裁剪了。

关键是先调整窗口大小，然后刷新页面才会触发缩放；如果已经打开了页面后，再调整窗口大小，是不会触发的（必须刷新）。

[回复评论](https://kexue.fm/archives/10474/comment-page-1?replyTo=27314#respond-post-10474)

[取消回复](https://kexue.fm/archives/10474#respond-post-10474)

你的大名

电子邮箱

个人网站（选填）

1\. 可以使用LaTeX代码，点击“预览效果”可查看效果；2. 可以通过点击评论楼层编号来引用该楼层；3. 网站可能会有点卡，如非确认评论失败，请 **不要重复点击提交**。

### 内容速览

[背景思路](https://kexue.fm/archives/10474#%E8%83%8C%E6%99%AF%E6%80%9D%E8%B7%AF)
[代码参考](https://kexue.fm/archives/10474#%E4%BB%A3%E7%A0%81%E5%8F%82%E8%80%83)
[文章小结](https://kexue.fm/archives/10474#%E6%96%87%E7%AB%A0%E5%B0%8F%E7%BB%93)

### 智能搜索

支持整句搜索！网站自动使用 [结巴分词](https://github.com/fxsjy/jieba) 进行分词，并结合ngrams排序算法给出合理的搜索结果。

### 热门标签

[生成模型](https://kexue.fm/tag/%E7%94%9F%E6%88%90%E6%A8%A1%E5%9E%8B/) [attention](https://kexue.fm/tag/attention/) [优化](https://kexue.fm/tag/%E4%BC%98%E5%8C%96/) [语言模型](https://kexue.fm/tag/%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B/) [模型](https://kexue.fm/tag/%E6%A8%A1%E5%9E%8B/) [网站](https://kexue.fm/tag/%E7%BD%91%E7%AB%99/) [概率](https://kexue.fm/tag/%E6%A6%82%E7%8E%87/) [梯度](https://kexue.fm/tag/%E6%A2%AF%E5%BA%A6/) [转载](https://kexue.fm/tag/%E8%BD%AC%E8%BD%BD/) [微分方程](https://kexue.fm/tag/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/) [矩阵](https://kexue.fm/tag/%E7%9F%A9%E9%98%B5/) [天象](https://kexue.fm/tag/%E5%A4%A9%E8%B1%A1/) [分析](https://kexue.fm/tag/%E5%88%86%E6%9E%90/) [深度学习](https://kexue.fm/tag/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/) [积分](https://kexue.fm/tag/%E7%A7%AF%E5%88%86/) [python](https://kexue.fm/tag/python/) [优化器](https://kexue.fm/tag/%E4%BC%98%E5%8C%96%E5%99%A8/) [力学](https://kexue.fm/tag/%E5%8A%9B%E5%AD%A6/) [无监督](https://kexue.fm/tag/%E6%97%A0%E7%9B%91%E7%9D%A3/) [扩散](https://kexue.fm/tag/%E6%89%A9%E6%95%A3/) [几何](https://kexue.fm/tag/%E5%87%A0%E4%BD%95/) [节日](https://kexue.fm/tag/%E8%8A%82%E6%97%A5/) [生活](https://kexue.fm/tag/%E7%94%9F%E6%B4%BB/) [文本生成](https://kexue.fm/tag/%E6%96%87%E6%9C%AC%E7%94%9F%E6%88%90/) [数论](https://kexue.fm/tag/%E6%95%B0%E8%AE%BA/)

### 随机文章

- [用时间换取效果：Keras梯度累积优化器](https://kexue.fm/archives/6794)
- [从loss的硬截断、软化到focal loss](https://kexue.fm/archives/4733)
- [ARXIV数学论文分布：偏微分方程最热门！](https://kexue.fm/archives/3511)
- [【不可思议的Word2Vec】 3.提取关键词](https://kexue.fm/archives/4316)
- [多标签“Softmax+交叉熵”的软标签版本](https://kexue.fm/archives/9064)
- [矩阵的有效秩（Effective Rank）](https://kexue.fm/archives/10847)
- [相对运动的一道妙题！](https://kexue.fm/archives/1795)
- [《向量》系列——5.平面向量微分方程与复数](https://kexue.fm/archives/963)
- [SVD分解(二)：为什么SVD意味着聚类？](https://kexue.fm/archives/4216)
- [运动相机测试：家乡的星空](https://kexue.fm/archives/3887)

### 最近评论

- [rpsun](https://kexue.fm/archives/10592/comment-page-2#comment-27912): 老师您好，最近在自己的任务上尝试了muon，甚至只修改了学习率，同时不加区分地对所有二维以上的...
- [盏一](https://kexue.fm/archives/8265/comment-page-8#comment-27911): 我之前做的笔记:Q: 公式 (14) 的理解.A: 首先基于 \[定理 5\](https://b...
- [盏一](https://kexue.fm/archives/8397/comment-page-3#comment-27910): 哦哦哦 你是说 $\\exp nB$ 是正交矩阵! 并不是说 B.
- [盏一](https://kexue.fm/archives/8397/comment-page-3#comment-27908): 呃, 是我脑子乱了... 忘了 $\\exp(0) = I$. 所以只要 $\\Vert B^T+...
- [盏一](https://kexue.fm/archives/8397/comment-page-3#comment-27907): 苏神, 请教一下\> 并且还可以证明它一定是正交矩阵是怎么证明的. 我本来以为隐式利用了 $\\V...
- [sk](https://kexue.fm/archives/8265/comment-page-8#comment-27906): 请问公式14是怎么得出来的？
- [tll1945tll1937](https://kexue.fm/archives/10266/comment-page-1#comment-27901): 真心实意的向大家请教问题：看了文章“对齐全量微调！这是我看过最精彩的LoRA改进（二）”，我实...
- [oYo\_logan](https://kexue.fm/archives/10757/comment-page-1#comment-27897): \[comment=27017\]苏剑林\[/comment\]苏神，想请教一下，我理解在一个batc...
- [z123](https://kexue.fm/archives/10592/comment-page-1#comment-27896): 在参数矩阵较多的CNN小模型上，Muon会明显慢于Adam，这方面有什么优化提速的方案吗？
- [dry](https://kexue.fm/archives/10958/comment-page-2#comment-27895): 苏神好，一直有个疑问，ReFlow构建的ODE是$dx\_t/dt=x\_1-x\_0$，为什么这并...

### 友情链接

- [Cool Papers](https://papers.cool)
- [数学研发](https://bbs.emath.ac.cn)
- [Seatop](http://www.seatop.com.cn/)
- [Xiaoxia](https://xiaoxia.org/)
- [积分表-网络版](https://kexue.fm/sci/integral/index.html)
- [丝路博傲](http://blog.dvxj.com/)
- [ph4ntasy 饭特稀](http://www.ph4ntasy.com/)
- [数学之家](http://www.2math.cn/)
- [有趣天文奇观](http://interesting-sky.china-vo.org/)
- [TwistedW](http://www.twistedwg.com/)
- [godweiyang](https://godweiyang.com/)
- [AI柠檬](https://blog.ailemon.net/)
- [王登科-DK博客](https://greatdk.com)
- [ESON](https://blog.eson.org/)
- [枫之羽](https://fzhiy.net/)
- [Mathor's blog](https://wmathor.com/)
- [coding-zuo](https://coding-zuo.github.io/)
- [博科园](https://www.bokeyuan.net/)
- [孔皮皮的博客](https://www.kppkkp.top/)
- [运鹏的博客](https://yunpengtai.top/)
- [jiming.site](https://jiming.site/)
- [OmegaXYZ](https://www.omegaxyz.com/)
- [Blog by Eacls](https://www.eacls.top/)
- [EAI猩球](https://www.robotech.ink/)
- [文举的博客](https://liwenju0.com/)
- [用代码打点酱油](https://bruceyuan.com/)
- [申请链接](https://kexue.fm/links.html)

本站采用创作共用版权协议，要求署名、非商业用途和保持一致。转载本站内容必须也遵循“ [署名-非商业用途-保持一致](http://creativecommons.org/licenses/by-nc-nd/2.5/cn/)”的创作共用协议。
© 2009-2025 Scientific Spaces. All rights reserved. Theme by [laogui](http://www.laogui.com). Powered by [Typecho](http://typecho.org). 备案号: [粤ICP备09093259号-1/2](https://beian.miit.gov.cn/)。