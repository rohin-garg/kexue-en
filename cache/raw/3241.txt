## SEARCH

## MENU

- [打赏](https://kexue.fm/reward.html)
- [公式](https://kexue.fm/latex.html)
- [天象](https://kexue.fm/ac.html)
- [链接](https://kexue.fm/links.html)
- [时光](https://kexue.fm/me.html)
- [博览](https://kexue.fm/science.html)
- [归档](https://kexue.fm/content.html)

## CATEGORIES

- [千奇百怪](https://kexue.fm/category/Everything)
- [天文探索](https://kexue.fm/category/Astronomy)
- [数学研究](https://kexue.fm/category/Mathematics)
- [物理化学](https://kexue.fm/category/Phy-chem)
- [信息时代](https://kexue.fm/category/Big-Data)
- [生物自然](https://kexue.fm/category/Biology)
- [图片摄影](https://kexue.fm/category/Photograph)
- [问题百科](https://kexue.fm/category/Questions)
- [生活/情感](https://kexue.fm/category/Life-Feeling)
- [资源共享](https://kexue.fm/category/Resources)

## NEWPOSTS

- [MuP之上：1. 好模型的三个特征](https://kexue.fm/archives/11340)
- [随机矩阵的谱范数的快速估计](https://kexue.fm/archives/11335)
- [DiVeQ：一种非常简洁的VQ训练方案](https://kexue.fm/archives/11328)
- [为什么线性注意力要加Short C...](https://kexue.fm/archives/11320)
- [AdamW的Weight RMS的...](https://kexue.fm/archives/11307)
- [重新思考学习率与Batch Siz...](https://kexue.fm/archives/11301)
- [重新思考学习率与Batch Siz...](https://kexue.fm/archives/11285)
- [重新思考学习率与Batch Siz...](https://kexue.fm/archives/11280)
- [为什么Adam的Update RM...](https://kexue.fm/archives/11267)
- [重新思考学习率与Batch Siz...](https://kexue.fm/archives/11260)

## COMMENTS

- [苏剑林: 精度也是一个视角，但感觉这个事情感觉得仔细分析一下，因为理论上...](https://kexue.fm/archives/11340/comment-page-1#comment-28680)
- [苏剑林: 可以这样理解：$t$时刻的$\\boldsymbol{x}\_t$...](https://kexue.fm/archives/9257/comment-page-4#comment-28679)
- [苏剑林: 没有太多技巧了，就是直接代入然后根据$\\bar{\\alpha}...](https://kexue.fm/archives/9181/comment-page-5#comment-28678)
- [苏剑林: 完全懵了...WukT是什么？如果代表C到key的投影矩阵，那...](https://kexue.fm/archives/10862/comment-page-1#comment-28677)
- [Zhan-Wang Mao: 苏老师，请教一下(4)式的泰勒展开式为什么严格来说和$t$有关...](https://kexue.fm/archives/9257/comment-page-4#comment-28676)
- [yzlnew: 可以相呼应的是，这样的好模型能被浮点数以误差比较低的方式表示和...](https://kexue.fm/archives/11340/comment-page-1#comment-28675)
- [Henry: 想请问苏老师，方程7是如何推导到方程10的，是否有化简的一些小技巧？](https://kexue.fm/archives/9181/comment-page-5#comment-28673)
- [szsheep: 牛啊，还可以从这方面推出loss的函数最终式。原本是从KL散度...](https://kexue.fm/archives/9119/comment-page-13#comment-28672)
- [pang: 对于目前的MLA算法softmax(X×WQ×WukT×CjT...](https://kexue.fm/archives/10862/comment-page-1#comment-28671)
- [苏剑林: 你是说 chatglm2-6b 里边的？那个没用，预设的常数是...](https://kexue.fm/archives/11126/comment-page-3#comment-28670)

## USERLOGIN

- [登录](https://kexue.fm/admin/login.php)

[科学空间\|Scientific Spaces](https://kexue.fm)

- [登录](https://kexue.fm/admin/login.php)
- [打赏](https://kexue.fm/reward.html)
- [公式](https://kexue.fm/latex.html)
- [天象](https://kexue.fm/ac.html)
- [链接](https://kexue.fm/links.html)
- [时光](https://kexue.fm/me.html)
- [博览](https://kexue.fm/science.html)
- [归档](https://kexue.fm/content.html)

渴望成为一个小飞侠

- [欢迎订阅](https://kexue.fm/feed)
- [个性邮箱](https://kexue.fm/archives/119)
- [天象信息](https://kexue.fm/ac.html)
- [观测ISS](https://kexue.fm/archives/41)
- [LaTeX](https://kexue.fm/latex.html)
- [关于博主](https://kexue.fm/me.html)

欢迎访问“科学空间”，这里将与您共同探讨自然科学，回味人生百态；也期待大家的分享～

- [**千奇百怪** Everything](https://kexue.fm/category/Everything)
- [**天文探索** Astronomy](https://kexue.fm/category/Astronomy)
- [**数学研究** Mathematics](https://kexue.fm/category/Mathematics)
- [**物理化学** Phy-chem](https://kexue.fm/category/Phy-chem)
- [**信息时代** Big-Data](https://kexue.fm/category/Big-Data)
- [**生物自然** Biology](https://kexue.fm/category/Biology)
- [**图片摄影** Photograph](https://kexue.fm/category/Photograph)
- [**问题百科** Questions](https://kexue.fm/category/Questions)
- [**生活/情感** Life-Feeling](https://kexue.fm/category/Life-Feeling)
- [**资源共享** Resources](https://kexue.fm/category/Resources)

- [**千奇百怪**](https://kexue.fm/category/Everything)
- [**天文探索**](https://kexue.fm/category/Astronomy)
- [**数学研究**](https://kexue.fm/category/Mathematics)
- [**物理化学**](https://kexue.fm/category/Phy-chem)
- [**信息时代**](https://kexue.fm/category/Big-Data)
- [**生物自然**](https://kexue.fm/category/Biology)
- [**图片摄影**](https://kexue.fm/category/Photograph)
- [**问题百科**](https://kexue.fm/category/Questions)
- [**生活/情感**](https://kexue.fm/category/Life-Feeling)
- [**资源共享**](https://kexue.fm/category/Resources)

[首页](https://kexue.fm) [数学研究](https://kexue.fm/category/Mathematics) 高斯型积分的微扰展开（二）

7Mar

# [高斯型积分的微扰展开（二）](https://kexue.fm/archives/3241)

By 苏剑林 \|
2015-03-07 \|
26766位读者\|

### 为什么第二篇姗姗来迟？ [\#](https://kexue.fm/kexue.fm\#%E4%B8%BA%E4%BB%80%E4%B9%88%E7%AC%AC%E4%BA%8C%E7%AF%87%E5%A7%97%E5%A7%97%E6%9D%A5%E8%BF%9F%EF%BC%9F)

其实要写这系列之前，我已经构思好了接下来几篇的内容，本来想要自信地介绍自己想到的一些积分展开的技巧；而且摄动法我本身就比较熟悉，所以正常来说不会这么迟才有第二篇。然而，在我写完第一篇，准备写第二篇的期间，我看到了知乎上的这篇回复：
[http://www.zhihu.com/question/24735673](http://www.zhihu.com/question/24735673)

这篇文章大大地拓展了我对级数的认识。里边谈及到了积分的展开是一个渐近级数。这让我犹豫了，怀疑这系列有没有价值，因为渐近级数意味着不管怎样的展开技巧，得到的级数收敛半径都是0。

后来再想想，就算是渐近级数，也有改进的空间，有加速收敛的方法，所以我想我这几篇文章，应该还有一点点意义吧，还可以顺便介绍一下渐近级数和奇点的相关理论。嗯，就这么办吧。

### 在指数中逐阶展开 [\#](https://kexue.fm/kexue.fm\#%E5%9C%A8%E6%8C%87%E6%95%B0%E4%B8%AD%E9%80%90%E9%98%B6%E5%B1%95%E5%BC%80)

前一篇文章已经提到的技巧就是对常系数进行变易，通过调整变量使得一阶项为0，该方法主要问题就是不能逐阶地求出高阶近似。然而，它的思想是很不错的，即引入可调整的变量，让展开的各阶项为0，而不要纯粹地做幂级数展开。下面，我们先来试着把展开式放到指数中去，得到一个可以逐级求近似的方法，作为我们以后要进一步发展的方法的原始模型。

总的来说，我们要求积分
$$\\int\_{-\\infty}^{+\\infty} e^{-a x^2-\\varepsilon x^4} dx$$

上一篇文章中，我们希望用积分$\\int\_{-\\infty}^{+\\infty} e^{-A x^2} dx$来逼近它，逼近的思路是通过调整$A$来使得一阶项为0，但这样子我们只能做到这里的，因为只有一个可调整变量，一般来讲只能让一项为0。为了实现逐阶展开，即引入多个可调整的量，我们设
$$A=a+a\_1 \\varepsilon + a\_2\\varepsilon^2 + a\_3 \\varepsilon^3 + \\dots$$
然后考虑
$$\\int\_{-\\infty}^{+\\infty} \\left\[e^{-a x^2-\\varepsilon x^4}-e^{-(a+a\_1 \\varepsilon + a\_2\\varepsilon^2 + a\_3 \\varepsilon^3 + \\dots)x^2}\\right\] dx$$
将括号内的被积函数按$\\varepsilon$的阶展开，就有
$$\\begin{aligned}x^2 e^{-a x^2} \\left(a\_1-x^2\\right)\\varepsilon &+ \\frac{1}{2} x^2 e^{-a x^2} \\left(-a\_1^2 x^2+2 a\_2+x^6\\right)\\varepsilon^2 \\\&- \\frac{1}{6} x^2 e^{-a x^2} \\left(-a\_1^3 x^4+6 a\_1 a\_2 x^2-6 a\_3+x^{10}\\right)\\varepsilon+\\dots\\end{aligned}$$
逐项积分，就有
$$\\begin{aligned}\\sqrt{\\frac{\\pi}{a} }&\\left\[\\frac{1}{4}(2 a a\_1 -3)\\left(\\frac{\\varepsilon}{a^2} \\right)+\\frac{1}{32}\\left(4 a^2 \\left(4 a a\_2-3 a\_1^2\\right)+105\\right)\\left(\\frac{\\varepsilon}{a^2} \\right)^2\\right.\\\
&\\left.+\\frac{1}{128}\\left(3465-8 a^3 \\left(8 a^2 a\_3-12 a a\_1 a\_2+5 a\_1^3\\right)\\right)\\left(\\frac{\\varepsilon}{a^2} \\right)^3+\\dots\\right\]\\end{aligned}$$
让每项为0，得到方程组
$$\\left\\{\\begin{aligned}&2 a a\_1 -3=0\\\
&4 a^2 \\left(4 a a\_2-3 a\_1^2\\right)+105=0\\\
&3465-8 a^3 \\left(8 a^2 a\_3-12 a a\_1 a\_2+5 a\_1^3\\right)=0\\\
&\\dots\\end{aligned}\\right.$$
解得
$$a\_1=\\frac{3}{2 a},\\,a\_2=-\\frac{39}{8 a^3},\\,a\_3=\\frac{657}{16 a^5},\\,\\dots$$
所以我们有级数
$$\\begin{aligned}&\\int\_{-\\infty}^{+\\infty} e^{-a x^2-\\varepsilon x^4} dx \\\
=&\\int\_{-\\infty}^{+\\infty} e^{-\\left(a+\\frac{3}{2}\\frac{\\varepsilon}{a}-\\frac{39}{8}\\frac{\\varepsilon^2}{a^3}+\\frac{657}{16}\\frac{\\varepsilon^3}{a^5}\\dots\\right)x^2} dx\\\=&\\sqrt{\\frac{\\pi}{a+\\frac{3}{2}\\frac{\\varepsilon}{a}-\\frac{39}{8}\\frac{\\varepsilon^2}{a^3}+\\frac{657}{16}\\frac{\\varepsilon^3}{a^5}\\dots}}\\end{aligned}\\tag{5}$$
这是关于原积分的有一个渐近表达式。$(5)$式效果比$(3)$式好一些；相比于$(4)$式，当$\\varepsilon/a^2$很小的时候，截断$(5)$的前几项进行计算，能够得到比$(4)$式更多位有效数字。当然，它在$a\\to 0$或者$\\varepsilon\\to \\infty$时则失效了——不过就算是失效，它也只是得到一个有限的0，而不是其它不确定的结果。这也是这种展开方式的好处之一。

### 渐近级数的意义 [\#](https://kexue.fm/kexue.fm\#%E6%B8%90%E8%BF%91%E7%BA%A7%E6%95%B0%E7%9A%84%E6%84%8F%E4%B9%89)

已经说过，取无穷多项时，渐近级数的收敛半径实际是0，那么渐近级数还有什么意义呢？事实上，首先，对于近似计算来说，可以截断渐近级数的前几项，从而对于某个范围的自变量得到一个比较不错的近似值。其次，对于某些渐近级数，我们可以通过再求和的技巧，来还原它的原始级数，从而得到精确解——量子场论中有大量的例子！

所以，我们需要渐近级数，同时，还可以考虑改进渐近级数的方式（即降低发散速度）。有各种各样的技巧可以做这样的事情，只要你有足够多的创意。在下一篇文章中，我们会再展示一次。

_**转载到请包括本文地址：** [https://kexue.fm/archives/3241](https://kexue.fm/archives/3241)_

_**更详细的转载事宜请参考：**_ [《科学空间FAQ》](https://kexue.fm/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8)

**如果您还有什么疑惑或建议，欢迎在下方评论区继续讨论。**

**如果您觉得本文还不错，欢迎 [分享](https://kexue.fm/kexue.fm#share)/ [打赏](https://kexue.fm/kexue.fm#pay) 本文。打赏并非要从中获得收益，而是希望知道科学空间获得了多少读者的真心关注。当然，如果你无视它，也不会影响你的阅读。再次表示欢迎和感谢！**

打赏

微信打赏

支付宝打赏

因为网站后台对打赏并无记录，因此欢迎在打赏时候备注留言。你还可以 [**点击这里**](http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=tN7d1drY3drrx8H0xcWa19vZ) 或在下方评论区留言来告知你的建议或需求。

**如果您需要引用本文，请参考：**

苏剑林. (Mar. 07, 2015). 《高斯型积分的微扰展开（二） 》\[Blog post\]. Retrieved from [https://kexue.fm/archives/3241](https://kexue.fm/archives/3241)

@online{kexuefm-3241,
        title={高斯型积分的微扰展开（二）},
        author={苏剑林},
        year={2015},
        month={Mar},
        url={\\url{https://kexue.fm/archives/3241}},
}

分类： [数学研究](https://kexue.fm/category/Mathematics)    标签： [积分](https://kexue.fm/tag/%E7%A7%AF%E5%88%86/), [摄动](https://kexue.fm/tag/%E6%91%84%E5%8A%A8/), [微扰](https://kexue.fm/tag/%E5%BE%AE%E6%89%B0/), [渐近级数](https://kexue.fm/tag/%E6%B8%90%E8%BF%91%E7%BA%A7%E6%95%B0/)[抢沙发](https://kexue.fm/archives/3241#comments)

< [从Knotsevich在黑板上写的级数题目谈起](https://kexue.fm/archives/3229) \| [你所没有思考过的平行线问题](https://kexue.fm/archives/3243) >

### 你也许还对下面的内容感兴趣

- [积分梯度：一种新颖的神经网络可视化方法](https://kexue.fm/archives/7533)
- [为什么勒贝格积分比黎曼积分强？](https://kexue.fm/archives/4083)
- [【外微分浅谈】5\. 几何意义](https://kexue.fm/archives/4062)
- [差分方程的摄动法](https://kexue.fm/archives/3889)
- [斯特灵(stirling)公式与渐近级数](https://kexue.fm/archives/3731)
- [积分估计的极值原理——变分原理的初级版本](https://kexue.fm/archives/3630)
- [封闭曲线所围成的面积：一个新技巧](https://kexue.fm/archives/3441)
- [高斯型积分的微扰展开（三）](https://kexue.fm/archives/3280)
- [采样定理：有限个点构建出整个函数](https://kexue.fm/archives/3266)
- [从Knotsevich在黑板上写的级数题目谈起](https://kexue.fm/archives/3229)

[发表你的看法](https://kexue.fm/kexue.fm#comment_form)

[取消回复](https://kexue.fm/archives/3241#respond-post-3241)

你的大名

电子邮箱

个人网站（选填）

1\. 可以使用LaTeX代码，点击“预览效果”可查看效果；2. 可以通过点击评论楼层编号来引用该楼层；3. 网站可能会有点卡，如非确认评论失败，请 **不要重复点击提交**。

### 内容速览

[为什么第二篇姗姗来迟？](https://kexue.fm/kexue.fm#%E4%B8%BA%E4%BB%80%E4%B9%88%E7%AC%AC%E4%BA%8C%E7%AF%87%E5%A7%97%E5%A7%97%E6%9D%A5%E8%BF%9F%EF%BC%9F)
[在指数中逐阶展开](https://kexue.fm/kexue.fm#%E5%9C%A8%E6%8C%87%E6%95%B0%E4%B8%AD%E9%80%90%E9%98%B6%E5%B1%95%E5%BC%80)
[渐近级数的意义](https://kexue.fm/kexue.fm#%E6%B8%90%E8%BF%91%E7%BA%A7%E6%95%B0%E7%9A%84%E6%84%8F%E4%B9%89)

### 智能搜索

支持整句搜索！网站自动使用 [结巴分词](https://github.com/fxsjy/jieba) 进行分词，并结合ngrams排序算法给出合理的搜索结果。

### 热门标签

[生成模型](https://kexue.fm/tag/%E7%94%9F%E6%88%90%E6%A8%A1%E5%9E%8B/) [attention](https://kexue.fm/tag/attention/) [优化](https://kexue.fm/tag/%E4%BC%98%E5%8C%96/) [语言模型](https://kexue.fm/tag/%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B/) [模型](https://kexue.fm/tag/%E6%A8%A1%E5%9E%8B/) [网站](https://kexue.fm/tag/%E7%BD%91%E7%AB%99/) [概率](https://kexue.fm/tag/%E6%A6%82%E7%8E%87/) [梯度](https://kexue.fm/tag/%E6%A2%AF%E5%BA%A6/) [矩阵](https://kexue.fm/tag/%E7%9F%A9%E9%98%B5/) [转载](https://kexue.fm/tag/%E8%BD%AC%E8%BD%BD/) [优化器](https://kexue.fm/tag/%E4%BC%98%E5%8C%96%E5%99%A8/) [微分方程](https://kexue.fm/tag/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/) [分析](https://kexue.fm/tag/%E5%88%86%E6%9E%90/) [天象](https://kexue.fm/tag/%E5%A4%A9%E8%B1%A1/) [深度学习](https://kexue.fm/tag/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/) [积分](https://kexue.fm/tag/%E7%A7%AF%E5%88%86/) [python](https://kexue.fm/tag/python/) [力学](https://kexue.fm/tag/%E5%8A%9B%E5%AD%A6/) [无监督](https://kexue.fm/tag/%E6%97%A0%E7%9B%91%E7%9D%A3/) [扩散](https://kexue.fm/tag/%E6%89%A9%E6%95%A3/) [几何](https://kexue.fm/tag/%E5%87%A0%E4%BD%95/) [节日](https://kexue.fm/tag/%E8%8A%82%E6%97%A5/) [生活](https://kexue.fm/tag/%E7%94%9F%E6%B4%BB/) [文本生成](https://kexue.fm/tag/%E6%96%87%E6%9C%AC%E7%94%9F%E6%88%90/) [数论](https://kexue.fm/tag/%E6%95%B0%E8%AE%BA/)

### 随机文章

- [幂等生成网络IGN：试图将判别和生成合二为一的GAN](https://kexue.fm/archives/9969)
- [我们可以无损放大一个Transformer模型吗（一）](https://kexue.fm/archives/8444)
- [“n次方程有n个根”的证明](https://kexue.fm/archives/481)
- [傅里叶变换：只需要异想天开？](https://kexue.fm/archives/2555)
- [向量结合复数：常曲率曲线(1)](https://kexue.fm/archives/1381)
- [将“Softmax+交叉熵”推广到多标签分类问题](https://kexue.fm/archives/7359)
- [一本对称闯物理：相对论力学(二)](https://kexue.fm/archives/2512)
- [一道整数边三角形题目](https://kexue.fm/archives/1417)
- [威力巨大的“有向线段”](https://kexue.fm/archives/689)
- [祝大家端午节快乐！](https://kexue.fm/archives/681)

### 最近评论

- [苏剑林](https://kexue.fm/archives/11340/comment-page-1#comment-28680): 精度也是一个视角，但感觉这个事情感觉得仔细分析一下，因为理论上来讲，整体乘一个大数字，是不改变...
- [苏剑林](https://kexue.fm/archives/9257/comment-page-4#comment-28679): 可以这样理解：$t$时刻的$\\boldsymbol{x}\_t$，和$t-1$时刻的$\\bold...
- [苏剑林](https://kexue.fm/archives/9181/comment-page-5#comment-28678): 没有太多技巧了，就是直接代入然后根据$\\bar{\\alpha}\_t,\\bar{\\beta}\_t...
- [苏剑林](https://kexue.fm/archives/10862/comment-page-1#comment-28677): 完全懵了...WukT是什么？如果代表C到key的投影矩阵，那Wropeq和Wropekt又是...
- [Zhan-Wang Mao](https://kexue.fm/archives/9257/comment-page-4#comment-28676): 苏老师，请教一下(4)式的泰勒展开式为什么严格来说和$t$有关？不是在$x\_t$处关于$x$的...
- [yzlnew](https://kexue.fm/archives/11340/comment-page-1#comment-28675): 可以相呼应的是，这样的好模型能被浮点数以误差比较低的方式表示和训练，并且也易于量化。
- [Henry](https://kexue.fm/archives/9181/comment-page-5#comment-28673): 想请问苏老师，方程7是如何推导到方程10的，是否有化简的一些小技巧？
- [szsheep](https://kexue.fm/archives/9119/comment-page-13#comment-28672): 牛啊，还可以从这方面推出loss的函数最终式。原本是从KL散度入手，没想到作者完全用另外一种方...
- [pang](https://kexue.fm/archives/10862/comment-page-1#comment-28671): 对于目前的MLA算法softmax(X×WQ×WukT×CjT)×Cj×Wuv来说其实X,WQ...
- [苏剑林](https://kexue.fm/archives/11126/comment-page-3#comment-28670): 你是说 chatglm2-6b 里边的？那个没用，预设的常数是压不住的...

### 友情链接

- [Cool Papers](https://papers.cool)
- [数学研发](https://bbs.emath.ac.cn)
- [Seatop](http://www.seatop.com.cn/)
- [Xiaoxia](https://xiaoxia.org/)
- [积分表-网络版](https://kexue.fm/sci/integral/index.html)
- [丝路博傲](http://blog.dvxj.com/)
- [数学之家](http://www.2math.cn/)
- [有趣天文奇观](http://interesting-sky.china-vo.org/)
- [TwistedW](http://www.twistedwg.com/)
- [godweiyang](https://godweiyang.com/)
- [AI柠檬](https://blog.ailemon.net/)
- [王登科-DK博客](https://greatdk.com)
- [ESON](https://blog.eson.org/)
- [枫之羽](https://fzhiy.net/)
- [Mathor's blog](https://wmathor.com/)
- [coding-zuo](https://coding-zuo.github.io/)
- [博科园](https://www.bokeyuan.net/)
- [孔皮皮的博客](https://www.kppkkp.top/)
- [运鹏的博客](https://yunpengtai.top/)
- [jiming.site](https://jiming.site/)
- [OmegaXYZ](https://www.omegaxyz.com/)
- [EAI猩球](https://www.robotech.ink/)
- [文举的博客](https://liwenju0.com/)
- [用代码打点酱油](https://bruceyuan.com/)
- [Zhang's blog](https://armcvai.cn/)
- [申请链接](https://kexue.fm/links.html)

本站采用创作共用版权协议，要求署名、非商业用途和保持一致。转载本站内容必须也遵循“ [署名-非商业用途-保持一致](http://creativecommons.org/licenses/by-nc-nd/2.5/cn/)”的创作共用协议。
© 2009-2025 Scientific Spaces. All rights reserved. Theme by [laogui](http://www.laogui.com). Powered by [Typecho](http://typecho.org). 备案号: [粤ICP备09093259号-1/2](https://beian.miit.gov.cn/)。