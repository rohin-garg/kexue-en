Processing math: 2%

![MobileSideBar](https://kexue.fm/usr/themes/geekg/images/slide-button.png)

## SEARCH

## MENU

- [打赏](https://kexue.fm/reward.html)
- [公式](https://kexue.fm/latex.html)
- [天象](https://kexue.fm/ac.html)
- [链接](https://kexue.fm/links.html)
- [时光](https://kexue.fm/me.html)
- [博览](https://kexue.fm/science.html)
- [归档](https://kexue.fm/content.html)

## CATEGORIES

- [千奇百怪](https://kexue.fm/category/Everything)
- [天文探索](https://kexue.fm/category/Astronomy)
- [数学研究](https://kexue.fm/category/Mathematics)
- [物理化学](https://kexue.fm/category/Phy-chem)
- [信息时代](https://kexue.fm/category/Big-Data)
- [生物自然](https://kexue.fm/category/Biology)
- [图片摄影](https://kexue.fm/category/Photograph)
- [问题百科](https://kexue.fm/category/Questions)
- [生活/情感](https://kexue.fm/category/Life-Feeling)
- [资源共享](https://kexue.fm/category/Resources)

## NEWPOSTS

- [让炼丹更科学一些（五）：基于梯度精...](https://kexue.fm/archives/11530)
- [让炼丹更科学一些（四）：新恒等式，...](https://kexue.fm/archives/11494)
- [为什么DeltaNet要加L2 N...](https://kexue.fm/archives/11486)
- [让炼丹更科学一些（三）：SGD的终...](https://kexue.fm/archives/11480)
- [让炼丹更科学一些（二）：将结论推广...](https://kexue.fm/archives/11469)
- [滑动平均视角下的权重衰减和学习率](https://kexue.fm/archives/11459)
- [生成扩散模型漫谈（三十一）：预测数...](https://kexue.fm/archives/11428)
- [Muon优化器指南：快速上手与关键细节](https://kexue.fm/archives/11416)
- [AdamW的Weight RMS的...](https://kexue.fm/archives/11404)
- [n个正态随机数的最大值的渐近估计](https://kexue.fm/archives/11390)

## COMMENTS

- [Bin: 今天偶然从某个论坛看到有人推荐您的博客，定睛一看竟然是华师同院...](https://kexue.fm/archives/1990/comment-page-2#comment-29105)
- [Rapture D: 我有一个问题，为什么不考虑亥姆霍兹定理和斯托克斯公式。](https://kexue.fm/archives/11530/comment-page-1#comment-29104)
- [mofheka: 苏神是还在用jax是么？最近在做基于Google Pathwa...](https://kexue.fm/archives/11390/comment-page-1#comment-29103)
- [长琴: 看懂这篇博客也不是一件容易的事情。](https://kexue.fm/archives/11530/comment-page-1#comment-29102)
- [AlexLi: 苏老师，请教一下(7)式中将 μ(xt) 传给 $p...](https://kexue.fm/archives/9257/comment-page-4#comment-29101)
- [tyler\_zxc: "Performer的思想是将标准的Attention线性化，...](https://kexue.fm/archives/7921/comment-page-2#comment-29100)
- [我: 似乎并非mHC提出矩阵的思想？之前hyper connecti...](https://kexue.fm/archives/11494/comment-page-1#comment-29099)
- [winter: 苏神您好，假如对于比较均匀的attention weightP...](https://kexue.fm/archives/10847/comment-page-1#comment-29098)
- [苏剑林: KL散度、JS散度、W距离啥的，都行啊，看你喜欢哪个](https://kexue.fm/archives/8512/comment-page-2#comment-29097)
- [苏剑林: 没有绝对公平的对比方法，主要看你关心什么。比如，如果只关心推理...](https://kexue.fm/archives/9119/comment-page-14#comment-29096)

## USERLOGIN

- [登录](https://kexue.fm/admin/login.php)

[科学空间\|Scientific Spaces](https://kexue.fm/)

- [登录](https://kexue.fm/admin/login.php)
- [打赏](https://kexue.fm/reward.html)
- [公式](https://kexue.fm/latex.html)
- [天象](https://kexue.fm/ac.html)
- [链接](https://kexue.fm/links.html)
- [时光](https://kexue.fm/me.html)
- [博览](https://kexue.fm/science.html)
- [归档](https://kexue.fm/content.html)

渴望成为一个小飞侠

- [![](https://kexue.fm/usr/themes/geekg/images/rss.png)\\
\\
欢迎订阅](https://kexue.fm/feed)
- [![](https://kexue.fm/usr/themes/geekg/images/mail.png)\\
\\
个性邮箱](https://kexue.fm/archives/119)
- [![](https://kexue.fm/usr/themes/geekg/images/Saturn.png)\\
\\
天象信息](https://kexue.fm/ac.html)
- [![](https://kexue.fm/usr/themes/geekg/images/iss.png)\\
\\
观测ISS](https://kexue.fm/archives/41)
- [![](https://kexue.fm/usr/themes/geekg/images/pi.png)\\
\\
LaTeX](https://kexue.fm/latex.html)
- [![](https://kexue.fm/usr/themes/geekg/images/mlogo.png)\\
\\
关于博主](https://kexue.fm/me.html)

欢迎访问“科学空间”，这里将与您共同探讨自然科学，回味人生百态；也期待大家的分享～

- [**千奇百怪** Everything](https://kexue.fm/category/Everything)
- [**天文探索** Astronomy](https://kexue.fm/category/Astronomy)
- [**数学研究** Mathematics](https://kexue.fm/category/Mathematics)
- [**物理化学** Phy-chem](https://kexue.fm/category/Phy-chem)
- [**信息时代** Big-Data](https://kexue.fm/category/Big-Data)
- [**生物自然** Biology](https://kexue.fm/category/Biology)
- [**图片摄影** Photograph](https://kexue.fm/category/Photograph)
- [**问题百科** Questions](https://kexue.fm/category/Questions)
- [**生活/情感** Life-Feeling](https://kexue.fm/category/Life-Feeling)
- [**资源共享** Resources](https://kexue.fm/category/Resources)

- [**千奇百怪**](https://kexue.fm/category/Everything)
- [**天文探索**](https://kexue.fm/category/Astronomy)
- [**数学研究**](https://kexue.fm/category/Mathematics)
- [**物理化学**](https://kexue.fm/category/Phy-chem)
- [**信息时代**](https://kexue.fm/category/Big-Data)
- [**生物自然**](https://kexue.fm/category/Biology)
- [**图片摄影**](https://kexue.fm/category/Photograph)
- [**问题百科**](https://kexue.fm/category/Questions)
- [**生活/情感**](https://kexue.fm/category/Life-Feeling)
- [**资源共享**](https://kexue.fm/category/Resources)

[首页](https://kexue.fm/) [数学研究](https://kexue.fm/category/Mathematics) [信息时代](https://kexue.fm/category/Big-Data) 貌离神合的RNN与ODE：花式RNN简介

23Jun

# [貌离神合的RNN与ODE：花式RNN简介](https://kexue.fm/archives/5643)

By 苏剑林 \|
2018-06-23 \|
140251位读者 \|

本来笔者已经决心不玩RNN了，但是在上个星期思考时忽然意识到RNN实际上对应了ODE（常微分方程）的数值解法，这为我一直以来想做的事情——用深度学习来解决一些纯数学问题——提供了思路。事实上这是一个颇为有趣和有用的结果，遂介绍一翻。顺便地， **本文也涉及到了自己动手编写RNN的内容，所以本文也可以作为编写自定义的RNN层的一个简单教程**。

注：本文并非前段时间的热点“ [神经ODE](https://arxiv.org/pdf/1806.07366.pdf)”的介绍（但有一定的联系）。

## RNN基本 [\#](https://kexue.fm/archives/5643\#RNN%E5%9F%BA%E6%9C%AC)

### 什么是RNN？ [\#](https://kexue.fm/archives/5643\#%E4%BB%80%E4%B9%88%E6%98%AFRNN%EF%BC%9F)

众所周知，RNN是“循环神经网络（Recurrent Neural Network）”，跟CNN不同，RNN可以说是一类模型的总称，而并非单个模型。简单来讲，只要是输入向量序列(\\boldsymbol{x}\_1,\\boldsymbol{x}\_2,\\dots,\\boldsymbol{x}\_T)，输出另外一个向量序列(\\boldsymbol{y}\_1,\\boldsymbol{y}\_2,\\dots,\\boldsymbol{y}\_T)，并且满足如下递归关系

\\boldsymbol{y}\_t=f(\\boldsymbol{y}\_{t-1}, \\boldsymbol{x}\_t, t)\\tag{1}

的模型，都可以称为RNN。也正因为如此，原始的朴素RNN，还有改进的如GRU、LSTM、SRU等模型，我们都称为RNN，因为它们都可以作为上式的一个特例。还有一些看上去与RNN没关的内容，比如前不久介绍的 [CRF的分母的计算](https://kexue.fm/archives/5542)，实际上也是一个简单的RNN。

说白了，RNN其实就是递归计算。

### 自己编写RNN [\#](https://kexue.fm/archives/5643\#%E8%87%AA%E5%B7%B1%E7%BC%96%E5%86%99RNN)

这里我们先介绍如何用Keras简单快捷地编写自定义的RNN。

事实上，不管在Keras还是纯tensorflow中，要自定义自己的RNN都不算复杂。在Keras中，只要写出每一步的递归函数；而在tensorflow中，则稍微复杂一点，需要将每一步的递归函数封装为一个RNNCell类。下面介绍用Keras实现最基本的一个RNN：

\\boldsymbol{y}\_t=\\tanh(\\boldsymbol{W}\_1 \\boldsymbol{y}\_{t-1} + \\boldsymbol{W}\_2 \\boldsymbol{x}\_t + \\boldsymbol{b})\\tag{2}

代码非常简单：

```python

```

可以看到，虽然代码行数不少，但大部分都只是固定格式的语句，真正定义rnn的，是step\_do这个函数，这个函数接受两个输入：step\_in和states。其中step\_in是一个(batch\_size, input\_dim)的张量，代表当前时刻的样本\\boldsymbol{x}\_t，而states是一个list，代表\\boldsymbol{y}\_{t-1}及一些中间变量；特别要注意的是，states是一个张量的list，而不是单个张量，这是因为在递归过程中可能要同时传递多个中间变量，而不仅仅是\\boldsymbol{y}\_{t-1}一个，比如LSTM就需要有两个态张量。最后step\_do要返回\\boldsymbol{y}\_t和新的states，这是step\_do这步的函数的编写规范。

而K.rnn这个函数，接受三个基本参数（还有其他参数，请自行看官方文档），其中第一个参数就是刚才写好的step\_do函数，第二个参数则是输入的时间序列，第三个是初始态，跟前面说的states一致，所以很自然init\_states也是一个张量的list，默认情况下我们会选择全零初始化。

## ODE基本 [\#](https://kexue.fm/archives/5643\#ODE%E5%9F%BA%E6%9C%AC)

### 什么是ODE？ [\#](https://kexue.fm/archives/5643\#%E4%BB%80%E4%B9%88%E6%98%AFODE%EF%BC%9F)

ODE就是“常微分方程（Ordinary Differential Equation）”，这里指的是一般的常微分方程组：

\\dot{\\boldsymbol{x}}(t)=\\boldsymbol{f}\\big(\\boldsymbol{x}(t), t\\big)\\tag{3}

研究ODE的领域通常也直接称为“动力学”、“动力系统”，这是因为牛顿力学通常也就只是一组ODE而已。

ODE可以产生非常丰富的函数。比如e^t其实就是\\dot{x}=x的解，\\sin t和\\cos t都是\\ddot{x}+x=0的解（初始条件不同）。事实上，我记得确实有一些教程是直接通过微分方程\\dot{x}=x来定义e^t函数的。除了这些初等函数，很多我们能叫得上名字但不知道是什么鬼的特殊函数，都是通过ODE导出来的，比如超几何函数、勒让德函数、贝塞尔函数...

总之，ODE能产生并且已经产生了各种各样千奇百怪的函数～

### 数值解ODE [\#](https://kexue.fm/archives/5643\#%E6%95%B0%E5%80%BC%E8%A7%A3ODE)

能精确求出解析解的ODE其实是非常少的，所以很多时候我们都需要数值解法。

ODE的数值解已经是一门非常成熟的学科了，这里我们也不多做介绍，仅引入最基本的由数学家欧拉提出来的迭代公式：

\\boldsymbol{x}(t + h) = \\boldsymbol{x}(t) + h \\boldsymbol{f}\\big(\\boldsymbol{x}(t), t\\big)\\tag{4}

这里的h是步长。欧拉的解法来源很简单，就是用

\\frac{\\boldsymbol{x}(t + h) - \\boldsymbol{x}(t)}{h}\\tag{5}

来近似导数项\\dot{\\boldsymbol{x}}(t)。只要给定初始条件\\boldsymbol{x}(0)，我们就可以根据(4)一步步迭代算出每个时间点的结果。

## ODE与RNN [\#](https://kexue.fm/archives/5643\#ODE%E4%B8%8ERNN)

### ODE也是RNN [\#](https://kexue.fm/archives/5643\#ODE%E4%B9%9F%E6%98%AFRNN)

大家仔细对比(4)和(1)，发现有什么联系了吗？

在(1)中，t是一个整数变量，在(4)中，t是一个浮点变量，除此之外，(4)跟(1)貌似就没有什么明显的区别了。事实上，在(4)中我们可以以h为时间单位，记t=nh，那么(4)变成了

\\boldsymbol{x}\\big((n+1)h\\big) = \\boldsymbol{x}(nh) + h \\boldsymbol{f}\\big(\\boldsymbol{x}(nh), nh\\big)\\tag{6}

可以看到现在(6)中的时间变量n也是整数了。

这样一来，我们就知道：**ODE的欧拉解法(4)实际上就是RNN的一个特例罢了**。这里我们也许可以间接明白为什么RNN的拟合能力如此之强了（尤其是对于时间序列数据），我们看到ODE可以产生很多复杂的函数，而ODE只不过是RNN的一个特例罢了，所以RNN也就可以产生更为复杂的函数了。

### 用RNN解ODE [\#](https://kexue.fm/archives/5643\#%E7%94%A8RNN%E8%A7%A3ODE)

于是，我们就可以写一个RNN来解ODE了，比如 [《两生物种群竞争模型》](https://kexue.fm/archives/3120) 中的例子：

\\left\\{\\begin{aligned}\\frac{dx\_1}{dt}=r\_1 x\_1\\left(1-\\frac{x\_1}{N\_1}\\right)-a\_1 x\_1 x\_2 \\\
\\frac{dx\_2}{dt}=r\_2 x\_2\\left(1-\\frac{x\_2}{N\_2}\\right)-a\_2 x\_1 x\_2\\end{aligned}\\right.\\tag{7}

我们可以写出

```python

```

整个过程很容易理解，只不过有两点需要指出一下。首先，由于方程组(7)只有两维，而且不容易写成矩阵运算，因此我在step\_do函数中是直接逐位操作的（代码中的x\[:,0\],x\[:,1\]），如果方程本身维度较高，而且能写成矩阵运算，那么直接利用矩阵运算写会更加高效；然后，我们可以看到，写完整个模型之后，直接predict就输出结果了，不需要“训练”。

[![RNN解两物种的竞争模型](https://kexue.fm/usr/uploads/2018/06/1436660762.png)](https://kexue.fm/usr/uploads/2018/06/1436660762.png "点击查看原图")

RNN解两物种的竞争模型

### 反推ODE参数 [\#](https://kexue.fm/archives/5643\#%E5%8F%8D%E6%8E%A8ODE%E5%8F%82%E6%95%B0)

前一节的介绍也就是说，RNN的前向传播跟ODE的欧拉解法是对应的，那么反向传播又对应什么呢？

在实际问题中，有一类问题称为“模型推断”，它是在已知实验数据的基础上，猜测这批数据符合的模型（机理推断）。这类问题的做法大概分两步，第一步是猜测模型的形式，第二步是确定模型的参数。假定这批数据可以由一个ODE描述，并且这个ODE的形式已经知道了，那么就需要估计里边的参数。

如果能够用公式完全解出这个ODE，那么这就只是一个非常简单的回归问题罢了。但前面已经说过，多数ODE都没有公式解，所以数值方法就必须了。这其实就是ODE对应的RNN的反向传播所要做的事情：前向传播就是解ODE（RNN的预测过程），反向传播自然就是推断ODE的参数了（RNN的训练过程）。这是一个非常有趣的事实： **ODE的参数推断是一个被研究得很充分的课题，然而在深度学习这里，只是RNN的一个最基本的应用罢了**。

我们把刚才的例子的微分方程的解数据保存下来，然后只取几个点，看看能不能反推原来的微分方程出来，解数据为：

\\begin{array}{c\|ccccccc}
\\hline
\\text{时间} & 0 & 10 & 15 & 30 & 36 & 40 & 42\\\
\\hline
x\_1 & 100 & 165 & 197 & 280 & 305 & 318 & 324\\\
\\hline
x\_2 & 150 & 283 & 290 & 276 & 269 & 266 & 264\\\
\\hline
\\end{array}

假设就已知这有限的点数据，然后假定方程(7)的形式，求方程的各个参数。我们修改一下前面的代码：

```python

```

结果可以用一张图来看：

[![RNN做ODE的参数估计效果（散点：有限的实验数据，曲线：估计出来的模型）](https://kexue.fm/usr/uploads/2018/06/2821413082.png)](https://kexue.fm/usr/uploads/2018/06/2821413082.png "点击查看原图")

RNN做ODE的参数估计效果（散点：有限的实验数据，曲线：估计出来的模型）

显然结果是让人满意的。

## 又到总结 [\#](https://kexue.fm/archives/5643\#%E5%8F%88%E5%88%B0%E6%80%BB%E7%BB%93)

本文在一个一般的框架下介绍了RNN模型及其在Keras下的自定义写法，然后揭示了ODE与RNN的联系。在此基础上，介绍了用RNN直接求解ODE以及用RNN反推ODE参数的基本思路。需要提醒读者的是，在RNN模型的反向传播中，要谨慎地做好初始化和截断处理处理，并且选择好学习率等，以防止梯度爆炸的出现（梯度消失只是优化得不够好，梯度爆炸则是直接崩溃了，解决梯度爆炸问题尤为重要）。

总之，梯度消失和梯度爆炸在RNN中是一个很经典的困难，事实上，LSTM、GRU等模型的引入，根本原因就是为了解决RNN的梯度消失问题，而梯度爆炸则是通过使用tanh或sigmoid激活函数来解决的。但是如果用RNN解决ODE的话，我们就没有选择激活函数的权利了（激活函数就是ODE的一部分），所以只能谨慎地做好初始化及其他处理。据说，只要谨慎做好初始化，普通RNN中用relu作为激活函数都是无妨的～

_**转载到请包括本文地址：** [https://kexue.fm/archives/5643](https://kexue.fm/archives/5643 "貌离神合的RNN与ODE：花式RNN简介")_

_**更详细的转载事宜请参考：**_ [《科学空间FAQ》](https://kexue.fm/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8 "《科学空间FAQ》")

**如果您还有什么疑惑或建议，欢迎在下方评论区继续讨论。**

**如果您觉得本文还不错，欢迎 [分享](https://kexue.fm/archives/5643#share)/ [打赏](https://kexue.fm/archives/5643#pay) 本文。打赏并非要从中获得收益，而是希望知道科学空间获得了多少读者的真心关注。当然，如果你无视它，也不会影响你的阅读。再次表示欢迎和感谢！**

打赏

![科学空间](https://kexue.fm/usr/themes/geekg/payment/wx.png)

微信打赏

![科学空间](https://kexue.fm/usr/themes/geekg/payment/zfb.png)

支付宝打赏

因为网站后台对打赏并无记录，因此欢迎在打赏时候备注留言。

你还可以 [**点击这里**](http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=tN7d1drY3drrx8H0xcWa19vZ) 或在下方评论区留言来告知你的建议或需求。

**如果您需要引用本文，请参考：**

苏剑林. (Jun. 23, 2018). 《貌离神合的RNN与ODE：花式RNN简介 》\[Blog post\]. Retrieved from [https://kexue.fm/archives/5643](https://kexue.fm/archives/5643)

@online{kexuefm-5643,

         title={貌离神合的RNN与ODE：花式RNN简介},

         author={苏剑林},

         year={2018},

         month={Jun},

         url={\\url{https://kexue.fm/archives/5643}},

}


分类： [数学研究](https://kexue.fm/category/Mathematics), [信息时代](https://kexue.fm/category/Big-Data)    标签： [微分方程](https://kexue.fm/tag/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/), [递推](https://kexue.fm/tag/%E9%80%92%E6%8E%A8/), [RNN](https://kexue.fm/tag/RNN/)[24 评论](https://kexue.fm/archives/5643#comments)

< [“噪声对比估计”杂谈：曲径通幽之妙](https://kexue.fm/archives/5617 "“噪声对比估计”杂谈：曲径通幽之妙") \| [从动力学角度看优化算法（一）：从SGD到动量加速](https://kexue.fm/archives/5655 "从动力学角度看优化算法（一）：从SGD到动量加速") >

### 你也许还对下面的内容感兴趣

- [为什么DeltaNet要加L2 Normalize？](https://kexue.fm/archives/11486 "为什么DeltaNet要加L2 Normalize？")
- [AdamW的Weight RMS的渐近估计（下）](https://kexue.fm/archives/11404 "AdamW的Weight RMS的渐近估计（下）")
- [为什么线性注意力要加Short Conv？](https://kexue.fm/archives/11320 "为什么线性注意力要加Short Conv？")
- [“对角+低秩”三角阵的高效求逆方法](https://kexue.fm/archives/11072 "“对角+低秩”三角阵的高效求逆方法")
- [线性注意力简史：从模仿、创新到反哺](https://kexue.fm/archives/11033 "线性注意力简史：从模仿、创新到反哺")
- [生成扩散模型漫谈（三十）：从瞬时速度到平均速度](https://kexue.fm/archives/10958 "生成扩散模型漫谈（三十）：从瞬时速度到平均速度")
- [生成扩散模型漫谈（二十八）：分步理解一致性模型](https://kexue.fm/archives/10633 "生成扩散模型漫谈（二十八）：分步理解一致性模型")
- [生成扩散模型漫谈（二十七）：将步长作为条件输入](https://kexue.fm/archives/10617 "生成扩散模型漫谈（二十七）：将步长作为条件输入")
- [重温SSM（四）：有理生成函数的新视角](https://kexue.fm/archives/10180 "重温SSM（四）：有理生成函数的新视角")
- [重温SSM（三）：HiPPO的高效计算（S4）](https://kexue.fm/archives/10162 "重温SSM（三）：HiPPO的高效计算（S4）")

[发表你的看法](https://kexue.fm/archives/5643#comment_form)

BeerRabbit

July 4th, 2018

相当新奇的想法，标记一下回头自信看。

[回复评论](https://kexue.fm/archives/5643/comment-page-1?replyTo=9408#respond-post-5643)

rain&snow

July 11th, 2018

作者您好，ODE公式(4)和RNN公式（1)之间的联系，您说ODE是RNN的一个特例，能否给解释一下二者的联系之处？

[回复评论](https://kexue.fm/archives/5643/comment-page-1?replyTo=9449#respond-post-5643)

[苏剑林](https://kexue.fm/) 发表于
July 11th, 2018

整篇文章都是在回答你这个问题，请仔细看这篇文章。

[回复评论](https://kexue.fm/archives/5643/comment-page-1?replyTo=9450#respond-post-5643)

暮雨

August 6th, 2018

上大学以来看到的最有意思的东西，不行我要打赏

[回复评论](https://kexue.fm/archives/5643/comment-page-1?replyTo=9585#respond-post-5643)

徐瑞龙

August 11th, 2018

代码不能运行，报错：

Traceback (most recent call last):

File "/usr/lib/python3/dist-packages/IPython/core/interactiveshell.py", line 2882, in run\_code

exec(code\_obj, self.user\_global\_ns, self.user\_ns)

File "", line 2, in

M.add(ODE\_RNN(steps, h, input\_shape=(2,1)))

File "/usr/lib/python3/dist-packages/keras/models.py", line 464, in add

layer(x)

File "/usr/lib/python3/dist-packages/keras/engine/topology.py", line 603, in \_\_call\_\_

output = self.call(inputs, \*\*kwargs)

File "", line 40, in call

zeros = K.zeros(dim) # 迭代过程用不着外部输入，所以

File "/usr/lib/python3/dist-packages/keras/backend/tensorflow\_backend.py", line 675, in zeros

return variable(tf.constant\_initializer(0., dtype=tf\_dtype)(shape),

File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/init\_ops.py", line 217, in \_\_call\_\_

self.value, dtype=dtype, shape=shape, verify\_shape=verify\_shape)

File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/constant\_op.py", line 214, in constant

value, dtype=dtype, shape=shape, verify\_shape=verify\_shape))

File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/tensor\_util.py", line 430, in make\_tensor\_proto

if shape is not None and np.prod(shape, dtype=np.int64) == 0:

File "/usr/lib/python3/dist-packages/numpy/core/fromnumeric.py", line 2518, in prod

out=out, \*\*kwargs)

File "/usr/lib/python3/dist-packages/numpy/core/\_methods.py", line 35, in \_prod

return umr\_prod(a, axis, dtype, out, keepdims)

ValueError: setting an array element with a sequence.

[回复评论](https://kexue.fm/archives/5643/comment-page-1?replyTo=9597#respond-post-5643)

徐瑞龙 发表于
August 11th, 2018

keras.\_\_version\_\_

'2.1.1'

tensorflow.\_\_version\_\_（GPU 版本）

'1.6.0'

[回复评论](https://kexue.fm/archives/5643/comment-page-1?replyTo=9598#respond-post-5643)

徐瑞龙 发表于
August 11th, 2018

dim = (K.shape(inputs)\[0\], self.steps, K.shape(inputs)\[1\])

[回复评论](https://kexue.fm/archives/5643/comment-page-1?replyTo=9599#respond-post-5643)

[苏剑林](https://kexue.fm/) 发表于
August 11th, 2018

不是很清楚，可能是由于python2到python3的转换也说不准。我的环境python2.7+keras 2.1.5可以跑通

[回复评论](https://kexue.fm/archives/5643/comment-page-1?replyTo=9600#respond-post-5643)

王鹏飞hit

November 21st, 2018

很强

[回复评论](https://kexue.fm/archives/5643/comment-page-1?replyTo=10167#respond-post-5643)

Jamesp

December 27th, 2018

求博主点评我写的https://www.jianshu.com/p/e8df1f56a118，我路子比较野，数学一般般，也不知道这个思路对不对，谢谢

[回复评论](https://kexue.fm/archives/5643/comment-page-1?replyTo=10439#respond-post-5643)

[苏剑林](https://kexue.fm/) 发表于
December 27th, 2018

rnn不是卷积。

[回复评论](https://kexue.fm/archives/5643/comment-page-1?replyTo=10445#respond-post-5643)

Jamesp 发表于
December 27th, 2018

发现了，谢谢

[回复评论](https://kexue.fm/archives/5643/comment-page-1?replyTo=10449#respond-post-5643)

jamesp

October 5th, 2019

根据https://arxiv.org/abs/1806.07366，欧拉解法也可以看做残差网络 h1=h0+g(h0)，从而多层残差看做连续的ODE方程，苏神有兴趣解读下不

[回复评论](https://kexue.fm/archives/5643/comment-page-1?replyTo=12108#respond-post-5643)

[苏剑林](https://kexue.fm/) 发表于
October 7th, 2019

看过了，感觉没什么意思呢～

[回复评论](https://kexue.fm/archives/5643/comment-page-1?replyTo=12128#respond-post-5643)

tttbag

June 4th, 2021

作者你好，假如倒推ODE方程的话，是不是必须确保X1，X2都是已知的？

[回复评论](https://kexue.fm/archives/5643/comment-page-1?replyTo=16563#respond-post-5643)

[苏剑林](https://kexue.fm/) 发表于
June 5th, 2021

要不然什么叫做倒推？不就是已知x\_1,x\_2求方程的参数吗？

[回复评论](https://kexue.fm/archives/5643/comment-page-1?replyTo=16569#respond-post-5643)

tttbag 发表于
June 6th, 2021

谢谢解答！

[回复评论](https://kexue.fm/archives/5643/comment-page-1?replyTo=16572#respond-post-5643)

tttbag 发表于
June 6th, 2021

还有就是，我们反推得到的结果只是数值并绘图，但是无法具体写出最后的ODE方程啊？

[回复评论](https://kexue.fm/archives/5643/comment-page-1?replyTo=16573#respond-post-5643)

[苏剑林](https://kexue.fm/) 发表于
June 6th, 2021

怎么就没法了，你自己把ODE\_RNN的kernel参数打印出来看看不就行了～

[回复评论](https://kexue.fm/archives/5643/comment-page-1?replyTo=16574#respond-post-5643)

tttbag 发表于
June 7th, 2021

我刚入门，非常感谢您的解答！！

[回复评论](https://kexue.fm/archives/5643/comment-page-1?replyTo=16587#respond-post-5643)

何成琳 发表于
September 22nd, 2022

您好，请问kernel参数怎么打印出来呢

[回复评论](https://kexue.fm/archives/5643/comment-page-1?replyTo=19873#respond-post-5643)

AA

December 5th, 2021

Tensor("Placeholder:0", shape=(None, 2), dtype=float32)

Traceback (most recent call last):

File "E:\\zuoye\\huanyingshiyongtianqichaxun\\RNN.py", line 67, in

M.add(ODE\_RNN(steps, h, input\_shape=(2,)))

File "E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\training\\tracking\\base.py", line 530, in \_method\_wrapper

result = method(self, \*args, \*\*kwargs)

File "E:\\anaconda11.19\\lib\\site-packages\\keras\\utils\\traceback\_utils.py", line 67, in error\_handler

raise e.with\_traceback(filtered\_tb) from None

File "E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\autograph\\impl\\api.py", line 699, in wrapper

raise e.ag\_error\_metadata.to\_exception(e)

TypeError: Exception encountered when calling layer "ode\_rnn\_9" (type ODE\_RNN).

in user code:

File "E:\\zuoye\\huanyingshiyongtianqichaxun\\RNN.py", line 39, in call \*

zeros = K.zeros((K.shape(inputs)\[0\],

File "E:\\anaconda11.19\\lib\\site-packages\\keras\\backend.py", line 1576, in zeros \*\*

v = tf.zeros(shape=shape, dtype=tf\_dtype, name=name)

TypeError: Originated from a graph execution error.

The graph execution error is detected at a node built at (most recent call last):

File E:\\anaconda11.19\\lib\\runpy.py, line 197, in \_run\_module\_as\_main

File E:\\anaconda11.19\\lib\\runpy.py, line 87, in \_run\_code

File E:\\anaconda11.19\\lib\\site-packages\\spyder\_kernels\\console\\\_\_main\_\_.py, line 23, in

File E:\\anaconda11.19\\lib\\site-packages\\spyder\_kernels\\console\\start.py, line 328, in main

File E:\\anaconda11.19\\lib\\site-packages\\ipykernel\\kernelapp.py, line 677, in start

File E:\\anaconda11.19\\lib\\site-packages\\tornado\\platform\\asyncio.py, line 199, in start

File E:\\anaconda11.19\\lib\\asyncio\\base\_events.py, line 596, in run\_forever

File E:\\anaconda11.19\\lib\\asyncio\\base\_events.py, line 1890, in \_run\_once

File E:\\anaconda11.19\\lib\\asyncio\\events.py, line 80, in \_run

File E:\\anaconda11.19\\lib\\site-packages\\ipykernel\\kernelbase.py, line 457, in dispatch\_queue

File E:\\anaconda11.19\\lib\\site-packages\\ipykernel\\kernelbase.py, line 446, in process\_one

File E:\\anaconda11.19\\lib\\site-packages\\ipykernel\\kernelbase.py, line 353, in dispatch\_shell

File E:\\anaconda11.19\\lib\\site-packages\\ipykernel\\kernelbase.py, line 648, in execute\_request

File E:\\anaconda11.19\\lib\\site-packages\\ipykernel\\ipkernel.py, line 353, in do\_execute

File E:\\anaconda11.19\\lib\\site-packages\\ipykernel\\zmqshell.py, line 533, in run\_cell

File E:\\anaconda11.19\\lib\\site-packages\\IPython\\core\\interactiveshell.py, line 2901, in run\_cell

File E:\\anaconda11.19\\lib\\site-packages\\IPython\\core\\interactiveshell.py, line 2947, in \_run\_cell

File E:\\anaconda11.19\\lib\\site-packages\\IPython\\core\\async\_helpers.py, line 68, in \_pseudo\_sync\_runner

File E:\\anaconda11.19\\lib\\site-packages\\IPython\\core\\interactiveshell.py, line 3172, in run\_cell\_async

File E:\\anaconda11.19\\lib\\site-packages\\IPython\\core\\interactiveshell.py, line 3364, in run\_ast\_nodes

File E:\\anaconda11.19\\lib\\site-packages\\IPython\\core\\interactiveshell.py, line 3444, in run\_code

File C:\\Users\\HP\\AppData\\Local\\Temp/ipykernel\_19192/2328460107.py, line 1, in

File E:\\anaconda11.19\\lib\\site-packages\\spyder\_kernels\\customize\\spydercustomize.py, line 577, in runfile

File E:\\anaconda11.19\\lib\\site-packages\\spyder\_kernels\\customize\\spydercustomize.py, line 465, in exec\_code

File E:\\zuoye\\huanyingshiyongtianqichaxun\\RNN.py, line 67, in

File E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\training\\tracking\\base.py, line 530, in \_method\_wrapper

File E:\\anaconda11.19\\lib\\site-packages\\keras\\utils\\traceback\_utils.py, line 64, in error\_handler

File E:\\anaconda11.19\\lib\\site-packages\\keras\\engine\\sequential.py, line 205, in add

File E:\\anaconda11.19\\lib\\site-packages\\keras\\utils\\traceback\_utils.py, line 64, in error\_handler

File E:\\anaconda11.19\\lib\\site-packages\\keras\\engine\\base\_layer.py, line 1019, in \_\_call\_\_

File E:\\anaconda11.19\\lib\\site-packages\\keras\\engine\\base\_layer.py, line 1160, in \_functional\_construction\_call

File E:\\anaconda11.19\\lib\\site-packages\\keras\\engine\\base\_layer.py, line 885, in \_keras\_tensor\_symbolic\_call

File E:\\anaconda11.19\\lib\\site-packages\\keras\\engine\\base\_layer.py, line 930, in \_infer\_output\_signature

File E:\\anaconda11.19\\lib\\site-packages\\keras\\utils\\traceback\_utils.py, line 92, in error\_handler

File E:\\zuoye\\huanyingshiyongtianqichaxun\\RNN.py, line 39, in call

File E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\util\\traceback\_utils.py, line 150, in error\_handler

File E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\util\\dispatch.py, line 1096, in op\_dispatch\_handler

File E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\ops\\array\_ops.py, line 1042, in \_slice\_helper

File E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\util\\traceback\_utils.py, line 150, in error\_handler

File E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\util\\dispatch.py, line 1096, in op\_dispatch\_handler

File E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\ops\\array\_ops.py, line 1215, in strided\_slice

File E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\ops\\gen\_array\_ops.py, line 10697, in strided\_slice

File E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\framework\\op\_def\_library.py, line 744, in \_apply\_op\_helper

File E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\framework\\func\_graph.py, line 689, in \_create\_op\_internal

File E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py, line 3697, in \_create\_op\_internal

File E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py, line 2101, in \_\_init\_\_

Error detected in node 'ode\_rnn\_9/strided\_slice' defined at: File "E:\\zuoye\\huanyingshiyongtianqichaxun\\RNN.py", line 39, in call

TypeError: tf.Graph captured an external symbolic tensor. The symbolic tensor 'ode\_rnn\_9/strided\_slice:0' created by node 'ode\_rnn\_9/strided\_slice' is captured by the tf.Graph being executed as an input. But a tf.Graph is not allowed to take symbolic tensors from another graph as its inputs. Make sure all captured inputs of the executing tf.Graph are not symbolic tensors. Use return values, explicit Python locals or TensorFlow collections to access it. Please see https://www.tensorflow.org/guide/function#all\_outputs\_of\_a\_tffunction\_must\_be\_return\_values for more information.

Call arguments received:

• inputs=tf.Tensor(shape=(None, 2), dtype=float32)

runfile('E:/zuoye/huanyingshiyongtianqichaxun/RNN.py', wdir='E:/zuoye/huanyingshiyongtianqichaxun')

Reloaded modules: \_\_autograph\_generated\_fileeeu9efck

Traceback (most recent call last):

File "E:\\zuoye\\huanyingshiyongtianqichaxun\\RNN.py", line 66, in

M.add(ODE\_RNN(steps, h, input\_shape=(2,)))

File "E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\training\\tracking\\base.py", line 530, in \_method\_wrapper

result = method(self, \*args, \*\*kwargs)

File "E:\\anaconda11.19\\lib\\site-packages\\keras\\utils\\traceback\_utils.py", line 67, in error\_handler

raise e.with\_traceback(filtered\_tb) from None

File "E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\autograph\\impl\\api.py", line 699, in wrapper

raise e.ag\_error\_metadata.to\_exception(e)

TypeError: Exception encountered when calling layer "ode\_rnn\_10" (type ODE\_RNN).

in user code:

File "E:\\zuoye\\huanyingshiyongtianqichaxun\\RNN.py", line 38, in call \*

zeros = K.zeros((K.shape(input)\[0\],

File "E:\\anaconda11.19\\lib\\site-packages\\keras\\backend.py", line 1576, in zeros \*\*

v = tf.zeros(shape=shape, dtype=tf\_dtype, name=name)

TypeError: Originated from a graph execution error.

The graph execution error is detected at a node built at (most recent call last):

File E:\\anaconda11.19\\lib\\runpy.py, line 197, in \_run\_module\_as\_main

File E:\\anaconda11.19\\lib\\runpy.py, line 87, in \_run\_code

File E:\\anaconda11.19\\lib\\site-packages\\spyder\_kernels\\console\\\_\_main\_\_.py, line 23, in

File E:\\anaconda11.19\\lib\\site-packages\\spyder\_kernels\\console\\start.py, line 328, in main

File E:\\anaconda11.19\\lib\\site-packages\\ipykernel\\kernelapp.py, line 677, in start

File E:\\anaconda11.19\\lib\\site-packages\\tornado\\platform\\asyncio.py, line 199, in start

File E:\\anaconda11.19\\lib\\asyncio\\base\_events.py, line 596, in run\_forever

File E:\\anaconda11.19\\lib\\asyncio\\base\_events.py, line 1890, in \_run\_once

File E:\\anaconda11.19\\lib\\asyncio\\events.py, line 80, in \_run

File E:\\anaconda11.19\\lib\\site-packages\\ipykernel\\kernelbase.py, line 457, in dispatch\_queue

File E:\\anaconda11.19\\lib\\site-packages\\ipykernel\\kernelbase.py, line 446, in process\_one

File E:\\anaconda11.19\\lib\\site-packages\\ipykernel\\kernelbase.py, line 353, in dispatch\_shell

File E:\\anaconda11.19\\lib\\site-packages\\ipykernel\\kernelbase.py, line 648, in execute\_request

File E:\\anaconda11.19\\lib\\site-packages\\ipykernel\\ipkernel.py, line 353, in do\_execute

File E:\\anaconda11.19\\lib\\site-packages\\ipykernel\\zmqshell.py, line 533, in run\_cell

File E:\\anaconda11.19\\lib\\site-packages\\IPython\\core\\interactiveshell.py, line 2901, in run\_cell

File E:\\anaconda11.19\\lib\\site-packages\\IPython\\core\\interactiveshell.py, line 2947, in \_run\_cell

File E:\\anaconda11.19\\lib\\site-packages\\IPython\\core\\async\_helpers.py, line 68, in \_pseudo\_sync\_runner

File E:\\anaconda11.19\\lib\\site-packages\\IPython\\core\\interactiveshell.py, line 3172, in run\_cell\_async

File E:\\anaconda11.19\\lib\\site-packages\\IPython\\core\\interactiveshell.py, line 3364, in run\_ast\_nodes

File E:\\anaconda11.19\\lib\\site-packages\\IPython\\core\\interactiveshell.py, line 3444, in run\_code

File C:\\Users\\HP\\AppData\\Local\\Temp/ipykernel\_19192/2328460107.py, line 1, in

File E:\\anaconda11.19\\lib\\site-packages\\spyder\_kernels\\customize\\spydercustomize.py, line 577, in runfile

File E:\\anaconda11.19\\lib\\site-packages\\spyder\_kernels\\customize\\spydercustomize.py, line 465, in exec\_code

File E:\\zuoye\\huanyingshiyongtianqichaxun\\RNN.py, line 66, in

File E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\training\\tracking\\base.py, line 530, in \_method\_wrapper

File E:\\anaconda11.19\\lib\\site-packages\\keras\\utils\\traceback\_utils.py, line 64, in error\_handler

File E:\\anaconda11.19\\lib\\site-packages\\keras\\engine\\sequential.py, line 205, in add

File E:\\anaconda11.19\\lib\\site-packages\\keras\\utils\\traceback\_utils.py, line 64, in error\_handler

File E:\\anaconda11.19\\lib\\site-packages\\keras\\engine\\base\_layer.py, line 1019, in \_\_call\_\_

File E:\\anaconda11.19\\lib\\site-packages\\keras\\engine\\base\_layer.py, line 1160, in \_functional\_construction\_call

File E:\\anaconda11.19\\lib\\site-packages\\keras\\engine\\base\_layer.py, line 885, in \_keras\_tensor\_symbolic\_call

File E:\\anaconda11.19\\lib\\site-packages\\keras\\engine\\base\_layer.py, line 930, in \_infer\_output\_signature

File E:\\anaconda11.19\\lib\\site-packages\\keras\\utils\\traceback\_utils.py, line 92, in error\_handler

File E:\\zuoye\\huanyingshiyongtianqichaxun\\RNN.py, line 38, in call

File E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\util\\traceback\_utils.py, line 150, in error\_handler

File E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\util\\dispatch.py, line 1096, in op\_dispatch\_handler

File E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\ops\\array\_ops.py, line 1042, in \_slice\_helper

File E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\util\\traceback\_utils.py, line 150, in error\_handler

File E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\util\\dispatch.py, line 1096, in op\_dispatch\_handler

File E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\ops\\array\_ops.py, line 1215, in strided\_slice

File E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\ops\\gen\_array\_ops.py, line 10697, in strided\_slice

File E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\framework\\op\_def\_library.py, line 744, in \_apply\_op\_helper

File E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\framework\\func\_graph.py, line 689, in \_create\_op\_internal

File E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py, line 3697, in \_create\_op\_internal

File E:\\anaconda11.19\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py, line 2101, in \_\_init\_\_

Error detected in node 'ode\_rnn\_10/strided\_slice' defined at: File "E:\\zuoye\\huanyingshiyongtianqichaxun\\RNN.py", line 38, in call

TypeError: tf.Graph captured an external symbolic tensor. The symbolic tensor 'ode\_rnn\_10/strided\_slice:0' created by node 'ode\_rnn\_10/strided\_slice' is captured by the tf.Graph being executed as an input. But a tf.Graph is not allowed to take symbolic tensors from another graph as its inputs. Make sure all captured inputs of the executing tf.Graph are not symbolic tensors. Use return values, explicit Python locals or TensorFlow collections to access it. Please see https://www.tensorflow.org/guide/function#all\_outputs\_of\_a\_tffunction\_must\_be\_return\_values for more information.

Call arguments received:

• input=tf.Tensor(shape=(None, 2), dtype=float32)

有错了啊，怎么解决，求解答

[回复评论](https://kexue.fm/archives/5643/comment-page-1?replyTo=17962#respond-post-5643)

[苏剑林](https://kexue.fm/) 发表于
December 6th, 2021

看不出～

[回复评论](https://kexue.fm/archives/5643/comment-page-1?replyTo=17965#respond-post-5643)

何成琳

September 22nd, 2022

作者您好，请问这种自定义层的参数如何导出呢，我在网上找到的代码虽然能运行，但是导出的参数只有训练前的

[回复评论](https://kexue.fm/archives/5643/comment-page-1?replyTo=19871#respond-post-5643)

[取消回复](https://kexue.fm/archives/5643#respond-post-5643)

你的大名

电子邮箱

个人网站（选填）

1\. 可以使用LaTeX代码，点击“预览效果”可查看效果；

2\. 可以通过点击评论楼层编号来引用该楼层；

3\. 网站可能会有点卡，如非确认评论失败，请 **不要重复点击提交**。

### 内容速览

[RNN基本](https://kexue.fm/archives/5643#RNN%E5%9F%BA%E6%9C%AC)
[什么是RNN？](https://kexue.fm/archives/5643#%E4%BB%80%E4%B9%88%E6%98%AFRNN%EF%BC%9F)
[自己编写RNN](https://kexue.fm/archives/5643#%E8%87%AA%E5%B7%B1%E7%BC%96%E5%86%99RNN)
[ODE基本](https://kexue.fm/archives/5643#ODE%E5%9F%BA%E6%9C%AC)
[什么是ODE？](https://kexue.fm/archives/5643#%E4%BB%80%E4%B9%88%E6%98%AFODE%EF%BC%9F)
[数值解ODE](https://kexue.fm/archives/5643#%E6%95%B0%E5%80%BC%E8%A7%A3ODE)
[ODE与RNN](https://kexue.fm/archives/5643#ODE%E4%B8%8ERNN)
[ODE也是RNN](https://kexue.fm/archives/5643#ODE%E4%B9%9F%E6%98%AFRNN)
[用RNN解ODE](https://kexue.fm/archives/5643#%E7%94%A8RNN%E8%A7%A3ODE)
[反推ODE参数](https://kexue.fm/archives/5643#%E5%8F%8D%E6%8E%A8ODE%E5%8F%82%E6%95%B0)
[又到总结](https://kexue.fm/archives/5643#%E5%8F%88%E5%88%B0%E6%80%BB%E7%BB%93)

### 智能搜索

支持整句搜索！网站自动使用 [结巴分词](https://github.com/fxsjy/jieba) 进行分词，并结合ngrams排序算法给出合理的搜索结果。

### 热门标签

[生成模型](https://kexue.fm/tag/%E7%94%9F%E6%88%90%E6%A8%A1%E5%9E%8B/) [attention](https://kexue.fm/tag/attention/) [优化](https://kexue.fm/tag/%E4%BC%98%E5%8C%96/) [语言模型](https://kexue.fm/tag/%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B/) [模型](https://kexue.fm/tag/%E6%A8%A1%E5%9E%8B/) [梯度](https://kexue.fm/tag/%E6%A2%AF%E5%BA%A6/) [网站](https://kexue.fm/tag/%E7%BD%91%E7%AB%99/) [概率](https://kexue.fm/tag/%E6%A6%82%E7%8E%87/) [矩阵](https://kexue.fm/tag/%E7%9F%A9%E9%98%B5/) [优化器](https://kexue.fm/tag/%E4%BC%98%E5%8C%96%E5%99%A8/) [转载](https://kexue.fm/tag/%E8%BD%AC%E8%BD%BD/) [微分方程](https://kexue.fm/tag/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/) [分析](https://kexue.fm/tag/%E5%88%86%E6%9E%90/) [天象](https://kexue.fm/tag/%E5%A4%A9%E8%B1%A1/) [深度学习](https://kexue.fm/tag/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/) [积分](https://kexue.fm/tag/%E7%A7%AF%E5%88%86/) [python](https://kexue.fm/tag/python/) [扩散](https://kexue.fm/tag/%E6%89%A9%E6%95%A3/) [力学](https://kexue.fm/tag/%E5%8A%9B%E5%AD%A6/) [无监督](https://kexue.fm/tag/%E6%97%A0%E7%9B%91%E7%9D%A3/) [几何](https://kexue.fm/tag/%E5%87%A0%E4%BD%95/) [节日](https://kexue.fm/tag/%E8%8A%82%E6%97%A5/) [生活](https://kexue.fm/tag/%E7%94%9F%E6%B4%BB/) [文本生成](https://kexue.fm/tag/%E6%96%87%E6%9C%AC%E7%94%9F%E6%88%90/) [数论](https://kexue.fm/tag/%E6%95%B0%E8%AE%BA/)

### 随机文章

- [2016年全年天象](https://kexue.fm/archives/4171)
- [让炼丹更科学一些（五）：基于梯度精调学习率](https://kexue.fm/archives/11530)
- [基于CNN和序列标注的对联机器人](https://kexue.fm/archives/6270)
- [【中文分词系列】 5\. 基于语言模型的无监督分词](https://kexue.fm/archives/3956)
- [网站统计总结\|来访信息综合](https://kexue.fm/archives/91)
- [通过ssh动态端口转发共享校园资源（附带干货）](https://kexue.fm/archives/3651)
- [宇宙驿站服务器升级完毕](https://kexue.fm/archives/2304)
- [收谷问题(1)](https://kexue.fm/archives/1439)
- [高中数学联赛题目和答案](https://kexue.fm/archives/1382)
- [【理解黎曼几何】7\. 高斯-博内公式](https://kexue.fm/archives/4033)

### 最近评论

- [Bin](https://kexue.fm/archives/1990/comment-page-2#comment-29105): 今天偶然从某个论坛看到有人推荐您的博客，定睛一看竟然是华师同院的往届师兄！看到这篇2013年的...
- [Rapture D](https://kexue.fm/archives/11530/comment-page-1#comment-29104): 我有一个问题，为什么不考虑亥姆霍兹定理和斯托克斯公式。
- [mofheka](https://kexue.fm/archives/11390/comment-page-1#comment-29103): 苏神是还在用jax是么？最近在做基于Google Pathway的理念做一个动态版的MPMD框...
- [长琴](https://kexue.fm/archives/11530/comment-page-1#comment-29102): 看懂这篇博客也不是一件容易的事情。
- [AlexLi](https://kexue.fm/archives/9257/comment-page-4#comment-29101): 苏老师，请教一下(7)式中将 \\mu(x\_t) 传给 p\_o 进行推理的操作。 $x\_...
- [tyler\_zxc](https://kexue.fm/archives/7921/comment-page-2#comment-29100): "Performer的思想是将标准的Attention线性化，所以为什么不干脆直接训练一个线性...
- [我](https://kexue.fm/archives/11494/comment-page-1#comment-29099): 似乎并非mHC提出矩阵的思想？之前hyper connection就是了
- [winter](https://kexue.fm/archives/10847/comment-page-1#comment-29098): 苏神您好，假如对于比较均匀的attention weightP，往往呈现long tail分布...
- [苏剑林](https://kexue.fm/archives/8512/comment-page-2#comment-29097): KL散度、JS散度、W距离啥的，都行啊，看你喜欢哪个
- [苏剑林](https://kexue.fm/archives/9119/comment-page-14#comment-29096): 没有绝对公平的对比方法，主要看你关心什么。比如，如果只关心推理成本和推理效果，那么有的方法可以...

### 友情链接

- [Cool Papers](https://papers.cool/)
- [数学研发](https://bbs.emath.ac.cn/)
- [Seatop](http://www.seatop.com.cn/)
- [Xiaoxia](https://xiaoxia.org/)
- [积分表-网络版](https://kexue.fm/sci/integral/index.html)
- [丝路博傲](http://blog.dvxj.com/)
- [数学之家](http://www.2math.cn/)
- [有趣天文奇观](http://interesting-sky.china-vo.org/)
- [TwistedW](http://www.twistedwg.com/)
- [godweiyang](https://godweiyang.com/)
- [AI柠檬](https://blog.ailemon.net/)
- [王登科-DK博客](https://greatdk.com/)
- [ESON](https://blog.eson.org/)
- [枫之羽](https://fzhiy.net/)
- [coding-zuo](https://coding-zuo.github.io/)
- [博科园](https://www.bokeyuan.net/)
- [孔皮皮的博客](https://www.kppkkp.top/)
- [运鹏的博客](https://yunpengtai.top/)
- [jiming.site](https://jiming.site/)
- [OmegaXYZ](https://www.omegaxyz.com/)
- [EAI猩球](https://www.robotech.ink/)
- [文举的博客](https://liwenju0.com/)
- [申请链接](https://kexue.fm/links.html)

[![署名-非商业用途-保持一致](https://kexue.fm/usr/themes/geekg/images/cc.gif)](http://creativecommons.org/licenses/by-nc-nd/2.5/cn/) 本站采用创作共用版权协议，要求署名、非商业用途和保持一致。转载本站内容必须也遵循“ [署名-非商业用途-保持一致](http://creativecommons.org/licenses/by-nc-nd/2.5/cn/)”的创作共用协议。



© 2009-2026 Scientific Spaces. All rights reserved. Theme by [laogui](http://www.laogui.com/). Powered by [Typecho](http://typecho.org/). 备案号: [粤ICP备09093259号-1/2](https://beian.miit.gov.cn/ "粤ICP备09093259号")。