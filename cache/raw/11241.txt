## SEARCH

## MENU

- [打赏](https://kexue.fm/reward.html)
- [公式](https://kexue.fm/latex.html)
- [天象](https://kexue.fm/ac.html)
- [链接](https://kexue.fm/links.html)
- [时光](https://kexue.fm/me.html)
- [博览](https://kexue.fm/science.html)
- [归档](https://kexue.fm/content.html)

## CATEGORIES

- [千奇百怪](https://kexue.fm/category/Everything)
- [天文探索](https://kexue.fm/category/Astronomy)
- [数学研究](https://kexue.fm/category/Mathematics)
- [物理化学](https://kexue.fm/category/Phy-chem)
- [信息时代](https://kexue.fm/category/Big-Data)
- [生物自然](https://kexue.fm/category/Biology)
- [图片摄影](https://kexue.fm/category/Photograph)
- [问题百科](https://kexue.fm/category/Questions)
- [生活/情感](https://kexue.fm/category/Life-Feeling)
- [资源共享](https://kexue.fm/category/Resources)

## NEWPOSTS

- [为什么Adam的Update RM...](https://kexue.fm/archives/11267)
- [重新思考学习率与Batch Siz...](https://kexue.fm/archives/11260)
- [Cool Papers更新：简单适...](https://kexue.fm/archives/11250)
- [流形上的最速下降：4\. Muon ...](https://kexue.fm/archives/11241)
- [ReLU/GeLU/Swish的一...](https://kexue.fm/archives/11233)
- [流形上的最速下降：3\. Muon ...](https://kexue.fm/archives/11221)
- [流形上的最速下降：2\. Muon ...](https://kexue.fm/archives/11215)
- [基于树莓派Zero2W搭建一个随身旁路由](https://kexue.fm/archives/11206)
- [流形上的最速下降：1\. SGD ...](https://kexue.fm/archives/11196)
- [矩阵r次方根和逆r次方根的高效计算](https://kexue.fm/archives/11175)

## COMMENTS

- [苏剑林: 你是指xml代码？那不是乱码，feed就是xml格式，你要自己...](https://kexue.fm/content.html/comment-page-1#comment-28521)
- [苏剑林: 都是我人工整理的，只要论文集是公开可访问、没有反爬虫的，理论上...](https://kexue.fm/archives/11250/comment-page-1#comment-28520)
- [苏剑林: 按照平均budget来算一个静态scaling factor，...](https://kexue.fm/archives/10945/comment-page-1#comment-28519)
- [苏剑林: 辛苦了，我提供一些参考思路。比如你整理的最后一个\
$$\\lef...](https://kexue.fm/archives/9370/comment-page-1#comment-28518)
- [苏剑林: loss-free属于训练部分，不在K2的开源范围内。但弄懂原...](https://kexue.fm/archives/10815/comment-page-1#comment-28517)
- [苏剑林: 1、GLU想要退化为一层linear更简单了，只要gate那边...](https://kexue.fm/archives/11233/comment-page-1#comment-28516)
- [苏剑林: 很好的想法，这个做法对于压缩maxlogit来说是没有问题的，...](https://kexue.fm/archives/11221/comment-page-1#comment-28515)
- [苏剑林: 1、跟low-rank关系不大，我们也是直接用muon的；\
2...](https://kexue.fm/archives/10592/comment-page-2#comment-28514)
- [苏剑林: 借用Feynman的一句话：what I can not cr...](https://kexue.fm/archives/11033/comment-page-2#comment-28513)
- [苏剑林: 你说的原始问题是啥？公式$(13)$吗？如果是的话，$\\bol...](https://kexue.fm/archives/10407/comment-page-1#comment-28512)

## USERLOGIN

- [登录](https://kexue.fm/admin/login.php)

[科学空间\|Scientific Spaces](https://kexue.fm)

- [登录](https://kexue.fm/admin/login.php)
- [打赏](https://kexue.fm/reward.html)
- [公式](https://kexue.fm/latex.html)
- [天象](https://kexue.fm/ac.html)
- [链接](https://kexue.fm/links.html)
- [时光](https://kexue.fm/me.html)
- [博览](https://kexue.fm/science.html)
- [归档](https://kexue.fm/content.html)

渴望成为一个小飞侠

- [欢迎订阅](https://kexue.fm/feed)
- [个性邮箱](https://kexue.fm/archives/119)
- [天象信息](https://kexue.fm/ac.html)
- [观测ISS](https://kexue.fm/archives/41)
- [LaTeX](https://kexue.fm/latex.html)
- [关于博主](https://kexue.fm/me.html)

欢迎访问“科学空间”，这里将与您共同探讨自然科学，回味人生百态；也期待大家的分享～

- [**千奇百怪** Everything](https://kexue.fm/category/Everything)
- [**天文探索** Astronomy](https://kexue.fm/category/Astronomy)
- [**数学研究** Mathematics](https://kexue.fm/category/Mathematics)
- [**物理化学** Phy-chem](https://kexue.fm/category/Phy-chem)
- [**信息时代** Big-Data](https://kexue.fm/category/Big-Data)
- [**生物自然** Biology](https://kexue.fm/category/Biology)
- [**图片摄影** Photograph](https://kexue.fm/category/Photograph)
- [**问题百科** Questions](https://kexue.fm/category/Questions)
- [**生活/情感** Life-Feeling](https://kexue.fm/category/Life-Feeling)
- [**资源共享** Resources](https://kexue.fm/category/Resources)

- [**千奇百怪**](https://kexue.fm/category/Everything)
- [**天文探索**](https://kexue.fm/category/Astronomy)
- [**数学研究**](https://kexue.fm/category/Mathematics)
- [**物理化学**](https://kexue.fm/category/Phy-chem)
- [**信息时代**](https://kexue.fm/category/Big-Data)
- [**生物自然**](https://kexue.fm/category/Biology)
- [**图片摄影**](https://kexue.fm/category/Photograph)
- [**问题百科**](https://kexue.fm/category/Questions)
- [**生活/情感**](https://kexue.fm/category/Life-Feeling)
- [**资源共享**](https://kexue.fm/category/Resources)

[首页](https://kexue.fm) [数学研究](https://kexue.fm/category/Mathematics) 流形上的最速下降：4\. Muon + 谱球面

21Aug

# [流形上的最速下降：4\. Muon + 谱球面](https://kexue.fm/archives/11241)

By 苏剑林 \|
2025-08-21 \|
12138位读者\|

看完了前三篇的读者，想必已经熟悉本系列的“套路”——先提出更新量的约束，寻找最速下降方向，接着再给参数也加上约束，寻找新的最速下降方向。在求解参数约束问题时，我们采用的是“一阶近似够用”原则来简化约束形式，这在几何上对应于“切空间”。然后，我们用待定系数法转化无约束形式来写出解析解，最后再数值求解待定系数。

这篇文章我们再来求解一个新例子——谱球面约束下的Muon——它是第一篇文章 [《流形上的最速下降：1\. SGD + 超球面》](https://kexue.fm/archives/11196) 的类比推广，当我们希望参数的谱范数始终不变时可以考虑它。当然，也可以单纯作为一道练习题来练手。

## 问题描述 [\#](https://kexue.fm/kexue.fm\#%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0)

在 [《流形上的最速下降：2\. Muon + 正交》](https://kexue.fm/archives/11215) 和 [《流形上的最速下降：3\. Muon + Stiefel》](https://kexue.fm/archives/11221) 中，我们已经详细讨论了Muon与正交约束的碰撞，所以相关背景我们就不展开了，直接给出问题形式：
\\begin{equation}\\newcommand{tr}{\\mathop{\\text{tr}}}\\max\_{\\boldsymbol{\\Phi}} \\tr(\\boldsymbol{G}^{\\top}\\boldsymbol{\\Phi}) \\qquad \\text{s.t.}\\qquad \\Vert\\boldsymbol{\\Phi}\\Vert\_2 = 1,\\,\\, \\Vert\\boldsymbol{W}\\Vert\_2 = 1,\\,\\,\\Vert\\boldsymbol{W} - \\eta \\boldsymbol{\\Phi}\\Vert\_2=1\\end{equation}
其中$\\boldsymbol{W},\\boldsymbol{\\Phi}\\in\\mathbb{R}^{n\\times m}(n \\geq m)$，$\\Vert\\cdot\\Vert\_2$是谱范数。当然，如果我们有兴趣，后面两个谱范数可以改用其他范数，比如$F$范数代表了“Muon + 超球面”的组合。

“一阶近似够用”原则需要我们求谱范数的梯度，这我们在 [《从谱范数梯度到新式权重衰减的思考》](https://kexue.fm/archives/10648) 和 [《SVD的导数》](https://kexue.fm/archives/10878) 都已经介绍过了，答案是$\\nabla\_{\\boldsymbol{W}}\\Vert\\boldsymbol{W}\\Vert\_2=\\boldsymbol{u}\_1 \\boldsymbol{v}\_1^{\\top}$，其中$\\boldsymbol{u}\_1,\\boldsymbol{v}\_1$是$\\boldsymbol{W}$的最大奇异值对应的两个奇异向量，可以由幂迭代求解。这个结果还有个最大奇异值唯一的假设，不唯一的情况我们后面再讨论。

如果是$F$范数，则有$\\nabla\_{\\boldsymbol{W}}\\Vert\\boldsymbol{W}\\Vert\_F=\\boldsymbol{W}/\\Vert\\boldsymbol{W}\\Vert\_F$。总之，不管是哪种范数，都存在一个只依赖于$\\boldsymbol{W}$的矩阵$\\boldsymbol{\\Theta}$，使得$\\nabla\_{\\boldsymbol{W}}\\Vert\\boldsymbol{W}\\Vert=\\boldsymbol{\\Theta}$，那么由$\\Vert\\boldsymbol{W}\\Vert = 1$和$\\Vert\\boldsymbol{W} - \\eta \\boldsymbol{\\Phi}\\Vert=1$可以得到它的一阶近似版$0 = \\langle\\boldsymbol{\\Theta},\\boldsymbol{\\Phi}\\rangle\_F = \\tr(\\boldsymbol{\\Theta}^{\\top} \\boldsymbol{\\Phi})$。所以，在一阶近似下，此类问题的通用提法是：
\\begin{equation}\\max\_{\\boldsymbol{\\Phi}} \\tr(\\boldsymbol{G}^{\\top}\\boldsymbol{\\Phi}) \\qquad \\text{s.t.}\\qquad \\Vert\\boldsymbol{\\Phi}\\Vert\_2 = 1,\\,\\, \\tr(\\boldsymbol{\\Theta}^{\\top} \\boldsymbol{\\Phi})=0\\end{equation}

## 待定系数 [\#](https://kexue.fm/kexue.fm\#%E5%BE%85%E5%AE%9A%E7%B3%BB%E6%95%B0)

套路还是一样的，引入待定系数$\\lambda$，我们有
\\begin{equation}\\begin{aligned}
\\tr(\\boldsymbol{G}^{\\top}\\boldsymbol{\\Phi}) =&\\, \\tr(\\boldsymbol{G}^{\\top}\\boldsymbol{\\Phi}) + \\lambda \\tr(\\boldsymbol{\\Theta}^{\\top} \\boldsymbol{\\Phi}) \\\
=&\\, \\tr((\\boldsymbol{G} + \\lambda\\boldsymbol{\\Theta})^{\\top}\\boldsymbol{\\Phi}) \\\
\\leq &\\,\\Vert\\boldsymbol{G} + \\lambda\\boldsymbol{\\Theta}\\Vert\_\*
\\end{aligned}\\end{equation}
最后一个不等式是Muon本身的结果，类似于两个向量的Hölder不等式，等号在
\\begin{equation}\\boldsymbol{\\Phi} = \\newcommand{msign}{\\mathop{\\text{msign}}}\\msign(\\boldsymbol{G} + \\lambda\\boldsymbol{\\Theta})\\end{equation}
接下来的任务是需要解出一个$\\lambda$，使得它满足约束条件$\\tr(\\boldsymbol{\\Theta}^{\\top} \\boldsymbol{\\Phi})=0$，就大功告成了。

由于$\\msign$的存在，$\\tr(\\boldsymbol{\\Theta}^{\\top} \\boldsymbol{\\Phi})=0$实际上是一个非线性方程，笔者倾向于它没有解析解，所以寻求数值解法。不过有了 [《流形上的最速下降：3\. Muon + Stiefel》](https://kexue.fm/archives/11221) 的经验后，面对此类方程我们也可以从容地构建迭代法了。

## 迭代求解 [\#](https://kexue.fm/kexue.fm\#%E8%BF%AD%E4%BB%A3%E6%B1%82%E8%A7%A3)

首先，根据定义$\\msign(\\boldsymbol{M}) = \\boldsymbol{M}(\\boldsymbol{M}^{\\top}\\boldsymbol{M})^{-1/2}$，我们可以写出$\\boldsymbol{\\Phi}=(\\boldsymbol{G} + \\lambda\\boldsymbol{\\Theta})\\boldsymbol{Q}^{-1}$，其中$\\boldsymbol{Q}=((\\boldsymbol{G} + \\lambda\\boldsymbol{\\Theta})^{\\top}(\\boldsymbol{G} + \\lambda\\boldsymbol{\\Theta}))^{1/2}$，那么
\\begin{equation}\\tr(\\boldsymbol{\\Theta}^{\\top} \\boldsymbol{\\Phi})=0\\qquad\\Rightarrow\\qquad \\lambda = -\\frac{\\tr(\\boldsymbol{\\Theta}^{\\top}\\boldsymbol{G}\\boldsymbol{Q}^{-1})}{\\tr(\\boldsymbol{\\Theta}^{\\top}\\boldsymbol{\\Theta}\\boldsymbol{Q}^{-1})}\\end{equation}
但要注意，这并不是一个解析解，因为$\\boldsymbol{Q}$也是依赖于$\\lambda$的。但根据上式我们可以构建一个迭代格式：代入一个初始$\\lambda$就可以求$\\boldsymbol{Q}= (\\boldsymbol{G} + \\lambda\\boldsymbol{\\Theta})^{\\top}\\boldsymbol{\\Phi}$，然后代入上式更新$\\lambda$，反复执行直到收敛。

然而，这个迭代方案虽然理论上可行，但需要算$\\boldsymbol{Q}^{-1}$，尽管我们在 [《矩阵r次方根和逆r次方根的高效计算》](https://kexue.fm/archives/11175) 已经提过高效的求解算法，但从“勿增实体”的角度看，我们还是希望避免出现$\\msign$以外的迭代。所以，笔者尝试寻找另外一个不需要求$\\boldsymbol{Q}^{-1}$的迭代方案。为此，我们先写出
\\begin{equation}\\boldsymbol{\\Theta}^{\\top} \\boldsymbol{\\Phi} = \\boldsymbol{\\Theta}^{\\top}(\\boldsymbol{G} + \\lambda\\boldsymbol{\\Theta})\\boldsymbol{Q}^{-1}\\end{equation}
对于我们的目标，上式的迹等于零，我们可以在上式左边显式地减去$\\tr(\\boldsymbol{\\Theta}^{\\top} \\boldsymbol{\\Phi})\\boldsymbol{I}/m$，保证它满足这个条件
\\begin{equation}\\boldsymbol{\\Theta}^{\\top} \\boldsymbol{\\Phi} - \\tr(\\boldsymbol{\\Theta}^{\\top} \\boldsymbol{\\Phi})\\boldsymbol{I}/m = \\boldsymbol{\\Theta}^{\\top}(\\boldsymbol{G} + \\lambda\\boldsymbol{\\Theta})\\boldsymbol{Q}^{-1}\\end{equation}
这时候两边乘$\\boldsymbol{Q}$，然后取迹就可以反解出$\\lambda$
\\begin{equation}\\lambda = \\frac{\\tr(\\boldsymbol{\\Theta}^{\\top} \\boldsymbol{\\Phi}\\boldsymbol{Q}) - \\tr(\\boldsymbol{\\Theta}^{\\top}\\boldsymbol{\\Phi}) \\tr(\\boldsymbol{Q})/m - \\tr(\\boldsymbol{\\Theta}^{\\top}\\boldsymbol{G})}{\\tr(\\boldsymbol{\\Theta}^{\\top}\\boldsymbol{\\Theta})}\\end{equation}
这样迭代起来就不用求$\\boldsymbol{Q}^{-1}$了。

## 参考代码 [\#](https://kexue.fm/kexue.fm\#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81)

我们以$\\lambda=-\\tr(\\boldsymbol{\\Theta}^{\\top}\\boldsymbol{G})/\\tr(\\boldsymbol{\\Theta}^{\\top}\\boldsymbol{\\Theta})$为初始值，测试代码如下：

```
import numpy as np

def msign(g):
 """奇异值分解精确计算msign
 """
 u, s, vh = np.linalg.svd(g, full_matrices=False)
 return u @ np.diag(np.sign(s)) @ vh

def dot(a, b):
 """恒等于 np.trace(a.T @ b)
 """
 return (a * b).sum()

n, m = 100, 50
w = np.random.randn(n, m) / m**0.5
g = np.random.randn(n, m) / m**0.5
u, s, vh = np.linalg.svd(w, full_matrices=False)
theta = u[:, :1] @ vh[:1]

lamb = - dot(theta, g) / dot(theta, theta)
for i in range(10):
 phi = msign(z := g + lamb * theta)
 print('step:', i, ', inner product:', dot(phi, g), ', tangent error:', dot(theta, phi))
 q, x = z.T @ phi, theta.T @ phi
 lamb = (dot(x, q) - np.trace(x) * np.trace(q) / m - dot(theta, g)) / dot(theta, theta)
```

## 其他细节 [\#](https://kexue.fm/kexue.fm\#%E5%85%B6%E4%BB%96%E7%BB%86%E8%8A%82)

同前三篇文章一样，由于使用了“一阶近似够用”原则，所以$\\boldsymbol{W} - \\eta\\boldsymbol{\\Phi}$的谱范数准确到$1 + \\mathcal{O}(\\eta^2)$，通常没法精确到1，所以我们还需要做一次谱归一化（Spectral Normalization）：
\\begin{equation}\\boldsymbol{W}\\quad\\leftarrow\\quad \\frac{\\boldsymbol{W} - \\eta\\boldsymbol{\\Phi}}{\\Vert\\boldsymbol{W} - \\eta\\boldsymbol{\\Phi}\\Vert\_2}\\end{equation}
幸运的是，谱范数可以通过幂迭代来高效计算，所以这并不是特别昂贵的计算（相比$\\msign$本身的迭代来说）。

另外可以值得分析一番的是最大奇异值不唯一的情形，实际数值计算时可以忽略这种特殊情形，但从理论的完整性来说应该将它纳入分析范围内。这时候对应的奇异向量也不唯一，等价于说有多个不同的切空间，实际可行空间是这些切空间的交集。我们以两个最大奇异值为例，此时问题变成
\\begin{equation}\\max\_{\\boldsymbol{\\Phi}} \\tr(\\boldsymbol{G}^{\\top}\\boldsymbol{\\Phi}) \\qquad \\text{s.t.}\\qquad \\Vert\\boldsymbol{\\Phi}\\Vert\_2 = 1,\\,\\, \\tr(\\boldsymbol{\\Theta}\_1^{\\top} \\boldsymbol{\\Phi})=0,\\,\\, \\tr(\\boldsymbol{\\Theta}\_2^{\\top} \\boldsymbol{\\Phi})=0\\end{equation}
这里$\\boldsymbol{\\Theta}\_1=\\boldsymbol{u}\_1 \\boldsymbol{v}\_1^{\\top}, \\boldsymbol{\\Theta}\_2=\\boldsymbol{u}\_2 \\boldsymbol{v}\_2^{\\top}$。引入两个待定系数$\\lambda\_1,\\lambda\_2$，我们可以解得
\\begin{equation}\\boldsymbol{\\Phi} = \\msign(\\boldsymbol{G} + \\lambda\_1\\boldsymbol{\\Theta}\_1+ \\lambda\_2\\boldsymbol{\\Theta}\_2)\\end{equation}
接下来要求解方程组$\\tr(\\boldsymbol{\\Theta}\_1^{\\top} \\boldsymbol{\\Phi})=0,\\tr(\\boldsymbol{\\Theta}\_2^{\\top} \\boldsymbol{\\Phi})=0$。类似地，引入
\\begin{equation}\\boldsymbol{Q}=((\\boldsymbol{G} + \\lambda\_1\\boldsymbol{\\Theta}\_1+ \\lambda\_2\\boldsymbol{\\Theta}\_2)^{\\top}(\\boldsymbol{G} + \\lambda\_1\\boldsymbol{\\Theta}\_1+ \\lambda\_2\\boldsymbol{\\Theta}\_2))^{1/2} = (\\boldsymbol{G} + \\lambda\_1\\boldsymbol{\\Theta}\_1+ \\lambda\_2\\boldsymbol{\\Theta}\_2)^{\\top}\\boldsymbol{\\Phi}\\end{equation}
可以写出方程组
\\begin{equation}\\begin{gathered}
\\boldsymbol{\\Theta}\_1^{\\top} \\boldsymbol{\\Phi} - \\tr(\\boldsymbol{\\Theta}\_1^{\\top} \\boldsymbol{\\Phi})\\boldsymbol{I}/m = \\boldsymbol{\\Theta}\_1^{\\top}(\\boldsymbol{G} + \\lambda\_1\\boldsymbol{\\Theta}\_1+ \\lambda\_2\\boldsymbol{\\Theta}\_2)\\boldsymbol{Q}^{-1} \\\
\\boldsymbol{\\Theta}\_2^{\\top} \\boldsymbol{\\Phi} - \\tr(\\boldsymbol{\\Theta}\_2^{\\top} \\boldsymbol{\\Phi})\\boldsymbol{I}/m = \\boldsymbol{\\Theta}\_2^{\\top}(\\boldsymbol{G} + \\lambda\_1\\boldsymbol{\\Theta}\_1+ \\lambda\_2\\boldsymbol{\\Theta}\_2)\\boldsymbol{Q}^{-1} \\\
\\end{gathered}\\end{equation}
两边乘$\\boldsymbol{Q}$然后取迹，就变成了关于可以求解的$\\lambda\_1,\\lambda\_2$的二元一次方程组，那么就可以据此来构建迭代求解格式了。其中细节就不展开讨论了，有兴趣练手的读者自行补充完整就好。

## 文章小结 [\#](https://kexue.fm/kexue.fm\#%E6%96%87%E7%AB%A0%E5%B0%8F%E7%BB%93)

这篇文章主要考虑了给参数施加谱范数或者一般的范数约束后，对应的Muon形式。在前三篇的基础上，本篇没有明显的技术难点，读者也可以单纯视为一道补充习题来练手。

_**转载到请包括本文地址：** [https://kexue.fm/archives/11241](https://kexue.fm/archives/11241)_

_**更详细的转载事宜请参考：**_ [《科学空间FAQ》](https://kexue.fm/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8)

**如果您还有什么疑惑或建议，欢迎在下方评论区继续讨论。**

**如果您觉得本文还不错，欢迎 [分享](https://kexue.fm/kexue.fm#share)/ [打赏](https://kexue.fm/kexue.fm#pay) 本文。打赏并非要从中获得收益，而是希望知道科学空间获得了多少读者的真心关注。当然，如果你无视它，也不会影响你的阅读。再次表示欢迎和感谢！**

打赏

微信打赏

支付宝打赏

因为网站后台对打赏并无记录，因此欢迎在打赏时候备注留言。你还可以 [**点击这里**](http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=tN7d1drY3drrx8H0xcWa19vZ) 或在下方评论区留言来告知你的建议或需求。

**如果您需要引用本文，请参考：**

苏剑林. (Aug. 21, 2025). 《流形上的最速下降：4. Muon + 谱球面 》\[Blog post\]. Retrieved from [https://kexue.fm/archives/11241](https://kexue.fm/archives/11241)

@online{kexuefm-11241,
        title={流形上的最速下降：4. Muon + 谱球面},
        author={苏剑林},
        year={2025},
        month={Aug},
        url={\\url{https://kexue.fm/archives/11241}},
}

分类： [数学研究](https://kexue.fm/category/Mathematics)    标签： [矩阵](https://kexue.fm/tag/%E7%9F%A9%E9%98%B5/), [优化器](https://kexue.fm/tag/%E4%BC%98%E5%8C%96%E5%99%A8/), [muon](https://kexue.fm/tag/muon/), [约束](https://kexue.fm/tag/%E7%BA%A6%E6%9D%9F/), [最速下降](https://kexue.fm/tag/%E6%9C%80%E9%80%9F%E4%B8%8B%E9%99%8D/)[1 评论](https://kexue.fm/archives/11241#comments)

< [ReLU/GeLU/Swish的一个恒等式](https://kexue.fm/archives/11233) \| [Cool Papers更新：简单适配Zotero Connector](https://kexue.fm/archives/11250) >

### 你也许还对下面的内容感兴趣

- [为什么Adam的Update RMS是0.2？](https://kexue.fm/archives/11267)
- [重新思考学习率与Batch Size的关系（一）：现状](https://kexue.fm/archives/11260)
- [流形上的最速下降：3\. Muon + Stiefel](https://kexue.fm/archives/11221)
- [流形上的最速下降：2\. Muon + 正交](https://kexue.fm/archives/11215)
- [流形上的最速下降：1\. SGD + 超球面](https://kexue.fm/archives/11196)
- [矩阵r次方根和逆r次方根的高效计算](https://kexue.fm/archives/11175)
- [矩阵平方根和逆平方根的高效计算](https://kexue.fm/archives/11158)
- [QK-Clip：让Muon在Scaleup之路上更进一步](https://kexue.fm/archives/11126)
- [“对角+低秩”三角阵的高效求逆方法](https://kexue.fm/archives/11072)
- [通过msign来计算奇异值裁剪mclip（下）](https://kexue.fm/archives/11059)

[发表你的看法](https://kexue.fm/kexue.fm#comment_form)

[长琴](https://yam.gift)

August 22nd, 2025

先点个赞！又有一阵没看了，得赶紧好好补课了。

[回复评论](https://kexue.fm/archives/11241/comment-page-1?replyTo=28423#respond-post-11241)

[取消回复](https://kexue.fm/archives/11241#respond-post-11241)

你的大名

电子邮箱

个人网站（选填）

1\. 可以使用LaTeX代码，点击“预览效果”可查看效果；2. 可以通过点击评论楼层编号来引用该楼层；3. 网站可能会有点卡，如非确认评论失败，请 **不要重复点击提交**。

### 内容速览

[问题描述](https://kexue.fm/kexue.fm#%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0)
[待定系数](https://kexue.fm/kexue.fm#%E5%BE%85%E5%AE%9A%E7%B3%BB%E6%95%B0)
[迭代求解](https://kexue.fm/kexue.fm#%E8%BF%AD%E4%BB%A3%E6%B1%82%E8%A7%A3)
[参考代码](https://kexue.fm/kexue.fm#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81)
[其他细节](https://kexue.fm/kexue.fm#%E5%85%B6%E4%BB%96%E7%BB%86%E8%8A%82)
[文章小结](https://kexue.fm/kexue.fm#%E6%96%87%E7%AB%A0%E5%B0%8F%E7%BB%93)

### 智能搜索

支持整句搜索！网站自动使用 [结巴分词](https://github.com/fxsjy/jieba) 进行分词，并结合ngrams排序算法给出合理的搜索结果。

### 热门标签

[生成模型](https://kexue.fm/tag/%E7%94%9F%E6%88%90%E6%A8%A1%E5%9E%8B/) [attention](https://kexue.fm/tag/attention/) [优化](https://kexue.fm/tag/%E4%BC%98%E5%8C%96/) [语言模型](https://kexue.fm/tag/%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B/) [模型](https://kexue.fm/tag/%E6%A8%A1%E5%9E%8B/) [网站](https://kexue.fm/tag/%E7%BD%91%E7%AB%99/) [概率](https://kexue.fm/tag/%E6%A6%82%E7%8E%87/) [梯度](https://kexue.fm/tag/%E6%A2%AF%E5%BA%A6/) [转载](https://kexue.fm/tag/%E8%BD%AC%E8%BD%BD/) [矩阵](https://kexue.fm/tag/%E7%9F%A9%E9%98%B5/) [微分方程](https://kexue.fm/tag/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/) [分析](https://kexue.fm/tag/%E5%88%86%E6%9E%90/) [优化器](https://kexue.fm/tag/%E4%BC%98%E5%8C%96%E5%99%A8/) [天象](https://kexue.fm/tag/%E5%A4%A9%E8%B1%A1/) [深度学习](https://kexue.fm/tag/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/) [积分](https://kexue.fm/tag/%E7%A7%AF%E5%88%86/) [python](https://kexue.fm/tag/python/) [力学](https://kexue.fm/tag/%E5%8A%9B%E5%AD%A6/) [无监督](https://kexue.fm/tag/%E6%97%A0%E7%9B%91%E7%9D%A3/) [扩散](https://kexue.fm/tag/%E6%89%A9%E6%95%A3/) [几何](https://kexue.fm/tag/%E5%87%A0%E4%BD%95/) [节日](https://kexue.fm/tag/%E8%8A%82%E6%97%A5/) [生活](https://kexue.fm/tag/%E7%94%9F%E6%B4%BB/) [文本生成](https://kexue.fm/tag/%E6%96%87%E6%9C%AC%E7%94%9F%E6%88%90/) [数论](https://kexue.fm/tag/%E6%95%B0%E8%AE%BA/)

### 随机文章

- [如何度量数据的稀疏程度？](https://kexue.fm/archives/9595)
- [记IOAA之旅](https://kexue.fm/archives/931)
- [积分估计的极值原理——变分原理的初级版本](https://kexue.fm/archives/3630)
- [MoE环游记：2、不患寡而患不均](https://kexue.fm/archives/10735)
- [msign算子的Newton-Schulz迭代（上）](https://kexue.fm/archives/10922)
- [当概率遇上复变：随机游走与路径积分](https://kexue.fm/archives/2609)
- [《巨眼问苍穹》：讲述望远镜的400年](https://kexue.fm/archives/356)
- [已知中心五边形，作五边形](https://kexue.fm/archives/753)
- [【不可思议的Word2Vec】 3.提取关键词](https://kexue.fm/archives/4316)
- [《方程与宇宙》：三体问题和它的初积分(六)](https://kexue.fm/archives/1181)

### 最近评论

- [苏剑林](https://kexue.fm/content.html/comment-page-1#comment-28521): 你是指xml代码？那不是乱码，feed就是xml格式，你要自己找工具订阅。
- [苏剑林](https://kexue.fm/archives/11250/comment-page-1#comment-28520): 都是我人工整理的，只要论文集是公开可访问、没有反爬虫的，理论上都可以，当然实际上行不行，还得看...
- [苏剑林](https://kexue.fm/archives/10945/comment-page-1#comment-28519): 按照平均budget来算一个静态scaling factor，好像也是一个挺合理的事情？
- [苏剑林](https://kexue.fm/archives/9370/comment-page-1#comment-28518): 辛苦了，我提供一些参考思路。比如你整理的最后一个
$$\\left\\Vert \\boldsym...
- [苏剑林](https://kexue.fm/archives/10815/comment-page-1#comment-28517): loss-free属于训练部分，不在K2的开源范围内。但弄懂原理后实现应该不算难。
- [苏剑林](https://kexue.fm/archives/11233/comment-page-1#comment-28516): 1、GLU想要退化为一层linear更简单了，只要gate那边退化为一个常数就行；
2、这个就...
- [苏剑林](https://kexue.fm/archives/11221/comment-page-1#comment-28515): 很好的想法，这个做法对于压缩maxlogit来说是没有问题的，但如果单纯为了压缩maxlogi...
- [苏剑林](https://kexue.fm/archives/10592/comment-page-2#comment-28514): 1、跟low-rank关系不大，我们也是直接用muon的；
2、我们都是用match adam...
- [苏剑林](https://kexue.fm/archives/11033/comment-page-2#comment-28513): 借用Feynman的一句话：what I can not create, I do not u...
- [苏剑林](https://kexue.fm/archives/10407/comment-page-1#comment-28512): 你说的原始问题是啥？公式$(13)$吗？如果是的话，$\\boldsymbol{A},\\bold...

### 友情链接

- [Cool Papers](https://papers.cool)
- [数学研发](https://bbs.emath.ac.cn)
- [Seatop](http://www.seatop.com.cn/)
- [Xiaoxia](https://xiaoxia.org/)
- [积分表-网络版](https://kexue.fm/sci/integral/index.html)
- [丝路博傲](http://blog.dvxj.com/)
- [数学之家](http://www.2math.cn/)
- [有趣天文奇观](http://interesting-sky.china-vo.org/)
- [TwistedW](http://www.twistedwg.com/)
- [godweiyang](https://godweiyang.com/)
- [AI柠檬](https://blog.ailemon.net/)
- [王登科-DK博客](https://greatdk.com)
- [ESON](https://blog.eson.org/)
- [枫之羽](https://fzhiy.net/)
- [Mathor's blog](https://wmathor.com/)
- [coding-zuo](https://coding-zuo.github.io/)
- [博科园](https://www.bokeyuan.net/)
- [孔皮皮的博客](https://www.kppkkp.top/)
- [运鹏的博客](https://yunpengtai.top/)
- [jiming.site](https://jiming.site/)
- [OmegaXYZ](https://www.omegaxyz.com/)
- [EAI猩球](https://www.robotech.ink/)
- [文举的博客](https://liwenju0.com/)
- [用代码打点酱油](https://bruceyuan.com/)
- [Zhang's blog](https://armcvai.cn/)
- [申请链接](https://kexue.fm/links.html)

本站采用创作共用版权协议，要求署名、非商业用途和保持一致。转载本站内容必须也遵循“ [署名-非商业用途-保持一致](http://creativecommons.org/licenses/by-nc-nd/2.5/cn/)”的创作共用协议。
© 2009-2025 Scientific Spaces. All rights reserved. Theme by [laogui](http://www.laogui.com). Powered by [Typecho](http://typecho.org). 备案号: [粤ICP备09093259号-1/2](https://beian.miit.gov.cn/)。