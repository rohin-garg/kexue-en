## SEARCH

## MENU

- [打赏](https://kexue.fm/reward.html)
- [公式](https://kexue.fm/latex.html)
- [天象](https://kexue.fm/ac.html)
- [链接](https://kexue.fm/links.html)
- [时光](https://kexue.fm/me.html)
- [博览](https://kexue.fm/science.html)
- [归档](https://kexue.fm/content.html)

## CATEGORIES

- [千奇百怪](https://kexue.fm/category/Everything)
- [天文探索](https://kexue.fm/category/Astronomy)
- [数学研究](https://kexue.fm/category/Mathematics)
- [物理化学](https://kexue.fm/category/Phy-chem)
- [信息时代](https://kexue.fm/category/Big-Data)
- [生物自然](https://kexue.fm/category/Biology)
- [图片摄影](https://kexue.fm/category/Photograph)
- [问题百科](https://kexue.fm/category/Questions)
- [生活/情感](https://kexue.fm/category/Life-Feeling)
- [资源共享](https://kexue.fm/category/Resources)

## NEWPOSTS

- [生成扩散模型漫谈（三十一）：预测数...](https://kexue.fm/archives/11428)
- [Muon优化器指南：快速上手与关键细节](https://kexue.fm/archives/11416)
- [AdamW的Weight RMS的...](https://kexue.fm/archives/11404)
- [n个正态随机数的最大值的渐近估计](https://kexue.fm/archives/11390)
- [流形上的最速下降：5\. 对偶梯度下降](https://kexue.fm/archives/11388)
- [低精度Attention可能存在有...](https://kexue.fm/archives/11371)
- [MuP之上：1. 好模型的三个特征](https://kexue.fm/archives/11340)
- [随机矩阵的谱范数的快速估计](https://kexue.fm/archives/11335)
- [DiVeQ：一种非常简洁的VQ训练方案](https://kexue.fm/archives/11328)
- [为什么线性注意力要加Short C...](https://kexue.fm/archives/11320)

## COMMENTS

- [夺宇: 苏老师的解释和推导好自然啊，比原论文更容易看懂](https://kexue.fm/archives/9152/comment-page-3#comment-28932)
- [夺宇: 苏老师，(17)式中的噪声项可以直接在(8)式中直接添加吗？(...](https://kexue.fm/archives/9119/comment-page-13#comment-28931)
- [Xiaozhi Zhu: 我觉得这个work摆脱了two stages，真正做到E2E，...](https://kexue.fm/archives/11428/comment-page-1#comment-28930)
- [wednesday: 想问问苏老师的数据挖掘学习思路或者学习路径是怎样的](https://kexue.fm/archives/3319/comment-page-1#comment-28929)
- [wednesday: 因为我们只对p(Y\|X)建模，因此$p\_{\\theta}(X)...](https://kexue.fm/archives/5239/comment-page-3#comment-28928)
- [ykwen: 不动点迭代的时候 有没有可能迭代到0附近呢？](https://kexue.fm/archives/10592/comment-page-3#comment-28927)
- [wednesday: 这是针对评论区一位同学问题的提问，现在已经懂了](https://kexue.fm/archives/5253/comment-page-18#comment-28926)
- [wednesday: 针对一个样本和针对一个batch有什么特别的区别吗](https://kexue.fm/archives/5253/comment-page-18#comment-28925)
- [Zhancun: 也可以从natural image space的角度去理解。对...](https://kexue.fm/archives/11428/comment-page-1#comment-28924)
- [Plkcs5: 你好，可以学习一下您的工作吗，想知道是否有论文或开源代码可以学...](https://kexue.fm/archives/9497/comment-page-2#comment-28923)

## USERLOGIN

- [登录](https://kexue.fm/admin/login.php)

[科学空间\|Scientific Spaces](https://kexue.fm)

- [登录](https://kexue.fm/admin/login.php)
- [打赏](https://kexue.fm/reward.html)
- [公式](https://kexue.fm/latex.html)
- [天象](https://kexue.fm/ac.html)
- [链接](https://kexue.fm/links.html)
- [时光](https://kexue.fm/me.html)
- [博览](https://kexue.fm/science.html)
- [归档](https://kexue.fm/content.html)

渴望成为一个小飞侠

- [欢迎订阅](https://kexue.fm/feed)
- [个性邮箱](https://kexue.fm/archives/119)
- [天象信息](https://kexue.fm/ac.html)
- [观测ISS](https://kexue.fm/archives/41)
- [LaTeX](https://kexue.fm/latex.html)
- [关于博主](https://kexue.fm/me.html)

欢迎访问“科学空间”，这里将与您共同探讨自然科学，回味人生百态；也期待大家的分享～

- [**千奇百怪** Everything](https://kexue.fm/category/Everything)
- [**天文探索** Astronomy](https://kexue.fm/category/Astronomy)
- [**数学研究** Mathematics](https://kexue.fm/category/Mathematics)
- [**物理化学** Phy-chem](https://kexue.fm/category/Phy-chem)
- [**信息时代** Big-Data](https://kexue.fm/category/Big-Data)
- [**生物自然** Biology](https://kexue.fm/category/Biology)
- [**图片摄影** Photograph](https://kexue.fm/category/Photograph)
- [**问题百科** Questions](https://kexue.fm/category/Questions)
- [**生活/情感** Life-Feeling](https://kexue.fm/category/Life-Feeling)
- [**资源共享** Resources](https://kexue.fm/category/Resources)

- [**千奇百怪**](https://kexue.fm/category/Everything)
- [**天文探索**](https://kexue.fm/category/Astronomy)
- [**数学研究**](https://kexue.fm/category/Mathematics)
- [**物理化学**](https://kexue.fm/category/Phy-chem)
- [**信息时代**](https://kexue.fm/category/Big-Data)
- [**生物自然**](https://kexue.fm/category/Biology)
- [**图片摄影**](https://kexue.fm/category/Photograph)
- [**问题百科**](https://kexue.fm/category/Questions)
- [**生活/情感**](https://kexue.fm/category/Life-Feeling)
- [**资源共享**](https://kexue.fm/category/Resources)

[首页](https://kexue.fm) [信息时代](https://kexue.fm/category/Big-Data) 生成扩散模型漫谈（三十一）：预测数据而非噪声

24Nov

# [生成扩散模型漫谈（三十一）：预测数据而非噪声](https://kexue.fm/archives/11428)

By 苏剑林 \|
2025-11-24 \|
8007位读者\|

时至今日， [LDM（Latent Diffusion Models）](https://papers.cool/arxiv/2112.10752) 依旧是扩散模型的主流范式。借助Encoder对原始图像进行高倍压缩，LDM能显著减少训练与推理的计算成本，同时还能降低训难度，可谓一举多得。然而，高倍压缩也意味着信息损失，而且“压缩、生成、解压缩”的流水线也少了些端到端的美感。因此，始终有一部分人执着于“回到像素空间”，希望让扩散模型直接在原始数据上完成生成。

本文要介绍的 [《Back to Basics: Let Denoising Generative Models Denoise》](https://papers.cool/arxiv/2511.13720) 正是这一思路的新工作，它基于原始数据往往处于低维子流形这一事实，提出模型应预测数据而不是噪声，由此得到“JiT（Just image Transformers）”，显著地简化了像素空间的扩散模型架构。

## 信噪之比 [\#](https://kexue.fm/kexue.fm\#%E4%BF%A1%E5%99%AA%E4%B9%8B%E6%AF%94)

毋庸置疑，当今扩散模型的“主力军”依然是LDM，即便是前段时间颇为热闹的 [RAE](https://papers.cool/arxiv/2510.11690)，也只是声称LDM的Encoder已经“过时”了，要给它换一个新的更强的Encoder，但依然没改变“先压缩后生成”这一模式。

之所以有如此局面，除了因为LDM能显著降低大图生成的计算成本外，还有一个关键原因是，在相当长时间内，研究人员发现直接像素空间做高分辨率的扩散生成似乎存在一些“固有困难”，具体表现为将低分辨率下行之有效的配置（比如Noise Schedule）用于高分辨率扩散模型的训练，最终结果会明显变差，具体表现为收敛速度慢、FID不如低分辨率模型等。

后来， [Simple Diffusion](https://papers.cool/arxiv/2301.11093) 等工作意识到了导致这一现象的关键原因：同一Noise Schedule用到更高分辨率的图像上，其信噪比本质上是增加的。具体来说，当我们将同样强度的噪声施加到小图和大图，然后缩放到同一大小，那么大图看起来会更清晰。因此，用同样的Noise Schedule去训练高分辨率扩散模型时，去噪的难度无形之中变低了，于是带来了训练效率低下、效果不佳等问题。

同一noise不同分辨率的信噪比

意识到这个原因后，解决办法也就不难想了：调整高分辨率扩散模型的Noise Schedule，提高相应的噪声强度，以对齐每一步的信噪比即可。更详细的讨论可以参考之前的博客 [《生成扩散模型漫谈（二十二）：信噪比与大图生成（上）》](https://kexue.fm/archives/10047)。自此以后，像素空间中的扩散模型便逐渐追上了LDM的效果，开始体现出自己的竞争力。

## 模型瓶颈 [\#](https://kexue.fm/kexue.fm\#%E6%A8%A1%E5%9E%8B%E7%93%B6%E9%A2%88)

然而，尽管在指标（如FID或IS）方面像素空间的扩散模型已经追上LDM了，但仍绕不开另一个让人困惑的问题：为了得到与低分辨率模型相近的指标，高分辨率模型必须付出更多的计算，比如更多的训练步数、更大的模型、更大的Feature Map等。

可能有读者觉得没什么：生成更大的图需要更大的成本，这不是很合理？咋看之下是有道理，但仔细想想就会发现并不科学。大图生成本质上也许更为困难，但至少对FID/IS等指标来说不应该，因为这俩指标都是将生成结果缩放到特定大小后才计算的。这意味着如果我们有一批小图，那么想要得到一批FID/IS都不变的大图是很容易的，只需要将每张小图都UpSample一下就行了，几乎零额外成本。

这时候可能会有人指出“UpSample得到的大图会缺细节啊”，没错，这就是刚才说的“大图生成本质上也许更为困难”，因为它需要生成更多的细节。但是，UpSample这个操作，至少对FID和IS是不变的。这就意味着，理论上来说，我付出同等的算力，应该至少能得到一个FID/IS都大致相同的、但细节可能不足的大图生成模型。但事实并非如此，很多时候我们只能得到一个全方面明显更糟糕的模型。

让我们来将这个问题具体化一下。假设Baseline是一个$128\\times 128$的小图模型，它按$8\\times 8$的Patch对输入进行Patchify，线性投影到768维，再送入一个 hidden\_size=768 的ViT，最后线性投影回图片大小，这个配置在$128\\times 128$分辨率上工作良好。接着我们要做的$512\\times 512$的大图生成，我只需要将Patch Size改为$32\\times 32$，那么除了输入输出的投影略为变大后，整体计算量几乎不变。

现在的问题是：用这样的一个计算成本大致相同的模型去训$512\\times 512$的扩散模型，我们能得到跟$128\\times 128$分辨率模型一样的FID/IS吗？

## 低维流形 [\#](https://kexue.fm/kexue.fm\#%E4%BD%8E%E7%BB%B4%E6%B5%81%E5%BD%A2)

对于JiT之前的扩散模型，答案是大概率不行，因为这样的模型在高分辨率时具有低秩瓶颈。

此前扩散模型有两种主流范式，一是像 [DDPM](https://kexue.fm/archives/9119) 那样预测噪声，一是像 [ReFlow](https://kexue.fm/archives/9497) 那样预测噪声与原图之差（速度），二者的回归目标都有噪声。噪声向量是独立重复地从正态分布采样出来的，它能“铺满”整个空间，用数学的话说它的支撑（Support）是全空间。这样一来，模型要想成功预测任意噪声向量，那么至少不能存在低秩瓶颈，否则连恒等映射都无法实现，更不用说去噪了。

回到刚才的例子，当Patch Size改为$32\\times 32$后，输入维度是$32\\times 32\\times 3 = 3072$，再降维投影到768维，这自然是不可逆的，因此如果我们还是用它预测噪声或速度的话，就会因为低秩瓶颈而效果不佳。这里的关键问题是实际模型并非真的具有万能拟合能力，而是或多或少存在一些拟合瓶颈。

说到这里，其实JiT的核心改动已经呼之欲出了：

> 相比于噪声，原始数据的有效维度往往更低，也就是说原始数据处于一个更低维的子流形中，这意味着模型预测数据会比预测噪声更加“轻松”，因此模型应优先选择预测原始数据，尤其是网络容量有限时。

说白了，就是原始数据比如图像往往具有特定的结构，所以预测起来更简单，因此模型应该预测图像，这样可以将低秩瓶颈的影响降到最低，甚至可能将劣势转化为优势。

分开来看，这里的每一个小点都不是新的：噪声的支撑是全空间、原始数据往往处于低维流形，这些结论某种程度上已是“广为人知”；至于直接用模型预测图像而不是噪声，这也不是第一次尝试。但原论文最了不起的地方，在于把这些点同时串联起来，形成一个合理的解释，令人拍案叫绝的同时又觉得无法反驳，反而有种“本该如此”的感觉。

## 实验分析 [\#](https://kexue.fm/kexue.fm\#%E5%AE%9E%E9%AA%8C%E5%88%86%E6%9E%90)

当然，虽然看上去很合理，但到目前为止它顶多算是猜测，接下来就是通过实验来验证它。JiT里边的实验很多，但笔者认为最值得关注的是下面三个。

首先，我们现在有三个可选的预测目标，分别是噪声、速度、数据，然后它们又可以细分为模型的预测目标和损失函数的回归目标，所以一共有9种组合。以ReFlow为例，设$\\boldsymbol{x}\_0$是噪声，$\\boldsymbol{x}\_1$是数据，它的训练目标是
\\begin{equation}\\mathbb{E}\_{\\boldsymbol{x}\_0\\sim p\_0(\\boldsymbol{x}\_0),\\boldsymbol{x}\_1\\sim p\_1(\\boldsymbol{x}\_1)}\\bigg\[\\bigg\\Vert \\boldsymbol{v}\_{\\boldsymbol{\\theta}}\\big(\\underbrace{(\\boldsymbol{x}\_1 - \\boldsymbol{x}\_0)t + \\boldsymbol{x}\_0}\_{\\boldsymbol{x}\_t}, t\\big) - (\\boldsymbol{x}\_1 - \\boldsymbol{x}\_0)\\bigg\\Vert^2\\bigg\]\\end{equation}
其中$\\boldsymbol{v}=\\boldsymbol{x}\_1 - \\boldsymbol{x}\_0$即速度，所以这是一个回归目标为速度的损失（$\\boldsymbol{v}\\text{-loss}$），如果我们用一个神经网络去建模$\\boldsymbol{v}\_{\\boldsymbol{\\theta}}(\\boldsymbol{x}\_t, t)$，那么模型的预测目标也是速度（$\\boldsymbol{v}\\text{-pred}$），如果我们根据$\\boldsymbol{x}\_1 - \\boldsymbol{x}\_0=\\frac{\\boldsymbol{x}\_1 - \\boldsymbol{x}\_t}{1-t}$，将$\\boldsymbol{v}\_{\\boldsymbol{\\theta}}(\\boldsymbol{x}\_t, t)$参数化为$\\frac{\\text{NN}\_{\\boldsymbol{\\theta}}(\\boldsymbol{x}\_t, t) - \\boldsymbol{x}\_t}{1-t}$，那么$\\text{NN}$的预测目标就是数据$\\boldsymbol{x}\_1$（$\\boldsymbol{x}\\text{-pred}$）。

这9种组合在有/无低秩瓶颈的ViT模型上的效果分别如下图左：

有/无低秩瓶颈时x/ε/v-pred/loss的效果差别

增加适当的低秩瓶颈，反而有利于FID

可以看到，如果没有低秩瓶颈（b），那么9种组合差别不大，但如果模型存在低秩瓶颈（a），则只有预测目标是数据（$\\boldsymbol{x}\\text{-pred}$）才能成功训练，至于回归目标的影响则比较次要，这就肯定了预测数据的必要性。还有，论文发现主动给$\\boldsymbol{x}\\text{-pred}$的JiT增加适当的低秩瓶颈，反而有利于FID，如上图右。

进一步地，下表验证了通过预测数据，确实可以在相近的计算量和参数量下，得到相近FID的不同分辨率模型：

不同分辨率、相近的计算量和参数量，也可以得到相近的FiD指标

最后，笔者也自己对比了一番，在CelebA HQ上用大Patch Size的ViT模型分别做$\\boldsymbol{x}\\text{-pred}$和$\\boldsymbol{v}\\text{-pred}$的效果对比如下（训得比较糙，对比看就行）：

预测原图的生成效果

预测速度的生成效果

## 延伸思考 [\#](https://kexue.fm/kexue.fm\#%E5%BB%B6%E4%BC%B8%E6%80%9D%E8%80%83)

更多的实验结果大家自行看原论文了，这一节我们来讨论一下，JiT给扩散模型带来了什么变化。

首先，它并没有刷新SOTA。从论文中的实验表格可以看出，就生成ImageNet图像这个任务而言，它没有带来新的SOTA，但跟最优结果的差距也不大，因此可以认为它的效果也是SOTA级别的，但总之没有明显超越它。另一方面，我们将已经是SOTA的非$\\boldsymbol{x}\\text{-pred}$模型改为$\\boldsymbol{x}\\text{-pred}$，大概率也不会得到显著更优的结果。

不过，它也许能够降低SOTA的成本。让模型预测数据，缓解了低秩瓶颈等问题的影响，使得我们可以重新审视那些曾因效果不佳而被弃用的轻量设计，或者以较低的额外训练成本，将低分辨率的SOTA模型“升级”成高分辨率模型。从这个角度看，JiT真正解决的问题是从低分辨率到高分辨率的可迁移性。

此外，JiT使得视觉理解和生成的架构更为统一。事实上，JiT基本就是视觉理解所用的ViT模型，跟文本LLM的GPT架构也大同小异，架构的统一更利于我们设计理解与生成于一体的多模态模型。相比之下，此前扩散模型的标准架构是 [U-Net](https://papers.cool/arxiv/1505.04597)，它包含多级上下采样和多条跨尺度直通连接，结构相对复杂。

从这个角度看，JiT可谓是准确找到了U-Net中最关键的一条直通连接。还是ReFlow的例子，如果我们按照建模$\\boldsymbol{v}\_{\\boldsymbol{\\theta}}(\\boldsymbol{x}\_t, t)$来理解，那么JiT中有$\\boldsymbol{v}\_{\\boldsymbol{\\theta}}(\\boldsymbol{x}\_t, t)=\\frac{\\text{NN}\_{\\boldsymbol{\\theta}}(\\boldsymbol{x}\_t, t) - \\boldsymbol{x}\_t}{1-t}$，额外的$-\\boldsymbol{x}\_t$正是从输入到输出的一条直通连接。U-Net则是不去管哪个连接关不关健，它直接给每个上/下采样的Block都加上这样一条直通连接。

最后，插个“题外话”。由JiT笔者还想到了 [DDCM](https://kexue.fm/archives/10711)，它需要预采样一个“$T \\times \\text{img\_size}$”的巨大矩阵作为Codebook，笔者曾尝试用有限个随机向量的线性组合来模拟它，但以失败告终，这个经历让笔者深刻体会到独立同分布噪声是撑满整个空间的、不可压缩的。所以，当看到JiT提出“数据处于低维流形、预测数据比预测噪声更容易”观点时，笔者几乎瞬间就理解并接受了它。

## 文章小结 [\#](https://kexue.fm/kexue.fm\#%E6%96%87%E7%AB%A0%E5%B0%8F%E7%BB%93)

本文简单介绍了JiT，它基于原始数据往往处于低维子流形这一事实，提出模型应优先选择预测数据而不是噪声/速度，这样能降低扩散模型的建模难度，减少模型崩溃等负面结果的可能性。

_**转载到请包括本文地址：** [https://kexue.fm/archives/11428](https://kexue.fm/archives/11428)_

_**更详细的转载事宜请参考：**_ [《科学空间FAQ》](https://kexue.fm/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8)

**如果您还有什么疑惑或建议，欢迎在下方评论区继续讨论。**

**如果您觉得本文还不错，欢迎 [分享](https://kexue.fm/kexue.fm#share)/ [打赏](https://kexue.fm/kexue.fm#pay) 本文。打赏并非要从中获得收益，而是希望知道科学空间获得了多少读者的真心关注。当然，如果你无视它，也不会影响你的阅读。再次表示欢迎和感谢！**

打赏

微信打赏

支付宝打赏

因为网站后台对打赏并无记录，因此欢迎在打赏时候备注留言。你还可以 [**点击这里**](http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=tN7d1drY3drrx8H0xcWa19vZ) 或在下方评论区留言来告知你的建议或需求。

**如果您需要引用本文，请参考：**

苏剑林. (Nov. 24, 2025). 《生成扩散模型漫谈（三十一）：预测数据而非噪声 》\[Blog post\]. Retrieved from [https://kexue.fm/archives/11428](https://kexue.fm/archives/11428)

@online{kexuefm-11428,
        title={生成扩散模型漫谈（三十一）：预测数据而非噪声},
        author={苏剑林},
        year={2025},
        month={Nov},
        url={\\url{https://kexue.fm/archives/11428}},
}

分类： [信息时代](https://kexue.fm/category/Big-Data)    标签： [损失函数](https://kexue.fm/tag/%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0/), [生成模型](https://kexue.fm/tag/%E7%94%9F%E6%88%90%E6%A8%A1%E5%9E%8B/), [扩散](https://kexue.fm/tag/%E6%89%A9%E6%95%A3/), [流形](https://kexue.fm/tag/%E6%B5%81%E5%BD%A2/)[11 评论](https://kexue.fm/archives/11428#comments)

< [Muon优化器指南：快速上手与关键细节](https://kexue.fm/archives/11416) \| >

### 你也许还对下面的内容感兴趣

- [DiVeQ：一种非常简洁的VQ训练方案](https://kexue.fm/archives/11328)
- [为什么线性注意力要加Short Conv？](https://kexue.fm/archives/11320)
- [Transformer升级之路：21、MLA好在哪里?（下）](https://kexue.fm/archives/11111)
- [线性注意力简史：从模仿、创新到反哺](https://kexue.fm/archives/11033)
- [生成扩散模型漫谈（三十）：从瞬时速度到平均速度](https://kexue.fm/archives/10958)
- [Transformer升级之路：20、MLA好在哪里?（上）](https://kexue.fm/archives/10907)
- [MoE环游记：3、换个思路来分配](https://kexue.fm/archives/10757)
- [MoE环游记：2、不患寡而患不均](https://kexue.fm/archives/10735)
- [生成扩散模型漫谈（二十九）：用DDPM来离散编码](https://kexue.fm/archives/10711)
- [细水长flow之TARFLOW：流模型满血归来？](https://kexue.fm/archives/10667)

[发表你的看法](https://kexue.fm/kexue.fm#comment_form)

keyerror

November 24th, 2025

大佬，感谢您的讲解。我一直对图像任务有一些困惑。很多文章都有做出比如图像是一个低维流行的假设。然后我知道LDM大概就是基于这一点所提出来的。
但我的一个困惑在于，如果我们对图像施加轻微的噪声，那对人眼来没区别，但是由于增加了噪声，之前低维流形的假设就被破坏了。考虑所有噪声的组合（只施加一次噪声，不考虑多次施加噪声），图像实际上就是覆盖高维空间的。（类似于多个高维球的并集这种感觉）。
所以，在计算机视觉的领域内，究竟什么是一个“纯粹的图像”？
比如Flow Matching和DDPM的推导里，都有假设它们的重点分布是某个以原图$x\_0$为中心的高斯分布（方差很小，所以比较集中），但这一假设就直接破坏了低维流形的性质。但如果不引入这个假设的话，那么原图的分布是多个$\\delta$分布的和，而非某个绝对连续的分布。这就破坏了最优传输里Brenier定理的核心前提，所以我个人觉得Flow Matching的直线插值的理论基础就被破坏了。所以感觉很矛盾。
不知道您是如何思考这个问题的，想和大佬您探讨一下。

[回复评论](https://kexue.fm/archives/11428/comment-page-1?replyTo=28868#respond-post-11428)

[苏剑林](https://kexue.fm) 发表于
November 24th, 2025

这里维数实际上是指有效维数，我不大清楚这里怎么严格表达，但理解的话，我们可以类比一下矩阵的有效秩概念。

举个例子，假设$\\boldsymbol{x}$是一个$d$维的非零列向量，那么$\\boldsymbol{x}\\boldsymbol{x}^{\\top}$就是一个rank-1矩阵，这个很好理解，我们将它加上一个单位阵的$\\sigma$倍（$\\sigma > 0$），得到
$$\\boldsymbol{x}\\boldsymbol{x}^{\\top} + \\sigma \\boldsymbol{I}$$

容易证明，对于任意$\\sigma > 0$，这个新矩阵都是满秩矩阵；然而，假设$\\sigma$非常小，比如$\\sigma=10^{-100}$，那么$\\boldsymbol{x}\\boldsymbol{x}^{\\top} + \\sigma \\boldsymbol{I}$跟$\\boldsymbol{x}\\boldsymbol{x}^{\\top}$在实际使用中会有实质区别吗？显然没有。但从数学上，这两个确实又是满秩和rank-1的巨大区别。

这表明，线性代数的秩的概念，不是很好能度量我们关于线性无关数量的实际体验，所以就有了有效秩的概念，参考 [https://kexue.fm/archives/10847](https://kexue.fm/archives/10847) ，它跟线性代数的秩概念相似，但更不容易受到轻微扰动的影响。

回到维数和流形上，类似地，这里应该存在一个“有效维数”的概念，像你说的给输入加轻微噪声扰动的操作，它不会明显改变有效维数。更具体点，比如MNIST图像是一个28\*28=784维的向量，但你可以用PCA降到很低维，即便加上轻微的噪声扰动，这个降维还是成立的，但如果噪声太大的话就不行了。

不过，即便是矩阵的有效秩概念，也没有一个标准定义，所以有效维数估计也没有～

[回复评论](https://kexue.fm/archives/11428/comment-page-1?replyTo=28903#respond-post-11428)

keyerror 发表于
November 24th, 2025

谢谢苏神～，这个思路对我很有启发。

[回复评论](https://kexue.fm/archives/11428/comment-page-1?replyTo=28905#respond-post-11428)

[Zhancun](http://muzhancun.github.io) 发表于
November 27th, 2025

也可以从natural image space的角度去理解。对于一张256x256x3的图片，理论上的图片张数有$3^{256 \\times 256}$，但实际上人们观测到的图片数约等于 人类存在的时间x人口数量 （可以估算出来是一个非常小的值）。

这个估算虽然看起来非常vanilla，但启发了CV领域许多非常早期的研究。例如人们发现，natural image具有特殊的性质，比如Power Law, Kurtosis and Sparsity，进而开始将natural image和物理里的一些统计模型做类比，例如Ising model, markov random field。研究表明，自然图像能够被热力学和统计物理的系综理论所刻画（可能也就是jianlin说的有效rank），i.e.
What features and statistics are characteristic of a texture pattern, so that texture pairs that share the
same features and statistics cannot be told apart by pre-attentive human visual perception?
我觉得这也是从Filters，Energy-based models到Conv的一个直接演进。

如果感兴趣的话可以看Computer Vision: Statistical Models for Marr’s Paradigm，属于比较有科学范的AI研究了。

[回复评论](https://kexue.fm/archives/11428/comment-page-1?replyTo=28924#respond-post-11428)

vnlee

November 24th, 2025

苏神似乎在讨论局部本征维度估计？
https://proceedings.mlr.press/v162/tempczyk22a/tempczyk22a.pdf

[回复评论](https://kexue.fm/archives/11428/comment-page-1?replyTo=28904#respond-post-11428)

[苏剑林](https://kexue.fm) 发表于
November 26th, 2025

嗯，应该有很多相关工作，直接对协方差矩阵矩阵做SVD其实也可以估算，不过这就只适合线性流形了。

[回复评论](https://kexue.fm/archives/11428/comment-page-1?replyTo=28914#respond-post-11428)

vnlee 发表于
November 26th, 2025

谢谢苏神回复。不过我感觉目前一般图像任务的数据集的样本数量似乎支撑不了连续的流形（尤其是被标准化过后的数据，被re-scale到高斯球面上后），有点难以利用流形的曲率和拓扑特性。

[回复评论](https://kexue.fm/archives/11428/comment-page-1?replyTo=28918#respond-post-11428)

Xintian Wu

November 26th, 2025

苏老师您好，我有个疑惑，在进行高分辨率图像训练时，如文中提到的512x512，进行patchify时为什么一定要按照32x32，而不能按照原先的8x8？理论上按照8x8应该就不会存在低秩问题了吧。当然按照8x8应该会增加不少计算量，但如果机器能够hold得住的情况下是否应该先按照8x8方式而非一定要强行增大patch\_size？

[回复评论](https://kexue.fm/archives/11428/comment-page-1?replyTo=28913#respond-post-11428)

[苏剑林](https://kexue.fm) 发表于
November 26th, 2025

好问题。这里边有很多值得思考的地方。

首先，如果patch size不变，那么序列长度就变成了原来的16倍，计算量也增加到了16倍，如果是Attention的话，最大可能要去到16x16=256倍。那么一张512x512的图，信息量是128x128的多少倍呢？值得我们我们付出16倍甚至256倍的计算量吗？

这个问题的答案不是固定的。如果是任意的512x512图片 vs 任意的128x128图片，那么平均信息量可能真的有16倍以上；然而，目前我们的评测任务，都是同一数据集下不同分辨率的图，小图实际上是大图缩小而来，这种情况下，512x512的图不见得有128x128图的16倍信息量。

当然，这里还得看我们关注什么，如果关注局部细节（比如你关心头发丝的生成效果），那么结论肯定不一样。如果我们只关心评测指标FID或IS，那么几乎可以肯定它没有16倍信息量，因为它们具有放大不变性。所以，为了得到相同的FID/IS指标，付出16倍甚至更多倍的计算，是非常不科学的事情。

[回复评论](https://kexue.fm/archives/11428/comment-page-1?replyTo=28920#respond-post-11428)

Xintian Wu 发表于
November 27th, 2025

感谢苏老师的解答！

[回复评论](https://kexue.fm/archives/11428/comment-page-1?replyTo=28922#respond-post-11428)

Xiaozhi Zhu

November 28th, 2025

我觉得这个work摆脱了two stages，真正做到E2E，让feature extraction/embedding 和 flow matching 之间可以传递gradient，不用被VAE锁死上限，这个很了不起。虽然现在没有beat SOTA，但是这个框架未来很有潜力。感谢你的分享！

[回复评论](https://kexue.fm/archives/11428/comment-page-1?replyTo=28930#respond-post-11428)

[取消回复](https://kexue.fm/archives/11428#respond-post-11428)

你的大名

电子邮箱

个人网站（选填）

1\. 可以使用LaTeX代码，点击“预览效果”可查看效果；2. 可以通过点击评论楼层编号来引用该楼层；3. 网站可能会有点卡，如非确认评论失败，请 **不要重复点击提交**。

### 内容速览

[信噪之比](https://kexue.fm/kexue.fm#%E4%BF%A1%E5%99%AA%E4%B9%8B%E6%AF%94)
[模型瓶颈](https://kexue.fm/kexue.fm#%E6%A8%A1%E5%9E%8B%E7%93%B6%E9%A2%88)
[低维流形](https://kexue.fm/kexue.fm#%E4%BD%8E%E7%BB%B4%E6%B5%81%E5%BD%A2)
[实验分析](https://kexue.fm/kexue.fm#%E5%AE%9E%E9%AA%8C%E5%88%86%E6%9E%90)
[延伸思考](https://kexue.fm/kexue.fm#%E5%BB%B6%E4%BC%B8%E6%80%9D%E8%80%83)
[文章小结](https://kexue.fm/kexue.fm#%E6%96%87%E7%AB%A0%E5%B0%8F%E7%BB%93)

### 智能搜索

支持整句搜索！网站自动使用 [结巴分词](https://github.com/fxsjy/jieba) 进行分词，并结合ngrams排序算法给出合理的搜索结果。

### 热门标签

[生成模型](https://kexue.fm/tag/%E7%94%9F%E6%88%90%E6%A8%A1%E5%9E%8B/) [attention](https://kexue.fm/tag/attention/) [优化](https://kexue.fm/tag/%E4%BC%98%E5%8C%96/) [语言模型](https://kexue.fm/tag/%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B/) [模型](https://kexue.fm/tag/%E6%A8%A1%E5%9E%8B/) [网站](https://kexue.fm/tag/%E7%BD%91%E7%AB%99/) [概率](https://kexue.fm/tag/%E6%A6%82%E7%8E%87/) [梯度](https://kexue.fm/tag/%E6%A2%AF%E5%BA%A6/) [矩阵](https://kexue.fm/tag/%E7%9F%A9%E9%98%B5/) [转载](https://kexue.fm/tag/%E8%BD%AC%E8%BD%BD/) [优化器](https://kexue.fm/tag/%E4%BC%98%E5%8C%96%E5%99%A8/) [微分方程](https://kexue.fm/tag/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/) [分析](https://kexue.fm/tag/%E5%88%86%E6%9E%90/) [天象](https://kexue.fm/tag/%E5%A4%A9%E8%B1%A1/) [深度学习](https://kexue.fm/tag/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/) [积分](https://kexue.fm/tag/%E7%A7%AF%E5%88%86/) [python](https://kexue.fm/tag/python/) [扩散](https://kexue.fm/tag/%E6%89%A9%E6%95%A3/) [力学](https://kexue.fm/tag/%E5%8A%9B%E5%AD%A6/) [无监督](https://kexue.fm/tag/%E6%97%A0%E7%9B%91%E7%9D%A3/) [几何](https://kexue.fm/tag/%E5%87%A0%E4%BD%95/) [节日](https://kexue.fm/tag/%E8%8A%82%E6%97%A5/) [生活](https://kexue.fm/tag/%E7%94%9F%E6%B4%BB/) [文本生成](https://kexue.fm/tag/%E6%96%87%E6%9C%AC%E7%94%9F%E6%88%90/) [数论](https://kexue.fm/tag/%E6%95%B0%E8%AE%BA/)

### 随机文章

- [生成扩散模型漫谈（三十一）：预测数据而非噪声](https://kexue.fm/archives/11428)
- [今日七夕笑牵牛](https://kexue.fm/archives/882)
- [Decoder-only的LLM为什么需要位置编码？](https://kexue.fm/archives/10347)
- [生成扩散模型漫谈（十二）：“硬刚”扩散ODE](https://kexue.fm/archives/9280)
- [相对位置编码Transformer的一个理论缺陷与对策](https://kexue.fm/archives/9105)
- [修改了一下公式的显示方式（移动端）](https://kexue.fm/archives/3576)
- [也来盘点一些最近的非Transformer工作](https://kexue.fm/archives/8431)
- [【NASA每日一图】黎明天空中的奋进号太空梭](https://kexue.fm/archives/486)
- [“让Keras更酷一些！”：中间变量、权重滑动和安全生成器](https://kexue.fm/archives/6575)
- [用时间换取效果：Keras梯度累积优化器](https://kexue.fm/archives/6794)

### 最近评论

- [夺宇](https://kexue.fm/archives/9152/comment-page-3#comment-28932): 苏老师的解释和推导好自然啊，比原论文更容易看懂
- [夺宇](https://kexue.fm/archives/9119/comment-page-13#comment-28931): 苏老师，(17)式中的噪声项可以直接在(8)式中直接添加吗？(8)式中添加一个噪声项似乎对后续...
- [Xiaozhi Zhu](https://kexue.fm/archives/11428/comment-page-1#comment-28930): 我觉得这个work摆脱了two stages，真正做到E2E，让feature extract...
- [wednesday](https://kexue.fm/archives/3319/comment-page-1#comment-28929): 想问问苏老师的数据挖掘学习思路或者学习路径是怎样的
- [wednesday](https://kexue.fm/archives/5239/comment-page-3#comment-28928): 因为我们只对p(Y\|X)建模，因此$p\_{\\theta}(X)$我们认为就是$\\tilde{p...
- [ykwen](https://kexue.fm/archives/10592/comment-page-3#comment-28927): 不动点迭代的时候 有没有可能迭代到0附近呢？
- [wednesday](https://kexue.fm/archives/5253/comment-page-18#comment-28926): 这是针对评论区一位同学问题的提问，现在已经懂了
- [wednesday](https://kexue.fm/archives/5253/comment-page-18#comment-28925): 针对一个样本和针对一个batch有什么特别的区别吗
- [Zhancun](https://kexue.fm/archives/11428/comment-page-1#comment-28924): 也可以从natural image space的角度去理解。对于一张256x256x3的图片，...
- [Plkcs5](https://kexue.fm/archives/9497/comment-page-2#comment-28923): 你好，可以学习一下您的工作吗，想知道是否有论文或开源代码可以学习一下。

### 友情链接

- [Cool Papers](https://papers.cool)
- [数学研发](https://bbs.emath.ac.cn)
- [Seatop](http://www.seatop.com.cn/)
- [Xiaoxia](https://xiaoxia.org/)
- [积分表-网络版](https://kexue.fm/sci/integral/index.html)
- [丝路博傲](http://blog.dvxj.com/)
- [数学之家](http://www.2math.cn/)
- [有趣天文奇观](http://interesting-sky.china-vo.org/)
- [TwistedW](http://www.twistedwg.com/)
- [godweiyang](https://godweiyang.com/)
- [AI柠檬](https://blog.ailemon.net/)
- [王登科-DK博客](https://greatdk.com)
- [ESON](https://blog.eson.org/)
- [枫之羽](https://fzhiy.net/)
- [Mathor's blog](https://wmathor.com/)
- [coding-zuo](https://coding-zuo.github.io/)
- [博科园](https://www.bokeyuan.net/)
- [孔皮皮的博客](https://www.kppkkp.top/)
- [运鹏的博客](https://yunpengtai.top/)
- [jiming.site](https://jiming.site/)
- [OmegaXYZ](https://www.omegaxyz.com/)
- [EAI猩球](https://www.robotech.ink/)
- [文举的博客](https://liwenju0.com/)
- [申请链接](https://kexue.fm/links.html)

本站采用创作共用版权协议，要求署名、非商业用途和保持一致。转载本站内容必须也遵循“ [署名-非商业用途-保持一致](http://creativecommons.org/licenses/by-nc-nd/2.5/cn/)”的创作共用协议。
© 2009-2025 Scientific Spaces. All rights reserved. Theme by [laogui](http://www.laogui.com). Powered by [Typecho](http://typecho.org). 备案号: [粤ICP备09093259号-1/2](https://beian.miit.gov.cn/)。