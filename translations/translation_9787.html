
    <style type="text/css">

    body {
    margin: 48px auto;
    max-width: 68ch;              /* character-based width reads better */
    padding: 0 16px;

    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                Roboto, "Helvetica Neue", Arial, sans-serif;
    font-size: 18px;
    line-height: 1.65;
    color: #333;
    background: #fafafa;
    }

    h1, h2, h3, h4 {
    line-height: 1.25;
    margin-top: 2.2em;
    margin-bottom: 0.6em;
    font-weight: 600;
    }

    h1 {
    font-size: 2.1em;
    margin-top: 0;
    }

    h2 {
    font-size: 1.6em;
    border-bottom: 1px solid #e5e5e5;
    padding-bottom: 0.3em;
    }

    h3 {
    font-size: 1.25em;
    }

    h4 {
    font-size: 1.05em;
    color: #555;
    }

    /* Paragraphs and lists */
    p {
    margin: 1em 0;
    }

    ul, ol {
    margin: 1em 0 1em 1.5em;
    }

    li {
    margin: 0.4em 0;
    }

    a {
    color: #005fcc;
    text-decoration: none;
    }

    a:hover {
    text-decoration: underline;
    }

    code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.95em;
    background: #f2f2f2;
    padding: 0.15em 0.35em;
    border-radius: 4px;
    }

    pre {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.9em;
    background: #f5f5f5;
    padding: 1em 1.2em;
    overflow-x: auto;
    border-radius: 6px;
    line-height: 1.45;
    }

    pre code {
    background: none;
    padding: 0;
    }

    blockquote {
    margin: 1.5em 0;
    padding-left: 1em;
    border-left: 4px solid #ddd;
    color: #555;
    }

    hr {
    border: none;
    border-top: 1px solid #e0e0e0;
    margin: 3em 0;
    }

    table {
    border-collapse: collapse;
    margin: 1.5em 0;
    width: 100%;
    font-size: 0.95em;
    }

    th, td {
    padding: 0.5em 0.7em;
    border-bottom: 1px solid #e5e5e5;
    text-align: left;
    }

    th {
    font-weight: 600;
    }

    img {
    max-width: 100%;
    display: block;
    margin: 1.5em auto;
    }

    small {
    color: #666;
    }

    mjx-container {
    margin: 1em 0;
    }

    ::selection {
    background: #cce2ff;
    }

    </style>
    

<script>
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']],
      tags: 'ams',
      packages: {'[+]': ['ams']}
    },
    options: {
      renderActions: {
        findScript: [10, function (doc) {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/);
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
            const text = document.createTextNode('');
            node.parentNode.replaceChild(text, node);
            math.start = {node: text, delim: '', n: 0};
            math.end = {node: text, delim: '', n: 0};
            doc.math.push(math);
          }
        }, '']
      }
    }
  };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<article>
    <nav style="margin-bottom: 1.5em;">
    <a href="../index.html" style="display: inline-flex; align-items: center; color: #555; text-decoration: none; font-size: 0.95em;">
        <span style="margin-right: 0.3em;">&larr;</span> Back to Index
    </a>
</nav>

    <h1><a href="https://kexue.fm/archives/9787">With a Little Pre-training, Transformer's Long-Sequence Performance Can Still Rise Significantly!</a></h1>
    <p>By 苏剑林 | October 8, 2023</p>

    <p>As the mainstream model architecture for LLMs, Transformers perform excellently across all types of tasks. In most cases, the criticism of Transformers is focused on their quadratic complexity rather than their effectiveness—except for a benchmark called Long Range Arena (hereafter referred to as LRA). For a long time, LRA has been the "home court" for linear RNN-based models; compared to them, Transformers have shown a clear performance gap, leading some to question whether this is an inherent flaw of the architecture.</p>

    <p>However, the recent paper <a href="https://papers.cool/arxiv/2310.02980">"Never Train from Scratch: Fair Comparison of Long-Sequence Models Requires Data-Driven Priors"</a> has finally supplied the "missing link." The paper points out that a lack of pre-training is the primary reason why Transformers perform poorly on LRA, and while all architectures can benefit from pre-training, the improvements for Transformers are significantly more pronounced.</p>

    <h2>Old Background</h2>
    <p>Long Range Arena (LRA) is a benchmark for long-sequence modeling, introduced in the paper <a href="https://papers.cool/arxiv/2011.04006">"Long Range Arena: A Benchmark for Efficient Transformers."</a> As seen from the title, LRA was built to test various efficient versions of Transformers. It contains multiple types of data with sequence lengths ranging from 1k to 16k. Previously, many works on Efficient Transformers have been tested on LRA. Although there is some controversy regarding its representativeness, LRA remains a classic benchmark for testing the long-sequence capabilities of Efficient Transformers.</p>

    <p style="text-align: center;">LRA results in the MEGA paper</p>

    <p>What might surprise some readers is that standard Transformers (XFM) do not perform well on this benchmark, falling significantly behind a series of linear RNN-based models, such as the classic SSMs (<a href="https://papers.cool/arxiv/2111.00396">S4</a>, <a href="https://papers.cool/arxiv/2203.14343">S4D</a>, <a href="https://papers.cool/arxiv/2208.04933">S5</a>) or <a href="translation_9554.html">LRU</a> which we introduced previously. Even the former SOTA model, <a href="https://papers.cool/arxiv/2209.10655">MEGA</a>, required equipping <a href="translation_8934.html">GAU</a> with a linear RNN module (referred to as EMA in the paper). In short, the previous LRA rankings strongly signaled that "Attention is good, but RNN is essential."</p>

    <p><strong>(Note: The full LRA rankings can be checked at <a href="https://paperswithcode.com/sota/long-range-modeling-on-lra">https://paperswithcode.com/sota/long-range-modeling-on-lra</a>.)</strong></p>

    <h2>New Conclusion</h2>
    <p>Clearly, the appearance of <a href="https://papers.cool/arxiv/2310.02980">"Never Train from Scratch: Fair Comparison of Long-Sequence Models Requires Data-Driven Priors"</a> has broken this impression. It points out that pre-training using the training set can greatly narrow the gap between the two, and further proposes the view that "it is unfair without pre-training."</p>

    <p style="text-align: center;">The improvement of "Transformer + Pre-training" compared to Transformer and various Efficient versions</p>

    <p>The pre-training approach is very simple: the task selection can be MLM or GPT, and the dataset is still the original training set. In this way, apart from increasing the consumption of computing power, no additional sources of knowledge are introduced, so the comparison is fair. In fact, both Transformers and RNNs can obtain significant improvements after pre-training, but the improvement for Transformers is more obvious:</p>

    <p style="text-align: center;">"Transformer + Pre-training" vs "S4 + Pre-training"</p>

    <p style="text-align: center;">Comparison with SOTA models</p>

    <p>In hindsight, the paper's conclusion is not surprising and even feels somewhat "obviously true," but previously everyone seemed not to think in this direction (or thought about it but didn't consider it critical?). Therefore, the fact that the authors were the first to realize and prove the importance of pre-training in LRA is still very much worth commending.</p>

    <p>The importance of pre-training actually indicates the importance of Inductive Bias on LRA. Because LRA utilizes very fine token granularity to make the sequences sufficiently long (for example, text tasks use characters as tokens, and image tasks use pixels as tokens and directly flatten 2D images into 1D sequences), it is clear that these tasks require both long-range dependencies and exhibit significant locality. Linear RNNs happen to fit these characteristics very well. In contrast, Transformers have relatively less obvious Inductive Bias; they require additional positional encoding to have position information, and even then, they don't have significant locality. Therefore, they need more pre-training to adapt to the data characteristics, or rather, to supplement Inductive Bias through pre-training.</p>

    <h2>The End</h2>
    <p>In this post, I have quickly shared a relatively new experimental conclusion: pre-training can effectively improve the scores of various models on LRA. Especially after Transformers are pre-trained, their results can basically approach the SOTA echelon. This breaks the impression I have held for a long time that LRA must be supplemented with linear RNNs.</p>

    <p><strong>If you still have any doubts or suggestions, you are welcome to continue the discussion in the comments section below.</strong></p>

    <p><strong>If you think this article is good, you are welcome to share or tip this article. Tipping is not about making a profit, but rather hoping to know how much sincere attention Scientific Spaces has received from its readers. Of course, if you ignore it, it will not affect your reading. Welcome and thank you again!</strong></p>

    <p>苏剑林. (Oct. 08, 2023). 《预训练一下，Transformer的长序列成绩还能涨不少！ 》[Blog post]. Retrieved from <a href="https://kexue.fm/archives/9787">https://kexue.fm/archives/9787</a></p>

    </article>
<hr>
<footer style="margin-top: 3em; padding: 1.5em; background: #f5f5f5; border-radius: 8px; font-size: 0.9em; color: #555;">
    <p style="margin: 0 0 0.5em 0;"><strong>Citation</strong></p>
    <p style="margin: 0 0 0.5em 0;">
        This is a machine translation of the original Chinese article:<br>
        <a href="https://kexue.fm/archives/9787" style="color: #005fcc;">https://kexue.fm/archives/9787</a>
    </p>
    <p style="margin: 0 0 0.5em 0;">
        Original author: 苏剑林 (Su Jianlin)<br>
        Original publication: <a href="https://kexue.fm" style="color: #005fcc;">科学空间 (Scientific Spaces)</a>
    </p>
    <p style="margin: 0; font-style: italic;">
        Translated using Gemini 3 Flash. Please refer to the original for authoritative content.
    </p>
</footer>
