
    <style type="text/css">

    body {
    margin: 48px auto;
    max-width: 68ch;              /* character-based width reads better */
    padding: 0 16px;

    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                Roboto, "Helvetica Neue", Arial, sans-serif;
    font-size: 18px;
    line-height: 1.65;
    color: #333;
    background: #fafafa;
    }

    h1, h2, h3, h4 {
    line-height: 1.25;
    margin-top: 2.2em;
    margin-bottom: 0.6em;
    font-weight: 600;
    }

    h1 {
    font-size: 2.1em;
    margin-top: 0;
    }

    h2 {
    font-size: 1.6em;
    border-bottom: 1px solid #e5e5e5;
    padding-bottom: 0.3em;
    }

    h3 {
    font-size: 1.25em;
    }

    h4 {
    font-size: 1.05em;
    color: #555;
    }

    /* Paragraphs and lists */
    p {
    margin: 1em 0;
    }

    ul, ol {
    margin: 1em 0 1em 1.5em;
    }

    li {
    margin: 0.4em 0;
    }

    a {
    color: #005fcc;
    text-decoration: none;
    }

    a:hover {
    text-decoration: underline;
    }

    code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.95em;
    background: #f2f2f2;
    padding: 0.15em 0.35em;
    border-radius: 4px;
    }

    pre {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.9em;
    background: #f5f5f5;
    padding: 1em 1.2em;
    overflow-x: auto;
    border-radius: 6px;
    line-height: 1.45;
    }

    pre code {
    background: none;
    padding: 0;
    }

    blockquote {
    margin: 1.5em 0;
    padding-left: 1em;
    border-left: 4px solid #ddd;
    color: #555;
    }

    hr {
    border: none;
    border-top: 1px solid #e0e0e0;
    margin: 3em 0;
    }

    table {
    border-collapse: collapse;
    margin: 1.5em 0;
    width: 100%;
    font-size: 0.95em;
    }

    th, td {
    padding: 0.5em 0.7em;
    border-bottom: 1px solid #e5e5e5;
    text-align: left;
    }

    th {
    font-weight: 600;
    }

    img {
    max-width: 100%;
    display: block;
    margin: 1.5em auto;
    }

    small {
    color: #666;
    }

    mjx-container {
    margin: 1em 0;
    }

    ::selection {
    background: #cce2ff;
    }

    </style>
    

<script>
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']],
      tags: 'ams',
      packages: {'[+]': ['ams']}
    }
  };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

<article>
    <nav style="margin-bottom: 1.5em;">
    <a href="../index.html" style="display: inline-flex; align-items: center; color: #555; text-decoration: none; font-size: 0.95em;">
        <span style="margin-right: 0.3em;">&larr;</span> Back to Index
    </a>
</nav>

    <h1><a href="https://kexue.fm/archives/7076">The Angle Distribution of Two Random Vectors in $n$-dimensional Space</a></h1>
    <p>By 苏剑林 | Nov 13, 2019</p>

    <p>Yesterday, there was a discussion in the group about some counter-intuitive phenomena regarding $n$-dimensional vectors. One topic was that "generally, in $n$-dimensional space, two random vectors are almost always perpendicular," which markedly differs from our perception of 2D and 3D space. To understand this conclusion theoretically, we can consider the distribution of the angle $\theta$ between two random vectors and calculate its mean and variance.</p>

    <h3>Probability Density</h3>
    <p>First, let's derive the probability density function of $\theta$. In fact, there is no need for a lengthy derivation, as it is a direct consequence of $n$-dimensional hyperspherical coordinates. To find the distribution of the angle between two random vectors, it is clear that due to isotropy, we only need to consider unit vectors. Similarly, due to isotropy, we can fix one vector and let the other vary randomly. Without loss of generality, let the random vector be</p>

    \begin{equation}\boldsymbol{x}=(x_1,x_2,\dots,x_n)\end{equation}

    <p>and the fixed vector be</p>

    \begin{equation}\boldsymbol{y}=(1,0,\dots,0)\end{equation}

    <p>Transforming $\boldsymbol{x}$ into hyperspherical coordinates (knowledge about $n$-dimensional spheres can be found on <a href="https://en.wikipedia.org/wiki/N-sphere#Spherical_coordinates">Wikipedia</a>):</p>

    \begin{equation} 
    \left\{\begin{aligned} 
    x_{1}&amp;=\cos(\varphi_{1})\\ 
    x_{2}&amp;=\sin(\varphi_{1})\cos(\varphi_{2})\\ 
    x_{3}&amp;=\sin(\varphi_{1})\sin(\varphi_{2})\cos(\varphi_{3})\\ 
    &amp;\,\,\vdots \\ 
    x_{n-1}&amp;=\sin(\varphi_{1})\cdots \sin(\varphi_{n-2})\cos(\varphi_{n-1})\\ 
    x_{n}&amp;=\sin(\varphi_{1})\cdots \sin(\varphi_{n-2})\sin(\varphi_{n-1}) 
    \end{aligned}\right. 
    \end{equation}

    <p>where $\varphi_{n−1}\in [0, 2\pi)$ and the remaining $\varphi$ ranges are $[0, \pi]$. In this case, the angle between $\boldsymbol{x}$ and $\boldsymbol{y}$ is:</p>

    \begin{equation}\arccos \langle \boldsymbol{x},\boldsymbol{y}\rangle = \arccos \cos(\varphi_{1}) = \varphi_{1} 
    \end{equation}

    <p>In other words, the angle between the two is exactly $\varphi_1$. Then, the probability that the angle between $\boldsymbol{x}$ and $\boldsymbol{y}$ does not exceed $\theta$ is:</p>

    \begin{equation}P_n(\varphi_1\leq\theta) = \frac{\text{Integral on } n\text{-dimensional hypersphere surface where } \varphi_1 \text{ does not exceed } \theta}{\text{Total integral on } n\text{-dimensional hypersphere surface}} 
    \end{equation}

    <p>The volume element on the $n$-dimensional hypersphere surface is $\sin^{n-2}(\varphi_{1})\sin^{n-3}(\varphi_{2})\cdots \sin(\varphi_{n-2})\,d\varphi_{1}\,d\varphi_{2}\cdots d\varphi_{n-1}$ (available on Wikipedia), so</p>

    \begin{equation}\begin{aligned} 
    P_n(\varphi_1\leq\theta) =&amp; \frac{\int_0^{2\pi}\cdots\int_0^{\pi}\int_0^{\theta}\sin^{n-2}(\varphi_{1})\sin^{n-3}(\varphi_{2})\cdots \sin(\varphi_{n-2})\,d\varphi_{1}\,d\varphi_{2}\cdots d\varphi_{n-1}}{\int_0^{2\pi}\cdots\int_0^{\pi}\int_0^{\pi}\sin^{n-2}(\varphi_{1})\sin^{n-3}(\varphi_{2})\cdots \sin(\varphi_{n-2})\,d\varphi_{1}\,d\varphi_{2}\cdots d\varphi_{n-1}}\\ 
    =&amp;\frac{(n-1)\text{-dimensional unit hypersphere surface area}\times\int_0^{\theta}\sin^{n-2}\varphi_{1} d\varphi_1}{n\text{-dimensional unit hypersphere surface area}}\\ 
    =&amp;\frac{\Gamma\left(\frac{n}{2}\right)}{\Gamma\left(\frac{n-1}{2}\right)\sqrt{\pi}} \int_0^{\theta}\sin^{n-2}\varphi_1 d\varphi_1 
    \end{aligned} 
    \end{equation}

    <p>This shows that the probability density function (PDF) of $\theta$ is</p>

    \begin{equation} 
    p_n(\theta) = \frac{\Gamma\left(\frac{n}{2}\right)}{\Gamma\left(\frac{n-1}{2}\right)\sqrt{\pi}}\sin^{n-2} \theta 
    \label{eq:theta}\end{equation}

    <p>Sometimes we are interested in the distribution of $\eta=\cos\theta$. In this case, we need to perform a change of variables for the probability density:</p>

    \begin{equation}\begin{aligned} 
    p_n(\eta)=&amp;\frac{\Gamma\left(\frac{n}{2}\right)}{\Gamma\left(\frac{n-1}{2}\right)\sqrt{\pi}}\sin^{n-2} (\arccos\eta)\left|\frac{d\theta}{d\eta}\right|\\ 
    =&amp;\frac{\Gamma\left(\frac{n}{2}\right)}{\Gamma\left(\frac{n-1}{2}\right)\sqrt{\pi}}(1-\eta^2)^{(n-3)/2}\\ 
    \end{aligned}\label{eq:cos}\end{equation}

    <h3>Distribution Profiles</h3>
    <p>From $\eqref{eq:theta}$ and $\eqref{eq:cos}$, we can see that when $n=2$, the distribution of the angle $\theta$ is uniform, and when $n=3$, the distribution of the cosine of the angle $\cos\theta$ is uniform. These two results indicate that in the 2D and 3D spaces we can perceive, the distribution of angles is relatively uniform. But what happens when $n$ is large? For example, $n=20, 50$?</p>

    <p>From the form $p_n(\theta)\sim\sin^{n-2}\theta$, one can find that when $n\geq 3$, the maximum probability occurs at $\theta=\frac{\pi}{2}$ (i.e., 90 degrees). Additionally, $\sin^{n-2}\theta$ is symmetric about $\theta=\frac{\pi}{2}$, so its mean is also $\frac{\pi}{2}$. However, this is not sufficient to describe the distribution; we also need to consider the variance</p>

    \begin{equation} 
    Var_n(\theta) = \frac{\Gamma\left(\frac{n}{2}\right)}{\Gamma\left(\frac{n-1}{2}\right)\sqrt{\pi}}\int_0^{\pi}\left(\theta-\frac{\pi}{2}\right)^2\sin^{n-2} \theta d\theta\end{equation}

    <p>This integral has an analytical solution, but the form is quite cumbersome (if you are interested, you can calculate it yourself using Mathematica). Let's just look at some numerical results:</p>

    <table style="margin-left: auto; margin-right: auto; border-collapse: collapse; text-align: center;">
        <thead>
            <tr style="border-top: 1px solid black; border-bottom: 1px solid black;">
                <th style="padding: 5px 20px;">$n$</th>
                <th style="padding: 5px 20px;">Variance</th>
            </tr>
        </thead>
        <tbody>
            <tr><td>3</td><td>0.467401</td></tr>
            <tr><td>10</td><td>0.110661</td></tr>
            <tr><td>20</td><td>0.0525832</td></tr>
            <tr><td>50</td><td>0.0204053</td></tr>
            <tr><td>100</td><td>0.0101007</td></tr>
            <tr><td>200</td><td>0.00502508</td></tr>
            <tr style="border-bottom: 1px solid black;"><td>1000</td><td>0.001001</td></tr>
        </tbody>
    </table>

    <p>As can be seen, as $n$ increases, the variance becomes smaller and smaller. This means that in high-dimensional space, the angle between any two vectors is almost concentrated around $\frac{\pi}{2}$. In other words, in high-dimensional space, any two vectors are almost always perpendicular.</p>

    <p>Of course, this can also be seen from the plot:</p>
    <p style="text-align: center;">[Plot of $p(\theta)$]</p>

    <p>For readers who want an approximate analytical solution, consider using the Laplace method to approximate $p_n(\theta)$ with a Gaussian distribution: expanding $\ln \sin^{n-2}\theta$ at $\theta=\frac{\pi}{2}$:</p>

    \begin{equation}\ln \sin^{n-2}\theta=\frac{2-n}{2}\left(\theta - \frac{\pi}{2}\right)^2 + \mathcal{O}\left(\left(\theta - \frac{\pi}{2}\right)^4\right)\end{equation}

    <p>which gives</p>

    \begin{equation}\sin^{n-2}\theta\approx \exp\left[-\frac{n-2}{2}\left(\theta - \frac{\pi}{2}\right)^2\right]\end{equation}

    <p>From this approximate form, we can consider $\theta$ as approximately following a normal distribution with mean $\frac{\pi}{2}$ and variance $\frac{1}{n-2}$. That is, when $n$ is large, the variance is approximately $\frac{1}{n-2}$, which also shows that the larger $n$ is, the smaller the variance.</p>

    <h3>Summary</h3>
    <p>This article derives the distribution of angles in high-dimensional space as a memorandum and also as a reference for interested readers.</p>
</article>
<hr>
<footer style="margin-top: 3em; padding: 1.5em; background: #f5f5f5; border-radius: 8px; font-size: 0.9em; color: #555;">
    <p style="margin: 0 0 0.5em 0;"><strong>Citation</strong></p>
    <p style="margin: 0 0 0.5em 0;">
        This is a machine translation of the original Chinese article:<br>
        <a href="https://kexue.fm/archives/7076" style="color: #005fcc;">https://kexue.fm/archives/7076</a>
    </p>
    <p style="margin: 0 0 0.5em 0;">
        Original author: 苏剑林 (Su Jianlin)<br>
        Original publication: <a href="https://kexue.fm" style="color: #005fcc;">科学空间 (Scientific Spaces)</a>
    </p>
    <p style="margin: 0; font-style: italic;">
        Translated using Gemini 3 Flash. Please refer to the original for authoritative content.
    </p>
</footer>
