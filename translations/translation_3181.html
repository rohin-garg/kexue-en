
    <style type="text/css">

    body {
    margin: 48px auto;
    max-width: 68ch;              /* character-based width reads better */
    padding: 0 16px;

    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                Roboto, "Helvetica Neue", Arial, sans-serif;
    font-size: 18px;
    line-height: 1.65;
    color: #333;
    background: #fafafa;
    }

    h1, h2, h3, h4 {
    line-height: 1.25;
    margin-top: 2.2em;
    margin-bottom: 0.6em;
    font-weight: 600;
    }

    h1 {
    font-size: 2.1em;
    margin-top: 0;
    }

    h2 {
    font-size: 1.6em;
    border-bottom: 1px solid #e5e5e5;
    padding-bottom: 0.3em;
    }

    h3 {
    font-size: 1.25em;
    }

    h4 {
    font-size: 1.05em;
    color: #555;
    }

    /* Paragraphs and lists */
    p {
    margin: 1em 0;
    }

    ul, ol {
    margin: 1em 0 1em 1.5em;
    }

    li {
    margin: 0.4em 0;
    }

    a {
    color: #005fcc;
    text-decoration: none;
    }

    a:hover {
    text-decoration: underline;
    }

    code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.95em;
    background: #f2f2f2;
    padding: 0.15em 0.35em;
    border-radius: 4px;
    }

    pre {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.9em;
    background: #f5f5f5;
    padding: 1em 1.2em;
    overflow-x: auto;
    border-radius: 6px;
    line-height: 1.45;
    }

    pre code {
    background: none;
    padding: 0;
    }

    blockquote {
    margin: 1.5em 0;
    padding-left: 1em;
    border-left: 4px solid #ddd;
    color: #555;
    }

    hr {
    border: none;
    border-top: 1px solid #e0e0e0;
    margin: 3em 0;
    }

    table {
    border-collapse: collapse;
    margin: 1.5em 0;
    width: 100%;
    font-size: 0.95em;
    }

    th, td {
    padding: 0.5em 0.7em;
    border-bottom: 1px solid #e5e5e5;
    text-align: left;
    }

    th {
    font-weight: 600;
    }

    img {
    max-width: 100%;
    display: block;
    margin: 1.5em auto;
    }

    small {
    color: #666;
    }

    mjx-container {
    margin: 1em 0;
    }

    ::selection {
    background: #cce2ff;
    }

    </style>
    

<script>
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']],
      processEscapes: true,
      tags: 'ams',
      packages: {'[+]': ['ams']}
    },
    options: {
      ignoreHtmlClass: 'tex2jax_ignore',
      processHtmlClass: 'tex2jax_process'
    },
    loader: {load: ['[tex]/ams']}
  };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<article>
  <nav style="margin-bottom: 1.5em;">
    <a href="../index.html" style="display: inline-flex; align-items: center; color: #555; text-decoration: none; font-size: 0.95em;">
        <span style="margin-right: 0.3em;">&larr;</span> Back to Index
    </a>
</nav>

  <h1><a href="https://kexue.fm/archives/3181">Transforming Coordinates Using Variational Methods</a></h1>
  <p>By 苏剑林 | January 6, 2015</p>

  <h3>Coordinate Transformation for ODEs</h3>
  <p>Readers familiar with theoretical mechanics should be able to appreciate the role of variational methods in transforming coordinate systems. For example, if we want to transform the following equations for the planar two-body problem:</p>
  \[\left\{\begin{aligned}\frac{d^2 x}{dt^2}&=\frac{-\mu x}{(x^2+y^2)^{3/2}}\\ \frac{d^2 y}{dt^2}&=\frac{-\mu y}{(x^2+y^2)^{3/2}}\end{aligned}\right.\tag{1}\]
  <p>into polar coordinates, directly substituting the variables would be a very tedious calculation. However, we know that the equations above are simply the Euler-Lagrange equations resulting from the variation of the action:</p>
  \[S=\int \left[\frac{1}{2}\left(\dot{x}^2+\dot{y}^2\right)+\frac{\mu}{\sqrt{x^2+y^2}}\right]dt\tag{2}\]
  <p>Thus, we can directly perform the coordinate transformation on the action itself. Since the action generally only involves first-order derivatives, transforming the action is usually quite simple. For instance, it is easy to write the polar form of $(2)$ as:</p>
  \[S=\int \left[\frac{1}{2}\left(\dot{r}^2+r^2\dot{\theta}^2\right)+\frac{\mu}{r}\right]dt\tag{3}\]
  <p>By varying $(3)$, the resulting Lagrange equations are:</p>
  \[\left\{\begin{aligned}&\ddot{r}=r\dot{\theta}^2-\frac{\mu}{r^2}\\ &\frac{d}{dt}\left(r^2\dot{\theta}\right)=0\end{aligned}\right.\tag{4}\]
  <p>And just like that, the coordinate transformation is completed. If you want to try direct substitution into $(1)$ for a "brute force" calculation, please refer to <a href="translation_549.html">"Equations and the Universe": The Ins and Outs of the Two-Body Problem (I)</a>.</p>

  <h3>Coordinate Transformation for PDEs</h3>
  <p>The above addressed coordinate transformations in ODEs; now let's discuss PDEs. In courses on partial differential equations and vector analysis, a common exercise is transforming the Laplace operator into polar, spherical, or other orthogonal coordinate systems to accommodate different boundary conditions. In such cases, variation can also play a role. Taking the two-dimensional Laplace operator as an example, we consider the equation:</p>
  \[\Delta^2 u=\frac{\partial^2 u}{\partial x^2}+\frac{\partial^2 u}{\partial y^2}=F\tag{5}\]
  <p>where $F$ is a constant (What is the purpose of introducing $F$? I invite the reader to think about this). To consider the polar form of $(5)$, we only need to note that it is the result of the variation of the action:</p>
  \[S=\int \left[\frac{1}{2}\left(\left(\frac{\partial u}{\partial x}\right)^2+\left(\frac{\partial u}{\partial y}\right)^2\right)+F u\right] dxdy\tag{6}\]
  <p>We can transform the coordinates directly in $(6)$ and then take the variation. We can quickly write:</p>
  \[S=\int \left[\frac{1}{2}\left(\left(\frac{\partial u}{\partial r}\right)^2+\left(\frac{1}{r}\frac{\partial u}{\partial \theta}\right)^2\right)+F u\right] rd\theta dr\tag{7}\]
  <p>The result of the variation gives (don't miss the $r$ in front of $d\theta dr$):</p>
  \[\frac{\partial}{\partial r}\left(r\frac{\partial u}{\partial r}\right)+\frac{1}{r}\frac{\partial^2 u}{\partial \theta^2}=F r\tag{8}\]
  <p>Which is:</p>
  \[\frac{1}{r}\frac{\partial}{\partial r}\left(r\frac{\partial u}{\partial r}\right)+\frac{1}{r^2}\frac{\partial^2 u}{\partial \theta^2}=F\]
  <p>By comparing it with equation $(5)$, we obtain:</p>
  \[\frac{\partial^2 }{\partial x^2}+\frac{\partial^2 }{\partial y^2}=\frac{1}{r}\frac{\partial}{\partial r}\left(r\frac{\partial }{\partial r}\right)+\frac{1}{r^2}\frac{\partial^2 }{\partial \theta^2}\]
  <p>The computational cost should be slightly lower than directly substituting the coordinate transformation formulas for a "hard calculation."</p>

  <p><strong>The reader might point out: You cheated! The reason you calculated it so quickly is that you pre-calculated the Jacobian determinant for polar coordinates (multiple integral transformation), and the transformation of the "kinetic energy" terms wasn't that obvious either! If you included those calculations, the time might far exceed direct substitution.</strong></p>

  <p>Readers thinking this are indeed correct; if you first go calculate a Jacobian determinant, then simplify, then vary, the computational load is also quite large. However, what I am emphasizing here is: simple answers might have simple processes (if the answer itself is complex, no amount of skill will make it simple), and unfamiliar problems might be convertible into familiar ones. In the transformation of the Laplace operator, at least for me, the process of direct transformation is unfamiliar, whereas the Jacobian determinant for polar (including spherical) coordinates is familiar, and variational methods are also quite familiar. Therefore, I would rather use this variational trick—which seems roundabout—to derive the transformation of the Laplace operator.</p>

  <p>Furthermore, polar and spherical coordinates are orthogonal coordinate systems. For orthogonal coordinate systems, writing out the Jacobian determinant is not particularly difficult. For example, in polar coordinates, we only need to note that $r d\theta$ and $dr$ are the orthogonal differentials in the polar coordinate system to immediately write $dxdy = r d\theta dr$ and $\left(\frac{\partial u}{\partial x}\right)^2+\left(\frac{\partial u}{\partial y}\right)^2=\left(\frac{\partial u}{\partial r}\right)^2+\left(\frac{1}{r}\frac{\partial u}{\partial \theta}\right)^2$.</p>

  <h3>Another Example</h3>
  <p>Let's take another example, such as an orthogonal coordinate system $(\xi, \eta)$:</p>
  \[\left\{\begin{aligned}&x=\xi^2-\eta^2\\ &y=2\xi\eta\end{aligned}\right.\]
  <p>(Why are $(\xi, \eta)$ orthogonal? Here I have indeed cheated; this is expanded from $x+yi = (\xi+\eta i)^2$, and the real and imaginary parts of an analytic function are necessarily orthogonal.)<br>
  We can calculate:</p>
  \[ds^2=dx^2+dy^2=\left(\xi^2+\eta^2\right)\left(d\xi^2+d\eta^2\right)\]
  <p>Thus, the two orthogonal differentials are $\sqrt{\xi^2+\eta^2}d\xi$ and $\sqrt{\xi^2+\eta^2}d\eta$. Therefore, we can quickly write:</p>
  \[\begin{aligned}&dxdy=\sqrt{\xi^2+\eta^2}d\xi\cdot\sqrt{\xi^2+\eta^2}d\eta=\left(\xi^2+\eta^2\right)d\xi d\eta\\ &\left(\frac{\partial u}{\partial x}\right)^2+\left(\frac{\partial u}{\partial y}\right)^2=\left(\frac{1}{\sqrt{\xi^2+\eta^2}}\frac{\partial u}{\partial \xi}\right)^2+\left(\frac{1}{\sqrt{\xi^2+\eta^2}}\frac{\partial u}{\partial \eta}\right)^2\end{aligned}\]
  <p>Thus, the action transforms into:</p>
  \[S=\int \left[\frac{1}{2}\left(\left(\frac{\partial u}{\partial \xi}\right)^2+\left(\frac{\partial u}{\partial \eta}\right)^2\right)+F u \left(\xi^2+\eta^2\right) \right] d\xi d\eta\]
  <p>The result of the variation is:</p>
  \[\frac{\partial^2 u}{\partial \xi^2}+\frac{\partial^2 u}{\partial \eta^2}=F\cdot\left(\xi^2+\eta^2\right) \]
  <p>Consequently:</p>
  \[\frac{\partial^2 }{\partial x^2}+\frac{\partial^2 }{\partial y^2}=\frac{1}{\xi^2+\eta^2}\left(\frac{\partial^2 u}{\partial \xi^2}+\frac{\partial^2 u}{\partial \eta^2}\right)\]

  <h3>Spherical Coordinates Example</h3>
  <p>Now we come to the three-dimensional case. Here I will only discuss spherical coordinates:</p>
  \[\left\{\begin{aligned}&x=r\sin\theta\cos\phi\\ &y=r\sin\theta\sin\phi\\ &z=r\cos\theta\end{aligned}\right.\]
  <p>We can calculate:</p>
  \[\begin{aligned}ds^2&=\left[d\left(r\sin\theta\right)\right]^2+\left(r\sin\theta\right)^2 d\phi^2+\left[d\left(r\cos\theta\right)\right]^2\\ &=dr^2+r^2 d\theta^2 +\left(r\sin\theta\right)^2 d\phi^2\end{aligned}\]
  <p>where the first step applies the polar coordinate transformation formula once to the first two coordinates (treating the radius as $(r\sin\theta)$); overall, it's just using the polar transformation formula twice. Thus, we obtain the orthogonal differentials for the sphere as $dr, r d\theta, r\sin\theta d\phi$, which gives:</p>
  \[\begin{aligned}&dxdydz=r^2\sin\theta dr d\theta d\phi\\ &\left(\frac{\partial u}{\partial x}\right)^2+\left(\frac{\partial u}{\partial y}\right)^2+\left(\frac{\partial u}{\partial z}\right)^2=\left(\frac{\partial u}{\partial r}\right)^2+\left(\frac{1}{r}\frac{\partial u}{\partial \theta}\right)^2+\left(\frac{1}{r\sin\theta}\frac{\partial u}{\partial \phi}\right)^2\end{aligned}\]
  <p>The action is then:</p>
  \[S=\int {\left[\frac{1}{2}\left(\left(\frac{\partial u}{\partial r}\right)^2+\left(\frac{1}{r}\frac{\partial u}{\partial \theta}\right)^2+\left(\frac{1}{r\sin\theta}\frac{\partial u}{\partial \phi}\right)^2\right)+F u\right] r^2\sin\theta dr d\theta d\phi}\]
  <p>The result of the variation is:</p>
  \[\frac{\partial}{\partial r}\left(r^2\sin\theta\frac{\partial u}{\partial r}\right)+\frac{\partial}{\partial \theta}\left(\sin\theta\frac{\partial u}{\partial \theta}\right)^2+\frac{1}{\sin\theta}\frac{\partial^2 u}{\partial \phi^2}=F r^2\sin\theta\]
  <p>Finally, simplifying gives:</p>
  \[\Delta u=\frac{1}{r^2}\frac{\partial}{\partial r}\left(r^2\frac{\partial u}{\partial r}\right)+\frac{1}{r^2\sin\theta}\frac{\partial}{\partial \theta}\left(\sin\theta\frac{\partial u}{\partial \theta}\right)+\frac{1}{r^2\sin^2\theta}\frac{\partial^2 u}{\partial \phi^2}\]

  <p>Which method is actually simpler? I'll let the reader decide for themselves. ^_^</p>
</article>
<hr>
<footer style="margin-top: 3em; padding: 1.5em; background: #f5f5f5; border-radius: 8px; font-size: 0.9em; color: #555;">
    <p style="margin: 0 0 0.5em 0;"><strong>Citation</strong></p>
    <p style="margin: 0 0 0.5em 0;">
        This is a machine translation of the original Chinese article:<br>
        <a href="https://kexue.fm/archives/3181" style="color: #005fcc;">https://kexue.fm/archives/3181</a>
    </p>
    <p style="margin: 0 0 0.5em 0;">
        Original author: 苏剑林 (Su Jianlin)<br>
        Original publication: <a href="https://kexue.fm" style="color: #005fcc;">科学空间 (Scientific Spaces)</a>
    </p>
    <p style="margin: 0; font-style: italic;">
        Translated using Gemini 3 Flash. Please refer to the original for authoritative content.
    </p>
</footer>
