
    <style type="text/css">

    body {
    margin: 48px auto;
    max-width: 68ch;              /* character-based width reads better */
    padding: 0 16px;

    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                Roboto, "Helvetica Neue", Arial, sans-serif;
    font-size: 18px;
    line-height: 1.65;
    color: #333;
    background: #fafafa;
    }

    h1, h2, h3, h4 {
    line-height: 1.25;
    margin-top: 2.2em;
    margin-bottom: 0.6em;
    font-weight: 600;
    }

    h1 {
    font-size: 2.1em;
    margin-top: 0;
    }

    h2 {
    font-size: 1.6em;
    border-bottom: 1px solid #e5e5e5;
    padding-bottom: 0.3em;
    }

    h3 {
    font-size: 1.25em;
    }

    h4 {
    font-size: 1.05em;
    color: #555;
    }

    /* Paragraphs and lists */
    p {
    margin: 1em 0;
    }

    ul, ol {
    margin: 1em 0 1em 1.5em;
    }

    li {
    margin: 0.4em 0;
    }

    a {
    color: #005fcc;
    text-decoration: none;
    }

    a:hover {
    text-decoration: underline;
    }

    code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.95em;
    background: #f2f2f2;
    padding: 0.15em 0.35em;
    border-radius: 4px;
    }

    pre {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.9em;
    background: #f5f5f5;
    padding: 1em 1.2em;
    overflow-x: auto;
    border-radius: 6px;
    line-height: 1.45;
    }

    pre code {
    background: none;
    padding: 0;
    }

    blockquote {
    margin: 1.5em 0;
    padding-left: 1em;
    border-left: 4px solid #ddd;
    color: #555;
    }

    hr {
    border: none;
    border-top: 1px solid #e0e0e0;
    margin: 3em 0;
    }

    table {
    border-collapse: collapse;
    margin: 1.5em 0;
    width: 100%;
    font-size: 0.95em;
    }

    th, td {
    padding: 0.5em 0.7em;
    border-bottom: 1px solid #e5e5e5;
    text-align: left;
    }

    th {
    font-weight: 600;
    }

    img {
    max-width: 100%;
    display: block;
    margin: 1.5em auto;
    }

    small {
    color: #666;
    }

    mjx-container {
    margin: 1em 0;
    }

    ::selection {
    background: #cce2ff;
    }

    </style>
    

<script>
window.MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    tags: 'ams',
    packages: {'[+]': ['ams']}
  }
};
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<nav style="margin-bottom: 1.5em;">
    <a href="../index.html" style="display: inline-flex; align-items: center; color: #555; text-decoration: none; font-size: 0.95em;">
        <span style="margin-right: 0.3em;">&larr;</span> Back to Index
    </a>
</nav>

<h1><a href="https://kexue.fm/archives/9291">A Brief Trial on the "Cross" Combinatorial Counting Problem</a></h1>

    <p>By 苏剑林 | October 09, 2022</p>


<p>Yesterday, I saw a "cross" combinatorial counting problem in a WeChat public account article that is said to have a controversial answer: In a square, if two of the four sides are of color $i$ and the other two are of two different other colors, then the square is called "$i$-color dominant." Consider the following "cross" figure composed of 16 line segments and 5 squares. Each segment is colored with one of three colors: red, yellow, or blue, such that the dominant colors of the three squares in the horizontal and vertical directions are all different. How many different coloring methods are there?</p>

<p>
    <img src="https://kexue.fm/usr/uploads/2022/10/3745672223.png" alt="Schematic of the 'Cross'"><br>
    <em>Schematic of the "Cross"</em>
</p>

<p>The linked article provides two answers: 54,432 by Teacher Wu Kang and 27,216 by Teacher Wang Huixing. This post first confirms through programming that Teacher Wang Huixing's 27,216 is the correct answer, and then provides my own theoretical analysis process.</p>

<h2>Programming Verification</h2>

<p>For such combinatorial problems with a relatively small number of permutations, the simplest and most direct way to verify the correctness of the answer is, naturally, programming enumeration. The most straightforward programming method is to enumerate all possible coloring schemes for the 16 line segments and then judge them one by one to see if they meet the requirements. However, this scheme requires enumerating $3^{16} \approx 43 \text{ million}$ schemes, which is quite computationally intensive. Therefore, we can think of ways to reduce the computation.</p>

<p>First, we naturally label the five squares as "Top", "Bottom", "Left", "Right", and "Center," as shown below:</p>

<p>
    <img src="https://kexue.fm/usr/uploads/2022/10/1651586548.png" alt="Natural partitioning labels of the 'Cross'"><br>
    <em>Natural partitioning labels of the "Cross"</em>
</p>

<p>Obviously, among these five squares, the "Center" has the most special status. Therefore, whether in theoretical analysis or programming calculation, we use it as the starting point. For the sake of programming convenience, we map the three colors Red, Yellow, and Blue to the digits 0, 1, and 2, respectively. Thus, we can quickly enumerate all possible coloring schemes for the "Center" as follows:</p>

<pre><code>from itertools import product
centers = [s for s in product(*[range(3)] * 4) if len(set(s)) == 3]</code></pre>

<p>Then, for each coloring scheme of the "Center," we enumerate the corresponding "Top", "Bottom", "Left", and "Right" coloring schemes. The method is also simple: first identify the dominant color of the "Center" coloring, then let the dominant colors for "Top-Bottom" and "Left-Right" be chosen from the remaining two colors respectively. We multiply the number of coloring schemes for "Top", "Bottom", "Left", and "Right" together. Note that once the "Center" coloring scheme is given, when enumerating the "Top", "Bottom", "Left", and "Right" schemes, one of their sides is already fixed, so the number of enumerable schemes should be $3^3$ rather than $3^4$. The complete reference code is as follows:</p>

<pre><code>def master(s):
    """Identify the dominant color"""
    for i in range(3):
        if s.count(i) == 2:
            return i

N = 0
for c in centers:
    m = master(c) # Current dominant color
    M = [i for i in range(3) if i != m] # Remaining two colors
    for i in range(2): # Dominant colors for Top, Bottom
        for j in range(2): # Dominant colors for Left, Right
            top = [s for s in product([c[0]], *[range(3)] * 3) if len(set(s)) == 3 and master(s) == M[i]]
            bottom = [s for s in product([c[2]], *[range(3)] * 3) if len(set(s)) == 3 and master(s) == M[1 - i]]
            left = [s for s in product([c[1]], *[range(3)] * 3) if len(set(s)) == 3 and master(s) == M[j]]
            right = [s for s in product([c[3]], *[range(3)] * 3) if len(set(s)) == 3 and master(s) == M[1 - j]]
            N += len(top) * len(bottom) * len(left) * len(right)

print(u'Total number of coloring schemes is', N)</code></pre>

<p>Finally, the total number of coloring schemes is calculated to be 27,216.</p>

<h2>Theoretical Calculation</h2>

<p>From a theoretical perspective, the logic for calculating the final number of coloring schemes is the same as the experimental verification: center first, then the sides. However, the brute-force enumeration part of the code is replaced by permutations and combinations formulas.</p>

<p>First is the number of coloring schemes for the "Center." Looking at the combinations, there are three types: "0 0 1 2", "0 1 1 2", and "0 1 2 2". Taking "0 0 1 2" as an example, to insert a 1 into "0 0", there are 3 possible positions, and then to insert a 2, there are 4 possible positions. So each combination has $3 \times 4 = 12$ permutations. Therefore, the number of coloring schemes for the "Center" is $12 \times 3 = 36$.</p>

<p>Next, we divide the coloring schemes of the "Center" into the two types shown in the figure below: 1. The two edges of the dominant color are adjacent; 2. The two edges of the dominant color are opposite.</p>

<p>
    <img src="https://kexue.fm/usr/uploads/2022/10/1603525547.png" alt="Center Scheme 1: Adjacent dominant colors">
    <img src="https://kexue.fm/usr/uploads/2022/10/257321689.png" alt="Center Scheme 2: Opposite dominant colors"><br>
    <em>Top: Center Scheme 1 (Adjacent); Bottom: Center Scheme 2 (Opposite)</em>
</p>

<p>Clearly, the ratio of the two is 2:1. Thus, among the "Center" coloring schemes, there are 24 where the dominant color edges are adjacent and 12 where they are opposite. We discuss these two cases separately below.</p>

<p><strong>First, the dominant color edges are adjacent.</strong> Without loss of generality, let's consider the left figure above. At this time, the dominant color of the "Center" is "Red," so the dominant colors of "Top" and "Bottom" can only be "Yellow" or "Blue." Assume the dominant color of "Top" is chosen as "Yellow." Then there are only 3 coloring schemes for it, and accordingly, there are also only 3 coloring schemes for "Bottom." Thus, there are $3 \times 3 = 9$ coloring schemes for "Top-Bottom." If the dominant color of "Top" is "Blue," then there are also 3 coloring schemes for it, but the corresponding "Bottom" has 6 coloring schemes. Thus, there are $3 \times 6 = 18$ coloring schemes for "Top-Bottom." Adding the two cases together gives $9 + 18 = 27$ schemes. The analysis for "Left-Right" is the same, and "Top-Bottom" and "Left-Right" can be combined arbitrarily. Therefore, there are a total of $27 \times 27 = 729$ schemes. Note that this is for just one "Center" coloring scheme; hence, the total number of coloring schemes in this case is $729 \times 24 = 17,496$.</p>

<p><strong>Second, the dominant color edges are opposite.</strong> Without loss of generality, let's consider the right figure above. At this time, the dominant color of the "Center" is "Red," so the dominant colors of "Top" and "Bottom" can only be "Yellow" or "Blue." Assume the dominant color of "Top" is "Yellow," there are 3 coloring schemes for it, and "Bottom" also has 3 coloring schemes. Thus, "Top-Bottom" has $3 \times 3 = 9$ schemes. If the dominant color of "Top" is "Blue," it has 3 coloring schemes, and "Bottom" also has 3 coloring schemes. Thus, "Top-Bottom" has $3 \times 3 = 9$ schemes. Adding them up gives $9 + 9 = 18$ schemes.</p>

<p>However, in this case, the result for "Left-Right" is different from "Top-Bottom" and requires a separate analysis. Assume the dominant color of "Left" is "Yellow," it has 3 coloring schemes, and "Right" also has 3. Thus, "Left-Right" has $3 \times 3 = 9$ schemes. If the dominant color of "Left" is "Blue," it has 6 coloring schemes, and "Right" also has 6. Thus, "Left-Right" has $6 \times 6 = 36$ schemes. Adding them up gives $9 + 36 = 45$ schemes. Therefore, the total number of coloring schemes for "Top", "Bottom", "Left", "Right", and "Center" together is $18 \times 45 \times 12 = 9,720$.</p>

<p>Finally, adding the two cases together gives $17,496 + 9,720 = 27,216$.</p>

<h2>Article Summary</h2>

<p>It's been a long time since I've done math problems; this was purely to brush up on high school mathematics knowledge~</p>

<p>
    Reprinting please include this article address: <a href="https://kexue.fm/archives/9291">https://kexue.fm/archives/9291</a><br>
    </p>

<p>If you think this article is good, you are welcome to Share / Reward this article. The reward is not for profit, but to know how much sincere attention Scientific Space has received from readers. Of course, if you ignore it, it will not affect your reading. Welcome and thank you again!</p>

<hr>
<footer style="margin-top: 3em; padding: 1.5em; background: #f5f5f5; border-radius: 8px; font-size: 0.9em; color: #555;">
    <p style="margin: 0 0 0.5em 0;"><strong>Citation</strong></p>
    <p style="margin: 0 0 0.5em 0;">
        This is a machine translation of the original Chinese article:<br>
        <a href="https://kexue.fm/archives/9291" style="color: #005fcc;">https://kexue.fm/archives/9291</a>
    </p>
    <p style="margin: 0 0 0.5em 0;">
        Original author: 苏剑林 (Su Jianlin)<br>
        Original publication: <a href="https://kexue.fm" style="color: #005fcc;">科学空间 (Scientific Spaces)</a>
    </p>
    <p style="margin: 0; font-style: italic;">
        Translated using Gemini 3 Flash. Please refer to the original for authoritative content.
    </p>
</footer>
