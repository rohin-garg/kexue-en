
    <style type="text/css">

    body {
    margin: 48px auto;
    max-width: 68ch;              /* character-based width reads better */
    padding: 0 16px;

    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                Roboto, "Helvetica Neue", Arial, sans-serif;
    font-size: 18px;
    line-height: 1.65;
    color: #333;
    background: #fafafa;
    }

    h1, h2, h3, h4 {
    line-height: 1.25;
    margin-top: 2.2em;
    margin-bottom: 0.6em;
    font-weight: 600;
    }

    h1 {
    font-size: 2.1em;
    margin-top: 0;
    }

    h2 {
    font-size: 1.6em;
    border-bottom: 1px solid #e5e5e5;
    padding-bottom: 0.3em;
    }

    h3 {
    font-size: 1.25em;
    }

    h4 {
    font-size: 1.05em;
    color: #555;
    }

    /* Paragraphs and lists */
    p {
    margin: 1em 0;
    }

    ul, ol {
    margin: 1em 0 1em 1.5em;
    }

    li {
    margin: 0.4em 0;
    }

    a {
    color: #005fcc;
    text-decoration: none;
    }

    a:hover {
    text-decoration: underline;
    }

    code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.95em;
    background: #f2f2f2;
    padding: 0.15em 0.35em;
    border-radius: 4px;
    }

    pre {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.9em;
    background: #f5f5f5;
    padding: 1em 1.2em;
    overflow-x: auto;
    border-radius: 6px;
    line-height: 1.45;
    }

    pre code {
    background: none;
    padding: 0;
    }

    blockquote {
    margin: 1.5em 0;
    padding-left: 1em;
    border-left: 4px solid #ddd;
    color: #555;
    }

    hr {
    border: none;
    border-top: 1px solid #e0e0e0;
    margin: 3em 0;
    }

    table {
    border-collapse: collapse;
    margin: 1.5em 0;
    width: 100%;
    font-size: 0.95em;
    }

    th, td {
    padding: 0.5em 0.7em;
    border-bottom: 1px solid #e5e5e5;
    text-align: left;
    }

    th {
    font-weight: 600;
    }

    img {
    max-width: 100%;
    display: block;
    margin: 1.5em auto;
    }

    small {
    color: #666;
    }

    mjx-container {
    margin: 1em 0;
    }

    ::selection {
    background: #cce2ff;
    }

    </style>
    

<script>
window.MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    processEscapes: true,
    tags: 'ams'
  },
  options: {
    renderActions: {
      findScript: [10, function (doc) {
        for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
          const display = !!node.type.match(/; *mode=display/);
          const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
          const text = document.createTextNode('');
          node.parentNode.replaceChild(text, node);
          math.start = {node: text, delim: '', n: 0};
          math.end = {node: text, delim: '', n: 0};
          doc.math.push(math);
        }
      }, '']
    }
  }
};
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

<h1><a href="https://kexue.fm/archives/9593">Two Interesting Discoveries about Attention and Softmax: Robustness and Information Volume</a></h1>

<p>By 苏剑林 | April 25, 2023</p>

<p>In recent weeks, I have been constantly thinking about the properties of the attention mechanism. During this process, I have gained a deeper understanding of attention and Softmax. In this article, I will briefly share two of those points:</p>

<blockquote>
    1. Softmax attention can naturally resist certain noise perturbations;<br>
    2. Initialization problems can be intuitively understood from the perspective of information entropy.
</blockquote>

<h2>Robustness</h2>

<p>The attention mechanism based on Softmax normalization can be written as:</p>

\[o = \frac{\sum_{i=1}^n e^{s_i} v_i}{\sum_{i=1}^n e^{s_i}}\]

<p>One day, I suddenly thought of a question: What if independent and identically distributed (i.i.d.) noise is added to $s_i$? To this end, we consider:</p>

\[\tilde{o} = \frac{\sum_{i=1}^n e^{s_i + \epsilon_i} v_i}{\sum_{i=1}^n e^{s_i + \epsilon_i}}\]

<p>where $\epsilon_i$ is i.i.d. noise. However, after a simple analysis, I found the conclusion to be "not much of anything"—the attention mechanism naturally resists this type of noise, i.e., $\tilde{o} \approx o$.</p>

<p>To understand this point, one only needs to realize:</p>

\[\tilde{o} = \frac{\frac{1}{n} \sum_{i=1}^n e^{s_i + \epsilon_i} v_i}{\frac{1}{n} \sum_{i=1}^n e^{s_i + \epsilon_i}} = \frac{\mathbb{E}_i [e^{s_i + \epsilon_i} v_i]}{\mathbb{E}_i [e^{s_i + \epsilon_i}]} \approx \frac{\mathbb{E}_i [e^{s_i} v_i] \mathbb{E}[e^\epsilon]}{\mathbb{E}_i [e^{s_i}] \mathbb{E}[e^\epsilon]} = \frac{\mathbb{E}_i [e^{s_i} v_i]}{\mathbb{E}_i [e^{s_i}]} = o\]

<p>The approximate equality utilizes the fact that $\epsilon_i$ is independent of $s_i$ and $v_i$, so the expectation of the product equals the product of the expectations.</p>

<h2>Information Volume</h2>

<p>If we denote $p_i = e^{s_i} / \sum_{i=1}^n e^{s_i}$, then $p_i$ describes a discrete probability distribution, and we can calculate the information entropy:</p>

\[H = -\sum_{i=1}^n p_i \log p_i \in [0, \log n]\]

<p>In <a href="translation_3534.html">"'Entropy' is Unaffordable: From Entropy and the Principle of Maximum Entropy to Maximum Entropy Models (I)"</a>, we discussed that entropy is a measure of uncertainty and also a measure of information volume. How can we understand the connection between the two? Entropy is essentially a measure of uniformity; the more uniform, the more uncertain. Therefore, entropy is a measure of uncertainty. The lower bound of entropy is 0, so uncertainty also means it is the maximum amount of information we can obtain from "uncertainty" to "complete certainty."</p>

<p>We know that if $s_i$ is initialized to be very large, then $p_i$ will approach a one-hot distribution, which leading to a failure in training due to gradient vanishing (refer to <a href="translation_8620.html">"A Brief Talk on the Initialization, Parameterization, and Standardization of Transformer"</a>). I found that this can also be understood very intuitively from the perspective of information volume: model training itself is a process from uncertainty (random model) to certainty (trained model). The optimizer is responsible for "extracting" information from the random model, whereas the information volume of a one-hot distribution is 0. The optimizer has "no profit to gain" and might even have to "pay" into it, so naturally, it cannot be optimized well. Therefore, we should initialize the model to be as uniform as possible to ensure that the "extractable" information volume is maximized.</p>

<p>Of course, besides ensuring the upper bound of information volume is large enough, we must also ensure that the lower bound of information volume is small enough to ensure the "extractable" information volume is as large as possible. Previously, when introducing contrastive learning, some readers did not understand the significance of the temperature parameter. This can also be interpreted from information volume. Let:</p>

\[p_i = \frac{e^{(\cos \theta_i) / \tau}}{\sum_{i=1}^n e^{(\cos \theta_i) / \tau}}\]

<p>If $\tau=1$, then the upper bound of information entropy is $\log n$, but the lower bound is approximately $\log n - 0.4745$ (refer to the <a href="https://kexue.fm/archives/9593/comment-page-1#comment-28363">comment section</a>). The amount of information that can be obtained is too small, so we need to decrease $\tau$ to make the lower bound of information entropy approach 0, thereby increasing the amount of information that can be obtained.</p>

<h2>In Short</h2>

<p>I have just quickly written a simple blog post. It can be seen that the final conclusion is still— <a href="translation_9019.html">"I heard that Attention and Softmax are a better match~"</a>.</p>
<hr>
<footer style="margin-top: 3em; padding: 1.5em; background: #f5f5f5; border-radius: 8px; font-size: 0.9em; color: #555;">
    <p style="margin: 0 0 0.5em 0;"><strong>Citation</strong></p>
    <p style="margin: 0 0 0.5em 0;">
        This is a machine translation of the original Chinese article:<br>
        <a href="https://kexue.fm/archives/9593" style="color: #005fcc;">https://kexue.fm/archives/9593</a>
    </p>
    <p style="margin: 0 0 0.5em 0;">
        Original author: 苏剑林 (Su Jianlin)<br>
        Original publication: <a href="https://kexue.fm" style="color: #005fcc;">科学空间 (Scientific Spaces)</a>
    </p>
    <p style="margin: 0; font-style: italic;">
        Translated using Gemini 3 Flash. Please refer to the original for authoritative content.
    </p>
</footer>
