
    <style type="text/css">

    body {
    margin: 48px auto;
    max-width: 68ch;              /* character-based width reads better */
    padding: 0 16px;

    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                Roboto, "Helvetica Neue", Arial, sans-serif;
    font-size: 18px;
    line-height: 1.65;
    color: #333;
    background: #fafafa;
    }

    h1, h2, h3, h4 {
    line-height: 1.25;
    margin-top: 2.2em;
    margin-bottom: 0.6em;
    font-weight: 600;
    }

    h1 {
    font-size: 2.1em;
    margin-top: 0;
    }

    h2 {
    font-size: 1.6em;
    border-bottom: 1px solid #e5e5e5;
    padding-bottom: 0.3em;
    }

    h3 {
    font-size: 1.25em;
    }

    h4 {
    font-size: 1.05em;
    color: #555;
    }

    /* Paragraphs and lists */
    p {
    margin: 1em 0;
    }

    ul, ol {
    margin: 1em 0 1em 1.5em;
    }

    li {
    margin: 0.4em 0;
    }

    a {
    color: #005fcc;
    text-decoration: none;
    }

    a:hover {
    text-decoration: underline;
    }

    code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.95em;
    background: #f2f2f2;
    padding: 0.15em 0.35em;
    border-radius: 4px;
    }

    pre {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.9em;
    background: #f5f5f5;
    padding: 1em 1.2em;
    overflow-x: auto;
    border-radius: 6px;
    line-height: 1.45;
    }

    pre code {
    background: none;
    padding: 0;
    }

    blockquote {
    margin: 1.5em 0;
    padding-left: 1em;
    border-left: 4px solid #ddd;
    color: #555;
    }

    hr {
    border: none;
    border-top: 1px solid #e0e0e0;
    margin: 3em 0;
    }

    table {
    border-collapse: collapse;
    margin: 1.5em 0;
    width: 100%;
    font-size: 0.95em;
    }

    th, td {
    padding: 0.5em 0.7em;
    border-bottom: 1px solid #e5e5e5;
    text-align: left;
    }

    th {
    font-weight: 600;
    }

    img {
    max-width: 100%;
    display: block;
    margin: 1.5em auto;
    }

    small {
    color: #666;
    }

    mjx-container {
    margin: 1em 0;
    }

    ::selection {
    background: #cce2ff;
    }

    </style>
    

<script>
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']],
      tags: 'ams'
    }
  };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<article>
    <h1><a href="https://kexue.fm/archives/4491">Linux Pitfalls of Accidental Deletion and Simple Recovery Techniques</a></h1>

    <p>By 苏剑林 | July 16, 2017</p>

    <h2 id="Warning">Warning <a href="https://kexue.fm/archives/4491#Warning">#</a></h2>
    <p>The following content contains many high-risk actions. Please do not imitate them casually. Minors should watch under the supervision of their parents~ (^_^)</p>

    <h2 id="Suicidal">Suicidal <a href="https://kexue.fm/archives/4491#Suicidal">#</a></h2>
    <p>Linux systems (the following also applies to Mac OS) are famous for being open-source and free. However, sometimes they are a bit too open, and I have been burned by these extremely open characteristics several times (mostly due to poor usage habits). I have summarized and shared these experiences for everyone's entertainment.</p>
    <p>The most classic example is achieving "suicide" through the following command:</p>

<pre><code>sudo rm / -rf</code></pre>

    <p>This destroys your Linux system. Obviously, in Windows, this would be equivalent to formatting the system drive while inside the operating system, which is strictly forbidden.</p>
    <p>A similar command is <code>mv</code>. For example, the following command, while not quite as severe as <code>rm</code>, is enough to ruin your system:</p>

<pre><code>sudo mv /* /root</code></pre>

    <p>There are many such high-risk commands, such as <code>dd</code>. In Linux or Mac OS, using <code>dd</code> to burn images is very common, but you must be certain of the target drive identifier. Otherwise, you might regret it deeply. For example:</p>

<pre><code>sudo dd bs=4m if=xxx.img of=/dev/rdisk0</code></pre>

    <p>And then your system is gone—this is a personal experience of mine!! While burning an image for a Raspberry Pi, I accidentally wiped my MacBook's system and spent a long time reinstalling it over the network.</p>

    <h2 id="Accidental-Killing">Accidental Killing <a href="https://kexue.fm/archives/4491#Accidental-Killing">#</a></h2>
    <p>Of course, even though commands like <code>sudo rm / -rf</code> are dangerous, we aren't stupid, so we don't run them directly. Therefore, they are mostly for entertainment and don't lead to real danger. More serious consequences are often caused by accidents, and usually unexpected ones (especially for beginners).</p>
    <p>For example, the following command is very common:</p>

<pre><code>sudo mv a/* b</code></pre>

    <p>The intent is simple: move everything inside directory <code>a</code> in the current path to directory <code>b</code> in the current path. It looks safe and doesn't affect the system itself. However, what if your hand slips and you add an extra space?</p>

<pre><code>sudo mv a /* b</code></pre>

    <p>Sorry, all you can do is laugh it off. You can only hope you reacted quickly enough to press <code>Ctrl+C</code>. Otherwise, you're in for a lot of trouble. This will also move all your system files into the <code>b</code> directory, causing almost all commands to stop working (including <code>mv</code>). This is also a pit I fell into not long ago, wasting a lot of time as a result. By the way, the <code>rm</code> command carries the same risk.</p>

    <h2 id="Recovery">Recovery <a href="https://kexue.fm/archives/4491#Recovery">#</a></h2>
    <p>Now that we've finished the sad stories, let's talk about something heartening~</p>
    <p>If you accidentally delete system files, especially through a destructive deletion, I'm afraid I can't help much. However, if you only accidentally deleted a text file—say, a code script you just finished but forgot to back up (especially long code you spent ages writing, which makes you want to give up on life)—it is still possible to recover, and the recovery process isn't particularly complex.</p>
    <p>First, let's create a file:</p>

<pre><code>echo 'Physical cosmology is a branch of astrophysics that studies the large-scale structure of the universe and basic questions such as its formation and evolution. The object of study in cosmology is celestial motion and its first causes, which for a long period of human history was part of metaphysics. As a science, cosmology originated from the Copernican principle and Newtonian mechanics, which stated that celestial bodies and objects on Earth obey the same physical principles and explained the motion of celestial bodies. This branch is now known as celestial mechanics. It is generally believed that physical cosmology originated in the twentieth century with Einsteins general theory of relativity and astronomical observations of extremely distant celestial bodies.' > test.txt</code></pre>

    <p>Then delete it with <code>rm test.txt</code>. Next, execute:</p>

<pre><code>sudo grep -a -B 5 -A 10 'The object of study in cosmology is celestial motion and its first causes' /dev/sda5 > results.txt</code></pre>

    <p>Parameter explanation:</p>
    <blockquote>
        <p>1. <code>grep</code> is a text search based on regular expressions;<br>
        2. <code>-a</code> means <code>--binary-files=text</code>, treating binary files as text files;<br>
        3. The <code>-B</code> and <code>-A</code> options represent the number of lines before and after that string, respectively;<br>
        4. <code>'The object of study in cosmology is celestial motion and its first causes'</code> is some content from the original text file;<br>
        5. <code>/dev/sda5</code> is the hard disk device, which can be checked using the <code>df</code> command;<br>
        6. <code>> results.txt</code> outputs the results to the <code>results.txt</code> file.</p>
    </blockquote>

    <p>This command is quite time-consuming and might even report out-of-memory errors. Regardless, after the command finishes, we can look for the content we need in <code>results.txt</code>. If you are lucky, the deleted content will be in <code>results.txt</code>. If you modified <code>test.txt</code> multiple times, the original text fragments might appear repeatedly in <code>results.txt</code>. To locate the text content, you can use programming tools to read <code>results.txt</code> and search (because if the text snippet you provided is too common, <code>results.txt</code> might be huge, and a standard text editor won't be able to handle it). For example, I use Python:</p>

<pre><code>s = open('results.txt').read()
'The object of study in cosmology is celestial motion and its first causes' in s # Returns True, there is hope ^_^
idx = s.index('The object of study in cosmology is celestial motion and its first causes')

# Check if it is the content we just deleted
# If not, let s = s[idx+len('The object of study in cosmology is celestial motion and its first causes'):] and repeat the above
print s[idx-100:idx+100] # Gradually adjust the 100 parameter until the deleted content is found.</code></pre>

    <p>I didn't expect Linux to have this trick up its sleeve~ I only found it on Google after accidentally deleting a script a few days ago. Indeed, technical skills are accumulated through lessons of blood and tears.</p>

    <h2 id="Reference">Reference <a href="https://kexue.fm/archives/4491#Reference">#</a></h2>
    <p><a href="http://coolshell.cn/articles/2822.html">http://coolshell.cn/articles/2822.html</a></p>

    <p><em><strong>When reposting, please include the address of this article:</strong> <a href="https://kexue.fm/archives/4491" title="Linux Pitfalls of Accidental Deletion and Simple Recovery Techniques">https://kexue.fm/archives/4491</a></em></p>

    <p><em><strong>For more detailed reposting matters, please refer to:</strong></em> <a href="https://kexue.fm/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="Scientific Spaces FAQ">"Scientific Spaces FAQ"</a></p>

    <p>Su Jianlin. (Jul. 16, 2017). "Linux Pitfalls of Accidental Deletion and Simple Recovery Techniques" [Blog post]. Retrieved from <a href="https://kexue.fm/archives/4491">https://kexue.fm/archives/4491</a></p>

</article>
<hr>
<footer style="margin-top: 3em; padding: 1.5em; background: #f5f5f5; border-radius: 8px; font-size: 0.9em; color: #555;">
    <p style="margin: 0 0 0.5em 0;"><strong>Citation</strong></p>
    <p style="margin: 0 0 0.5em 0;">
        This is a machine translation of the original Chinese article:<br>
        <a href="https://kexue.fm/archives/4491" style="color: #005fcc;">https://kexue.fm/archives/4491</a>
    </p>
    <p style="margin: 0 0 0.5em 0;">
        Original author: 苏剑林 (Su Jianlin)<br>
        Original publication: <a href="https://kexue.fm" style="color: #005fcc;">科学空间 (Scientific Spaces)</a>
    </p>
    <p style="margin: 0; font-style: italic;">
        Translated using Gemini 3 Flash. Please refer to the original for authoritative content.
    </p>
</footer>
