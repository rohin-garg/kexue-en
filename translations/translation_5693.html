
    <style type="text/css">

    body {
    margin: 48px auto;
    max-width: 68ch;              /* character-based width reads better */
    padding: 0 16px;

    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                Roboto, "Helvetica Neue", Arial, sans-serif;
    font-size: 18px;
    line-height: 1.65;
    color: #333;
    background: #fafafa;
    }

    h1, h2, h3, h4 {
    line-height: 1.25;
    margin-top: 2.2em;
    margin-bottom: 0.6em;
    font-weight: 600;
    }

    h1 {
    font-size: 2.1em;
    margin-top: 0;
    }

    h2 {
    font-size: 1.6em;
    border-bottom: 1px solid #e5e5e5;
    padding-bottom: 0.3em;
    }

    h3 {
    font-size: 1.25em;
    }

    h4 {
    font-size: 1.05em;
    color: #555;
    }

    /* Paragraphs and lists */
    p {
    margin: 1em 0;
    }

    ul, ol {
    margin: 1em 0 1em 1.5em;
    }

    li {
    margin: 0.4em 0;
    }

    a {
    color: #005fcc;
    text-decoration: none;
    }

    a:hover {
    text-decoration: underline;
    }

    code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.95em;
    background: #f2f2f2;
    padding: 0.15em 0.35em;
    border-radius: 4px;
    }

    pre {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.9em;
    background: #f5f5f5;
    padding: 1em 1.2em;
    overflow-x: auto;
    border-radius: 6px;
    line-height: 1.45;
    }

    pre code {
    background: none;
    padding: 0;
    }

    blockquote {
    margin: 1.5em 0;
    padding-left: 1em;
    border-left: 4px solid #ddd;
    color: #555;
    }

    hr {
    border: none;
    border-top: 1px solid #e0e0e0;
    margin: 3em 0;
    }

    table {
    border-collapse: collapse;
    margin: 1.5em 0;
    width: 100%;
    font-size: 0.95em;
    }

    th, td {
    padding: 0.5em 0.7em;
    border-bottom: 1px solid #e5e5e5;
    text-align: left;
    }

    th {
    font-weight: 600;
    }

    img {
    max-width: 100%;
    display: block;
    margin: 1.5em auto;
    }

    small {
    color: #666;
    }

    mjx-container {
    margin: 1em 0;
    }

    ::selection {
    background: #cce2ff;
    }

    </style>
    

<script>
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']],
      tags: 'ams',
      packages: {'[+]': ['base', 'ams', 'noerrors', 'noundefined']}
    },
    loader: {load: ['[tex]/ams']}
  };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<article>
    <h1><a href="https://kexue.fm/archives/5693">From SamplePairing to mixup: Magical Regularization Terms</a></h1>
    
    <p>By 苏剑林 | July 07, 2018</p>

    <p>
        <a href="https://arxiv.org/pdf/1801.02929.pdf">SamplePairing</a> and <a href="https://arxiv.org/pdf/1710.09412.pdf">mixup</a> are two image data augmentation techniques that share the same origin. They appear quite unreasonable and are simple to operate, yet the results are very impressive: multiple image classification tasks have shown that they can improve the final accuracy of classification models.
    </p>

    <p>
        Some readers might be confused by a question: why can such "unreasonable" data augmentation methods achieve such good results? This article aims to show that while <strong>they look like data augmentation methods, they are actually regularization schemes for the model.</strong> As the classic line from Stephen Chow's movie <i>From Beijing with Love</i> goes:
    </p>

    <blockquote>
        On the surface, it looks like a hair dryer, but it is actually a razor.
    </blockquote>

    <h2>Data Augmentation</h2>

    <p>
        Let's start with data augmentation. Data augmentation refers to the fact that after we apply some simple transformations to original data, their corresponding categories often do not change. Therefore, we can "create" more data based on the original data. For example, for a photo of a dog, after operations like horizontal flipping, slight rotation, cropping, or translation, we still consider its category to be unchanged—it is still the same dog. In this way, several samples can be derived from one sample, thereby increasing the training sample size.
    </p>

    <p style="text-align:center;">
        <a href="https://kexue.fm/usr/uploads/2018/07/3306401335.jpg"><img src="https://kexue.fm/usr/uploads/2018/07/3306401335.jpg" alt="Dog" title="Dog"></a>
        <br>Dog
    </p>

    <p style="text-align:center;">
        <a href="https://kexue.fm/usr/uploads/2018/07/794764704.jpg"><img src="https://kexue.fm/usr/uploads/2018/07/794764704.jpg" alt="Rotated Dog" title="Rotated Dog"></a>
        <br>Rotated Dog
    </p>

    <p>
        Data augmentation originates from our prior knowledge—for instance, we know in advance that ordinary photos possess horizontal flip invariance, so we use horizontal flipping to augment data, thereby telling the model it should be invariant to horizontal flipping. Data augmentation is not absolutely universal; while ordinary photos have horizontal flip invariance, text images do not. This further illustrates that data augmentation is a scheme for integrating our prior knowledge into the model.
    </p>

    <h2>SamplePairing</h2>

    <p>
        Now let's talk about SamplePairing. SamplePairing was proposed as a data augmentation method, but it is very counter-intuitive:
    </p>

    <blockquote>
        If the label of sample $x_a$ is $y_a$, then randomly select a sample $x_b$ from the training set, and let the label of $(x_a + x_b)/2$ still be $y_a$.
    </blockquote>

    <p>
        Yes, you read that correctly, and I didn't write it wrong; it's just that simple and that counter-intuitive. On <a href="https://mp.weixin.qq.com/s?__biz=MzIwMTc4ODE0Mw==&mid=2247487055&idx=1&sn=c99dbce318a826bc7c92ae0a0870513f&chksm=96e9d1cfa19e58d980e4ecc957ab97045b2178925738b296fda56302831e96217e99bf9fb320&scene=21#wechat_redirect">paperweekly</a>, reader Chen Taihong once commented:
    </p>

    <blockquote>
        This is the simplest paper I have ever seen in the CNN field.
    </blockquote>

    <p>
        After seeing this scheme, readers might have a series of questions. These questions represent exactly why SamplePairing is counter-intuitive. For example, why is the label of $(x_a + x_b)/2$ $y_a$ instead of $y_b$? Also, according to our understanding of data augmentation, $(x_a + x_b)/2$ is no longer even a reasonable image—can such "augmentation" still be used?
    </p>

    <p style="display: flex; justify-content: center; gap: 10px;">
        <span><img src="https://kexue.fm/usr/uploads/2018/07/546550851.jpg" alt="Cat" style="width: 200px;"><br>Cat</span>
        <span><img src="https://kexue.fm/usr/uploads/2018/07/3306401335.jpg" alt="Dog" style="width: 200px;"><br>Dog</span>
        <span><img src="https://kexue.fm/usr/uploads/2018/07/1314816462.jpg" alt="Cat-Dog-Average" style="width: 200px;"><br>Cat-Dog Average</span>
    </p>

    <p>
        First, regarding the issue of asymmetry: note that when the current sample is $x_a$ and $x_b$ is randomly selected, we set the label of $(x_a + x_b)/2$ to $y_a$. Conversely, when it is $x_b$'s turn, $x_a$ might be randomly selected, and then the label of $(x_a + x_b)/2$ will be $y_b$. So, while it looks asymmetric, SamplePairing is actually symmetric. SamplePairing can be re-described as:
    </p>

    <blockquote>
        Randomly select two samples $x_a$ and $x_b$ with labels $y_a$ and $y_b$. Randomly pick one of these labels, say $y$, then let the label of $(x_a + x_b)/2$ be $y$.
    </blockquote>

    <h2>mixup</h2>

    <p>
        From the re-described version of SamplePairing, it's not hard to see that if training is sufficient, the model's output for $(x_a + x_b)/2$ theoretically should be half $y_a$ and half $y_b$. That is to say, if $y_a$ and $y_b$ represent the one-hot vectors of the categories, the output for $(x_a + x_b)/2$ would be $(y_a + y_b)/2$.
    </p>

    <p>
        In that case, why not mix them in a more random way? Suppose $U(\varepsilon)$ is a random distribution on $[0,1]$. For each iteration, we randomly sample $\varepsilon \sim U(\varepsilon)$, and then let the output corresponding to $\varepsilon x_a + (1-\varepsilon) x_b$ be $\varepsilon y_a + (1-\varepsilon) y_b$. In the original paper, $U(\varepsilon)$ is taken as a $\beta$ distribution, but I think that introduces more hyperparameters; it might be better to simply let it be a uniform distribution.
    </p>

    <p>
        Compared to SamplePairing, the approach of mixup is "softer" and more convincing. Because SamplePairing always feels like a "blunt cut," whereas mixup is relatively more intuitive: since the input is superimposed in the ratio $\varepsilon : 1-\varepsilon$, it is natural that the output should also be superimposed in the same way.
    </p>

    <h2>Regularization Interpretation</h2>

    <p>
        Although mixup feels more reasonable, both methods fail to answer a very important question: after two images are added, the result is no longer a reasonable "image." This is completely different from what we usually call data augmentation, so why is it still effective?
    </p>

    <p>
        Let's describe this problem mathematically. For a training set of pairs $(x_1, y_1), (x_2, y_2), \dots, (x_n, y_n)$, we want to find a model $f$ such that $y = f(x)$. For tasks like image classification, given the strong non-linearity of the problem itself, we generally use very deep networks to fit the data. However, a deeper network also means it is more prone to overfitting the training set.
    </p>

    <p>
        Suppose the model is already capable of predicting $y_a = f(x_a)$ and $y_b = f(x_b)$. For mixup, it says this is not enough; the model must also output $\varepsilon y_a + (1-\varepsilon) y_b$ for $\varepsilon x_a + (1-\varepsilon) x_b$:
    </p>

    \[\varepsilon y_a + (1-\varepsilon) y_b = f\big(\varepsilon x_a + (1-\varepsilon) x_b\big)\]

    <p>
        Substituting $y_a, y_b$ with $f(x_a), f(x_b)$, we get:
    </p>

    \[\varepsilon f(x_a) + (1-\varepsilon) f(x_b) = f\big(\varepsilon x_a + (1-\varepsilon) x_b\big)\]

    <p>
        This is actually a functional equation. If $\varepsilon, x_a, x_b$ are arbitrary, the solution to this functional equation is a "linear function." In other words, only a linear function can make the above equation hold identically. Put differently, mixup hopes the model $f$ is a linear function.
    </p>

    <p>
        We know that a linear function is equivalent to a single-layer neural network without an activation function—arguably the simplest model. Our actual model, however, is a deep network with a huge number of parameters and strong non-linear capabilities, and more parameters lead to easier overfitting. In this light, the meaning of mixup becomes very clear:
    </p>

    <blockquote>
        mixup acts as a regularization term. It encourages the model to stay as close as possible to a linear function. That is to say, it ensures the model makes predictions as accurately as possible while keeping the model as simple as possible.
    </blockquote>

    <p>
        Thus, mixup is a powerful model filter:
    </p>

    <blockquote>
        Among all models with similar performance, choose the one closest to a linear function.
    </blockquote>

    <h2>Epilogue</h2>

    <p>
        Now we have answered the original question: methods like SamplePairing and mixup only wear the mask of data augmentation. In reality, they use the form of data augmentation to add a regularization term to the model, or in other words, to prune the model.
    </p>

    <p>
        Therefore, we don't need to dwell on the problem of "how data augmentation can be effective when the added images are no longer reasonable images," because it isn't actually data augmentation.
    </p>

    <p>
        Finally, I'll conclude this article with a playful adaptation of a poem by Tang Bohu:
    </p>

    <blockquote>
        Others laugh at my wild augmentations,<br>
        I laugh at others for failing to see the truth.<br>
        No reasonable images are produced here,<br>
        Yet silently, the model is filtered through.
    </blockquote>
</article>
<hr>
<footer style="margin-top: 3em; padding: 1.5em; background: #f5f5f5; border-radius: 8px; font-size: 0.9em; color: #555;">
    <p style="margin: 0 0 0.5em 0;"><strong>Citation</strong></p>
    <p style="margin: 0 0 0.5em 0;">
        This is a machine translation of the original Chinese article:<br>
        <a href="https://kexue.fm/archives/5693" style="color: #005fcc;">https://kexue.fm/archives/5693</a>
    </p>
    <p style="margin: 0 0 0.5em 0;">
        Original author: 苏剑林 (Su Jianlin)<br>
        Original publication: <a href="https://kexue.fm" style="color: #005fcc;">科学空间 (Scientific Spaces)</a>
    </p>
    <p style="margin: 0; font-style: italic;">
        Translated using Gemini 3 Flash. Please refer to the original for authoritative content.
    </p>
</footer>
