
    <style type="text/css">

    body {
    margin: 48px auto;
    max-width: 68ch;              /* character-based width reads better */
    padding: 0 16px;

    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                Roboto, "Helvetica Neue", Arial, sans-serif;
    font-size: 18px;
    line-height: 1.65;
    color: #333;
    background: #fafafa;
    }

    h1, h2, h3, h4 {
    line-height: 1.25;
    margin-top: 2.2em;
    margin-bottom: 0.6em;
    font-weight: 600;
    }

    h1 {
    font-size: 2.1em;
    margin-top: 0;
    }

    h2 {
    font-size: 1.6em;
    border-bottom: 1px solid #e5e5e5;
    padding-bottom: 0.3em;
    }

    h3 {
    font-size: 1.25em;
    }

    h4 {
    font-size: 1.05em;
    color: #555;
    }

    /* Paragraphs and lists */
    p {
    margin: 1em 0;
    }

    ul, ol {
    margin: 1em 0 1em 1.5em;
    }

    li {
    margin: 0.4em 0;
    }

    a {
    color: #005fcc;
    text-decoration: none;
    }

    a:hover {
    text-decoration: underline;
    }

    code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.95em;
    background: #f2f2f2;
    padding: 0.15em 0.35em;
    border-radius: 4px;
    }

    pre {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.9em;
    background: #f5f5f5;
    padding: 1em 1.2em;
    overflow-x: auto;
    border-radius: 6px;
    line-height: 1.45;
    }

    pre code {
    background: none;
    padding: 0;
    }

    blockquote {
    margin: 1.5em 0;
    padding-left: 1em;
    border-left: 4px solid #ddd;
    color: #555;
    }

    hr {
    border: none;
    border-top: 1px solid #e0e0e0;
    margin: 3em 0;
    }

    table {
    border-collapse: collapse;
    margin: 1.5em 0;
    width: 100%;
    font-size: 0.95em;
    }

    th, td {
    padding: 0.5em 0.7em;
    border-bottom: 1px solid #e5e5e5;
    text-align: left;
    }

    th {
    font-weight: 600;
    }

    img {
    max-width: 100%;
    display: block;
    margin: 1.5em auto;
    }

    small {
    color: #666;
    }

    mjx-container {
    margin: 1em 0;
    }

    ::selection {
    background: #cce2ff;
    }

    </style>
    

<script>
window.MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    processEscapes: true,
    tags: 'ams'
  }
};
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

<article>
<h1><a href="https://kexue.fm/archives/9009">Why is Pre Norm Less Effective Than Post Norm?</a></h1>

<p>By 苏剑林 | March 29, 2022</p>

<p>The comparison between Pre Norm and Post Norm is a "long-standing" topic. This blog has discussed this issue multiple times, such as in the articles <a href="translation_8620.html">"A Brief Discussion on Initialization, Parameterization, and Standardization of Transformers"</a> and <a href="translation_8747.html">"Model Optimization Talk: Why is the Initial Standard Deviation of BERT 0.02?"</a>. Currently, the most established conclusion is that under the same settings, the Pre Norm structure is often easier to train, but its final performance is usually not as good as Post Norm. It is easy to understand why Pre Norm is easier to train because its identity path is more prominent, but why is its performance not as good?</p>

<p>I didn't have a good answer for this until recently when I saw a reply from <a href="https://www.zhihu.com/question/519668254/answer/2371885202">@Tang Xianghao</a> on Zhihu, which gave me a "sudden realization." It turns out there is a very intuitive understanding of this problem! Let's learn about it together in this article.</p>

<h2 id="basic-conclusion">Basic Conclusion</h2>

<p>The formulas for Pre Norm and Post Norm are as follows:</p>

\begin{align}
\text{Pre Norm: } \quad \boldsymbol{x}_{t+1} = \boldsymbol{x}_t + F_t(\text{Norm}(\boldsymbol{x}_t))\\
\text{Post Norm: }\quad \boldsymbol{x}_{t+1} = \text{Norm}(\boldsymbol{x}_t + F_t(\boldsymbol{x}_t))
\end{align}

<p>In a Transformer, here $\text{Norm}$ mainly refers to Layer Normalization, but in general models, it can also be Batch Normalization, Instance Normalization, etc. The relevant conclusions are essentially universal.</p>

<p>In the materials I have found, there are two papers showing that Post Norm is superior to Pre Norm: <a href="https://papers.cool/arxiv/2004.08249">"Understanding the Difficulty of Training Transformers"</a> and <a href="https://papers.cool/arxiv/2012.11747">"RealFormer: Transformer Likes Residual Attention"</a>. Additionally, I have conducted my own comparative experiments, which showed that the transfer performance of the Post Norm structure is better. That is to say, during Pre-training, both Pre Norm and Post Norm can achieve roughly the same results, but the Fine-tuning effect of Post Norm is significantly better.</p>

<p>Readers might ask, doesn't <a href="https://papers.cool/arxiv/2002.04745">"On Layer Normalization in the Transformer Architecture"</a> show that Pre Norm is better than Post Norm? Isn't this a contradiction? In fact, that article compared the performance of Pre Norm and Post Norm under identical training settings, which only shows that Pre Norm is easier to train. This is because Post Norm requires different training configurations (e.g., Pre Norm can omit Warmup, but Post Norm usually requires it) to reach its optimal performance. Therefore, the conclusions are not contradictory.</p>

<h2 id="intuitive-understanding">Intuitive Understanding</h2>

<p>Why is the performance of Pre Norm not as good as Post Norm? The answer given by <a href="https://www.zhihu.com/question/519668254/answer/2371885202">@Tang Xianghao</a> on Zhihu is: Pre Norm's depth is "diluted"! In other words, the actual equivalent depth of an $L$-layer Pre Norm model is not as deep as an $L$-layer Post Norm model, and having fewer layers leads to worse performance.</p>

<p>How do we understand this specifically? Quite simply, for a Pre Norm model, we iterate to obtain:</p>

\begin{equation}\begin{aligned}
\boldsymbol{x}_{t+1} =&\, \boldsymbol{x}_t + F_t(\text{Norm}(\boldsymbol{x}_t)) \\
=&\, \boldsymbol{x}_{t-1} + F_{t-1}(\text{Norm}(\boldsymbol{x}_{t-1})) + F_t(\text{Norm}(\boldsymbol{x}_t)) \\
=&\, \cdots \\
=&\, \boldsymbol{x}_0 + F_0 (\text{Norm}(\boldsymbol{x}_0)) + \cdots + F_{t-1}(\text{Norm}(\boldsymbol{x}_{t-1})) + F_t(\text{Norm}(\boldsymbol{x}_t))
\end{aligned}\end{equation}

<p>If each term is of the same magnitude, then we have $\boldsymbol{x}_{t+1}=\mathcal{O}(t+1)$. That is to say, the difference between layer $t+1$ and layer $t$ is equivalent to the difference between $t+1$ and $t$. When $t$ is large, the relative difference between the two is very small, therefore:</p>

\begin{equation}\begin{aligned}
&\,F_t(\text{Norm}(\boldsymbol{x}_t)) + F_{t+1}(\text{Norm}(\boldsymbol{x}_{t+1})) \\
\approx&\,F_t(\text{Norm}(\boldsymbol{x}_t)) + F_{t+1}(\text{Norm}(\boldsymbol{x}_t)) \\
=&\, \begin{pmatrix} 1 & 1\end{pmatrix}\begin{pmatrix} F_t \\ F_{t+1}\end{pmatrix}(\text{Norm}(\boldsymbol{x}_t))
\end{aligned}\end{equation}

<p>This means that when $t$ is large, $\boldsymbol{x}_t$ and $\boldsymbol{x}_{t+1}$ are very close, so $F_{t+1}(\text{Norm}(\boldsymbol{x}_{t+1}))$ and $F_{t+1}(\text{Norm}(\boldsymbol{x}_t))$ are or also very close. Thus, the sum of a $t$-layer model and $t+1$-layer model is approximately equivalent to an even wider $t$-layer model. Therefore, in Pre Norm, the result of stacking many layers is more about increasing width rather than depth. The more layers there are, the more "insubstantial" each layer becomes.</p>

<p>To put it simply, the Pre Norm structure invisibly increases the model's width while decreasing its depth. Since we know that depth is usually more important than width, it is this invisible reduction in depth that leads to the final performance drop. Post Norm is just the opposite; as we analyzed in <a href="translation_8620.html">"A Brief Discussion on Initialization, Parameterization, and Standardization of Transformers"</a>, every time it performs Norm, it weakens the weight of the identity branch. Thus, Post Norm emphasizes the residual branch more. Consequently, the layers in Post Norm are "full measure," and once trained well, the performance is superior.</p>

<h2 id="related-work">Related Work</h2>

<p>Many readers have likely heard of <a href="translation_8978.html">DeepNet</a>, which claims to be able to train 1000-layer Transformers. In its paper <a href="https://papers.cool/arxiv/2203.00555">"DeepNet: Scaling Transformers to 1,000 Layers"</a>, the description of Pre Norm is:</p>

<blockquote>However, the gradients of Pre-LN at bottom layers tend to be larger than at top layers, leading to a degradation in performance compared with Post-LN.</blockquote>

<p>Many readers might not have understood the logical relationship in this sentence at the time, but after reading the explanation in the previous section, you will likely have a new understanding.</p>

<p>In short, the statement "the gradients of Pre-LN at bottom layers tend to be larger than at top layers" means that the Pre Norm structure leans too heavily toward the identity branch (bottom layers), causing Pre Norm to degrade into a "shallow and wide" model, which eventually performs worse than a Post Norm model of the same depth. This is essentially consistent with the previous intuitive understanding.</p>

<h2 id="summary">Summary</h2>

<p>This article mainly shared an intuitive understanding of "why the performance of Pre Norm is not as good as Post Norm."</p>
</article>
<hr>
<footer style="margin-top: 3em; padding: 1.5em; background: #f5f5f5; border-radius: 8px; font-size: 0.9em; color: #555;">
    <p style="margin: 0 0 0.5em 0;"><strong>Citation</strong></p>
    <p style="margin: 0 0 0.5em 0;">
        This is a machine translation of the original Chinese article:<br>
        <a href="https://kexue.fm/archives/9009" style="color: #005fcc;">https://kexue.fm/archives/9009</a>
    </p>
    <p style="margin: 0 0 0.5em 0;">
        Original author: 苏剑林 (Su Jianlin)<br>
        Original publication: <a href="https://kexue.fm" style="color: #005fcc;">科学空间 (Scientific Spaces)</a>
    </p>
    <p style="margin: 0; font-style: italic;">
        Translated using Gemini 3 Flash. Please refer to the original for authoritative content.
    </p>
</footer>
