
    <style type="text/css">

    body {
    margin: 48px auto;
    max-width: 68ch;              /* character-based width reads better */
    padding: 0 16px;

    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                Roboto, "Helvetica Neue", Arial, sans-serif;
    font-size: 18px;
    line-height: 1.65;
    color: #333;
    background: #fafafa;
    }

    h1, h2, h3, h4 {
    line-height: 1.25;
    margin-top: 2.2em;
    margin-bottom: 0.6em;
    font-weight: 600;
    }

    h1 {
    font-size: 2.1em;
    margin-top: 0;
    }

    h2 {
    font-size: 1.6em;
    border-bottom: 1px solid #e5e5e5;
    padding-bottom: 0.3em;
    }

    h3 {
    font-size: 1.25em;
    }

    h4 {
    font-size: 1.05em;
    color: #555;
    }

    /* Paragraphs and lists */
    p {
    margin: 1em 0;
    }

    ul, ol {
    margin: 1em 0 1em 1.5em;
    }

    li {
    margin: 0.4em 0;
    }

    a {
    color: #005fcc;
    text-decoration: none;
    }

    a:hover {
    text-decoration: underline;
    }

    code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.95em;
    background: #f2f2f2;
    padding: 0.15em 0.35em;
    border-radius: 4px;
    }

    pre {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.9em;
    background: #f5f5f5;
    padding: 1em 1.2em;
    overflow-x: auto;
    border-radius: 6px;
    line-height: 1.45;
    }

    pre code {
    background: none;
    padding: 0;
    }

    blockquote {
    margin: 1.5em 0;
    padding-left: 1em;
    border-left: 4px solid #ddd;
    color: #555;
    }

    hr {
    border: none;
    border-top: 1px solid #e0e0e0;
    margin: 3em 0;
    }

    table {
    border-collapse: collapse;
    margin: 1.5em 0;
    width: 100%;
    font-size: 0.95em;
    }

    th, td {
    padding: 0.5em 0.7em;
    border-bottom: 1px solid #e5e5e5;
    text-align: left;
    }

    th {
    font-weight: 600;
    }

    img {
    max-width: 100%;
    display: block;
    margin: 1.5em auto;
    }

    small {
    color: #666;
    }

    mjx-container {
    margin: 1em 0;
    }

    ::selection {
    background: #cce2ff;
    }

    </style>
    

<script>
window.MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    processEscapes: true,
    tags: 'ams'
  }
};
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<article>
    <h1><a href="https://kexue.fm/archives/4521">[Memo] Talking about Dropout</a></h1>
    <p>By 苏剑林 | August 08, 2017</p>

    <p>In fact, this is just a memo...</p>
    <p>Dropout is an effective measure to prevent overfitting in deep learning. Of course, in terms of its underlying philosophy, dropout is not just limited to deep learning; it can also be used in traditional machine learning methods. It just appears more natural within the neural network framework of deep learning.</p>

    <h2>What does it do? <a name="做了什么" href="#%E5%81%9A%E4%BA%86%E4%BB%80%E4%B9%88">#</a></h2>
    <p>How does dropout operate? Generally speaking, for an input tensor $x$, dropout involves setting some elements to zero and then performing a scale transformation on the result. Specifically, taking Keras's <code>Dropout(0.6)(x)</code> as an example, it is essentially equivalent to what follows in numpy:</p>

<pre><code class="language-python"></code></pre>

    <p>That is to say, 60% of the elements are set to 0, and the remaining 40% of the elements are scaled up to $1/40\% = 2.5$ times their original value. It is worth noting that the 0.6 in Keras's <code>Dropout(0.6)(x)</code> represents the dropout rate (the proportion to discard), whereas in TensorFlow, the 0.6 in <code>tf.nn.dropout(x, 0.6)</code> represents the keep probability (the proportion to retain). You need to analyze the specific framework for its exact meaning (though if the dropout rate is 0.5, you don't really need to worry about it ^_^).</p>

    <h2>What is its use? <a name="有什么用" href="#%E6%9C%89%E4%BB%80%E4%B9%88%E7%94%A8">#</a></h2>
    <p>Generally, we understand dropout as a "low-cost ensemble strategy," which is correct. The specific process can be understood as follows.</p>
    <p>After the zeroing operation mentioned above, we can consider that the zeroed portion has been discarded, and some information has been lost. However, even though information is lost, life must go on—no, I mean, training must go on—so the model is forced to use the remaining information to fit the target. Since each dropout is random, the model cannot rely solely on certain nodes. Therefore, overall, the model is forced to learn using a small amount of features each time. Because the features being learned change every time, it means that every feature should contribute to the model's prediction (rather than favoring certain features, which leads to overfitting).</p>
    <p>Finally, during prediction, dropout is not applied. This is equivalent to averaging all local features (finally using all the information), and theoretically, the performance improves, and overfitting becomes less severe (because the risk is spread across every feature rather than just a subset of features).</p>

    <h2>More flexibility <a name="更灵活些" href="#%E6%9B%B4%E7%81%B5%E6%B4%BB%E4%BA%9B">#</a></h2>
    <p>Sometimes we want to apply constraints to the way dropout is performed. For example, within the same batch, I might want all samples to be dropped out in the same way, rather than the first sample dropping the first node and the second sample dropping the second node. Or, when using an LSTM for text classification, I might want to dropout by word vector—meaning either the entire word vector is dropped or the entire word vector is kept, rather than just dropping certain elements of a word vector. Another example: when using a CNN for RGB image classification, I might want to dropout by channel—dropping any one of the R, G, or B channels for each image (much like a color transformation or RGB perturbation), rather than just dropping specific pixels on the image (which is equivalent to adding noise to the image).</p>
    <p>To implement these requirements, one needs to use the <strong>noise_shape</strong> parameter in dropout. This parameter exists in both Keras's Dropout layer and <code>tf.nn.dropout</code> (I only use these two frameworks), and its meaning is the same in both. However, this parameter is rarely mentioned online, and even when it is, the explanation is often vague. Let's take <code>tf.nn.dropout(x, 0.5, noise_shape)</code> as an example. First, <code>noise_shape</code> is a 1D tensor—simply put, it's a 1D array (can be a list or tuple) whose length must be the same as <code>x.shape</code>. Furthermore, the elements in <code>noise_shape</code> can only be either 1 or the corresponding element in <code>x.shape</code>. For example, if <code>x.shape = (3, 4, 5)</code>, then there are only 8 allowed configurations for <code>noise_shape</code>:</p>
    <blockquote>(3,4,5), (1,4,5), (3,1,5), (3,4,1), (1,1,5), (1,4,1), (3,1,1), (1,1,1)</blockquote>
    <p>What is the meaning of each? It can be understood this way: <strong>Whichever axis is set to 1, that axis will be dropped out consistently.</strong> For example, <code>(3,4,5)</code> is normal dropout without any constraints. <code>(1,4,5)</code> means every sample in the batch will be dropped out in the same way (this can be understood as applying identical noise to every sample). If <code>(3,4,5)</code> represents (number of sentences, number of words per sentence, word vector dimension), then <code>(3,4,1)</code> means dropping out by word vector (which can be understood as randomly skipping certain words).</p>
    <p>For some readers, understanding this via numpy code might be more intuitive:</p>

<pre><code class="language-python"></code></pre>

    <p>
        <em><strong>When reposting, please include the address of this article:</strong> <a href="translation_4521.html">https://kexue.fm/archives/4521</a></em><br>
        <em><strong>For more detailed reposting matters, please refer to:</strong> <a href="https://kexue.fm/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8">"Scientific Spaces FAQ"</a></em>
    </p>

    <p><strong>If you have any doubts or suggestions, please feel free to continue the discussion in the comments section below.</strong></p>

    <p><strong>If you found this article helpful, you are welcome to <a href="https://kexue.fm/archives/4521#share">share</a> or <a href="https://kexue.fm/archives/4521#pay">donate to</a> this article. Donations are not for profit, but to let us know how much sincere attention Scientific Spaces has received from its readers. Of course, if you ignore it, it will not affect your reading. Welcome and thank you once again!</strong></p>

    <p>Su Jianlin. (Aug. 08, 2017). "[Memo] Talking about Dropout" [Blog post]. Retrieved from https://kexue.fm/archives/4521</p>
</article>
<hr>
<footer style="margin-top: 3em; padding: 1.5em; background: #f5f5f5; border-radius: 8px; font-size: 0.9em; color: #555;">
    <p style="margin: 0 0 0.5em 0;"><strong>Citation</strong></p>
    <p style="margin: 0 0 0.5em 0;">
        This is a machine translation of the original Chinese article:<br>
        <a href="translation_4521.html" style="color: #005fcc;">https://kexue.fm/archives/4521</a>
    </p>
    <p style="margin: 0 0 0.5em 0;">
        Original author: 苏剑林 (Su Jianlin)<br>
        Original publication: <a href="https://kexue.fm" style="color: #005fcc;">科学空间 (Scientific Spaces)</a>
    </p>
    <p style="margin: 0; font-style: italic;">
        Translated using Gemini 3 Flash. Please refer to the original for authoritative content.
    </p>
</footer>
