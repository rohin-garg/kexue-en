
    <style type="text/css">

    body {
    margin: 48px auto;
    max-width: 68ch;              /* character-based width reads better */
    padding: 0 16px;

    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                Roboto, "Helvetica Neue", Arial, sans-serif;
    font-size: 18px;
    line-height: 1.65;
    color: #333;
    background: #fafafa;
    }

    h1, h2, h3, h4 {
    line-height: 1.25;
    margin-top: 2.2em;
    margin-bottom: 0.6em;
    font-weight: 600;
    }

    h1 {
    font-size: 2.1em;
    margin-top: 0;
    }

    h2 {
    font-size: 1.6em;
    border-bottom: 1px solid #e5e5e5;
    padding-bottom: 0.3em;
    }

    h3 {
    font-size: 1.25em;
    }

    h4 {
    font-size: 1.05em;
    color: #555;
    }

    /* Paragraphs and lists */
    p {
    margin: 1em 0;
    }

    ul, ol {
    margin: 1em 0 1em 1.5em;
    }

    li {
    margin: 0.4em 0;
    }

    a {
    color: #005fcc;
    text-decoration: none;
    }

    a:hover {
    text-decoration: underline;
    }

    code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.95em;
    background: #f2f2f2;
    padding: 0.15em 0.35em;
    border-radius: 4px;
    }

    pre {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.9em;
    background: #f5f5f5;
    padding: 1em 1.2em;
    overflow-x: auto;
    border-radius: 6px;
    line-height: 1.45;
    }

    pre code {
    background: none;
    padding: 0;
    }

    blockquote {
    margin: 1.5em 0;
    padding-left: 1em;
    border-left: 4px solid #ddd;
    color: #555;
    }

    hr {
    border: none;
    border-top: 1px solid #e0e0e0;
    margin: 3em 0;
    }

    table {
    border-collapse: collapse;
    margin: 1.5em 0;
    width: 100%;
    font-size: 0.95em;
    }

    th, td {
    padding: 0.5em 0.7em;
    border-bottom: 1px solid #e5e5e5;
    text-align: left;
    }

    th {
    font-weight: 600;
    }

    img {
    max-width: 100%;
    display: block;
    margin: 1.5em auto;
    }

    small {
    color: #666;
    }

    mjx-container {
    margin: 1em 0;
    }

    ::selection {
    background: #cce2ff;
    }

    </style>
    

<script>
window.MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    tags: 'ams',
    packages: {'[+]': ['ams']}
  }
};
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<article>
    <h1><a href="https://kexue.fm/archives/10684">Intersection Coordinates of Three Spheres (Trilateration)</a></h1>
    
    <p>By 苏剑林 | January 28, 2025</p>

    <p>A few days ago, while pondering a problem, I thought of the three-sphere intersection problem—that is, given the coordinates of the centers and the radii of three spheres, find the coordinates of their intersection points. Logically, this is a well-defined and concise problem with clear application backgrounds (such as satellite positioning), so a "standard answer" should have been provided long ago. However, after searching around, I found that neither English nor Chinese resources seem to provide a readable, standard derivation process.</p>

    <p>Of course, this is not to say that the problem is so difficult that no one can solve it; in fact, it is a classic problem that was solved long ago. I was simply surprised that no one seemed to have written down the derivation process on the internet in a highly readable way, so this article attempts to fill that gap.</p>

    <h2>Special Case <a id="Special_Case" href="#Special_Case">#</a></h2>

    <p>First, let the equations of the three spheres be:
    \begin{align}
    &\text{Sphere 1:}\quad (\boldsymbol{x} - \boldsymbol{o}_1)^2 = r_1^2 \label{eq:s1} \\
    &\text{Sphere 2:}\quad (\boldsymbol{x} - \boldsymbol{o}_2)^2 = r_2^2 \label{eq:s2} \\
    &\text{Sphere 3:}\quad (\boldsymbol{x} - \boldsymbol{o}_3)^2 = r_3^2 \label{eq:s3} 
    \end{align}
    What we need to do is solve for $\boldsymbol{x}$ by simultaneously solving these three equations. Solving the general equations is relatively difficult, but there is a simpler example—when $\boldsymbol{o}_1=(0,0,0), \boldsymbol{o}_2=(a,0,0), \boldsymbol{o}_3=(b,c,0)$, the equations are:
    \begin{align}
    &\text{Sphere 1:}\quad x^2+y^2+z^2 = r_1^2 \label{eq:s4} \\
    &\text{Sphere 2:}\quad (x-a)^2+y^2+z^2 = r_2^2 \label{eq:s5} \\
    &\text{Sphere 3:}\quad (x-b)^2+(y-c)^2+z^2 = r_3^2 \label{eq:s6} 
    \end{align}
    By subtracting equation $\eqref{eq:s4}$ from $\eqref{eq:s5}$, we can solve for $x$. Then, by subtracting equation $\eqref{eq:s4}$ from $\eqref{eq:s6}$, we can solve for $y$, and finally, we can determine $z$:
    \begin{align}
    &x = \frac{r_1^2 - r_2^2 + a^2}{2a} \label{eq:s7} \\[5pt]
    &y = \frac{r_1^2 - r_3^2 + b^2 - 2bx + c^2}{2c} \label{eq:s8} \\[5pt]
    &z = \pm \sqrt{r_1^2 - x^2 - y^2} \label{eq:s9}
    \end{align}
    The final $\pm$ indicates that if the intersection points exist, there will generally be two of them.</p>

    <h2>General Case <a id="General_Case" href="#General_Case">#</a></h2>

    <p>The significance of the above example is that $\boldsymbol{o}_1$ is at the origin, $\boldsymbol{o}_2$ is on the $x$-axis, and $\boldsymbol{o}_3$ is in the $xy$-plane. When they do not satisfy these conditions, we can choose a new coordinate system for them.</p>

    <p>First, subtract $\boldsymbol{o}_1$ from all coordinates, achieving a system where $\boldsymbol{o}_1$ is the origin. Then we denote $\boldsymbol{o}_{ij} = \boldsymbol{o}_j - \boldsymbol{o}_i$, and take
    \begin{equation}\boldsymbol{u}=\frac{\boldsymbol{o}_{12}}{\Vert\boldsymbol{o}_{12}\Vert}\end{equation}
    as the $x$-axis. Thus $\boldsymbol{o}_2$ lies on the $x$-axis, and we have $a=\Vert\boldsymbol{o}_{12}\Vert=\boldsymbol{o}_{12}\cdot\boldsymbol{u}$. Next, take
    \begin{equation}\boldsymbol{v}=\frac{\boldsymbol{o}_{13} - (\boldsymbol{o}_{13}\cdot \boldsymbol{u})\boldsymbol{u}}{\Vert\boldsymbol{o}_{13} - (\boldsymbol{o}_{13}\cdot \boldsymbol{u})\boldsymbol{u}\Vert}\end{equation}
    as the $y$-axis, so that $\boldsymbol{o}_3$ lies in the $xy$-plane, with $b = \boldsymbol{o}_{13}\cdot \boldsymbol{u}$ and $c = \boldsymbol{o}_{13}\cdot \boldsymbol{v}$. Finally, append $\boldsymbol{w}=\boldsymbol{u}\times \boldsymbol{v}$, so that $\boldsymbol{u}, \boldsymbol{v}, \boldsymbol{w}$ form a new orthonormal basis.</p>

    <p>Now that we have $a, b, c$, we can substitute them into equations $\eqref{eq:s7}, \eqref{eq:s8}, \eqref{eq:s9}$ to calculate the intersection coordinates $(x,y,z)$. However, note that these coordinates are obtained in the new coordinate system $(\boldsymbol{u}, \boldsymbol{v}, \boldsymbol{w})$. The intersection points in the original coordinates are:
    \begin{equation}\boldsymbol{x} = x \boldsymbol{u} + y\boldsymbol{v} + z \boldsymbol{w} + \boldsymbol{o}_1\end{equation}</p>

    <h2>Total Process <a id="Total_Process" href="#Total_Process">#</a></h2>

    <p>The above solution process is referenced from the Wikipedia entry "<a href="https://en.wikipedia.org/wiki/True-range_multilateration#Three_Cartesian_dimensions,_three_measured_slant_ranges">True-range multilateration</a>," but the process there was not quite complete, so this article has supplemented it to be full.</p>

    <p>Combining all the steps together:
    \begin{equation}\left\{\begin{aligned}
    &\,\boldsymbol{o}_{ij} = \boldsymbol{o}_j - \boldsymbol{o}_i \\[5pt]
    &\,\boldsymbol{u}=\frac{\boldsymbol{o}_{12}}{\Vert\boldsymbol{o}_{12}\Vert},\,\,\boldsymbol{v}=\frac{\boldsymbol{o}_{13} - (\boldsymbol{o}_{13}\cdot \boldsymbol{u})\boldsymbol{u}}{\Vert\boldsymbol{o}_{13} - (\boldsymbol{o}_{13}\cdot \boldsymbol{u})\boldsymbol{u}\Vert},\,\,\boldsymbol{w}=\boldsymbol{u}\times \boldsymbol{v}\\[5pt]
    &\,a=\boldsymbol{o}_{12}\cdot\boldsymbol{u},\,\,b = \boldsymbol{o}_{13}\cdot \boldsymbol{u},\,\,c = \boldsymbol{o}_{13}\cdot \boldsymbol{v} \\[5pt]
    &\,x = \frac{r_1^2 - r_2^2 + a^2}{2a} \\[5pt]
    &\,y = \frac{r_1^2 - r_3^2 + b^2 - 2bx + c^2}{2c} \\[5pt]
    &\,z = \pm \sqrt{r_1^2 - x^2 - y^2} \\[5pt]
    &\,\boldsymbol{x} = x \boldsymbol{u} + y\boldsymbol{v} + z \boldsymbol{w} + \boldsymbol{o}_1
    \end{aligned}\right.\end{equation}</p>

    <p>Reference implementation:</p>

<pre><code>import numpy as np

def trilaterate(o1, o2, o3, r1, r2, r3):
    o12, o13 = o2 - o1, o3 - o1
    u = o12 / (o12**2).sum()**0.5
    v = (v := o13 - o13.dot(u) * u) / (v**2).sum()**0.5
    w = np.cross(u, v)
    a, b, c = o12.dot(u), o13.dot(u), o13.dot(v)
    x = (r1**2 - r2**2 + a**2) / (2 * a)
    y = (r1**2 - r3**2 + b**2 - 2 * b * x + c**2) / (2 * c)
    z = (r1**2 - x**2 - y**2)**0.5
    p = x * u + y * v + o1
    return p + z * w, p - z * w

o1 = np.array([1, 2, -3])
o2 = np.array([2, 1, -1])
o3 = np.array([-3, 0, 2])
r1, r2, r3 = 4, 5, 6
trilaterate(o1, o2, o3, r1, r2, r3)
</code></pre>

    <h2>Summary <a id="Summary" href="#Summary">#</a></h2>

    <p>This article has organized a relatively concise solution for the three-sphere intersection problem.</p>
</article>
<hr>
<footer style="margin-top: 3em; padding: 1.5em; background: #f5f5f5; border-radius: 8px; font-size: 0.9em; color: #555;">
    <p style="margin: 0 0 0.5em 0;"><strong>Citation</strong></p>
    <p style="margin: 0 0 0.5em 0;">
        This is a machine translation of the original Chinese article:<br>
        <a href="translation_10684.html" style="color: #005fcc;">https://kexue.fm/archives/10684</a>
    </p>
    <p style="margin: 0 0 0.5em 0;">
        Original author: 苏剑林 (Su Jianlin)<br>
        Original publication: <a href="https://kexue.fm" style="color: #005fcc;">科学空间 (Scientific Spaces)</a>
    </p>
    <p style="margin: 0; font-style: italic;">
        Translated using Gemini 3 Flash. Please refer to the original for authoritative content.
    </p>
</footer>
