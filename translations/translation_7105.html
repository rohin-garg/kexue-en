
    <style type="text/css">

    body {
    margin: 48px auto;
    max-width: 68ch;              /* character-based width reads better */
    padding: 0 16px;

    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                Roboto, "Helvetica Neue", Arial, sans-serif;
    font-size: 18px;
    line-height: 1.65;
    color: #333;
    background: #fafafa;
    }

    h1, h2, h3, h4 {
    line-height: 1.25;
    margin-top: 2.2em;
    margin-bottom: 0.6em;
    font-weight: 600;
    }

    h1 {
    font-size: 2.1em;
    margin-top: 0;
    }

    h2 {
    font-size: 1.6em;
    border-bottom: 1px solid #e5e5e5;
    padding-bottom: 0.3em;
    }

    h3 {
    font-size: 1.25em;
    }

    h4 {
    font-size: 1.05em;
    color: #555;
    }

    /* Paragraphs and lists */
    p {
    margin: 1em 0;
    }

    ul, ol {
    margin: 1em 0 1em 1.5em;
    }

    li {
    margin: 0.4em 0;
    }

    a {
    color: #005fcc;
    text-decoration: none;
    }

    a:hover {
    text-decoration: underline;
    }

    code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.95em;
    background: #f2f2f2;
    padding: 0.15em 0.35em;
    border-radius: 4px;
    }

    pre {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.9em;
    background: #f5f5f5;
    padding: 1em 1.2em;
    overflow-x: auto;
    border-radius: 6px;
    line-height: 1.45;
    }

    pre code {
    background: none;
    padding: 0;
    }

    blockquote {
    margin: 1.5em 0;
    padding-left: 1em;
    border-left: 4px solid #ddd;
    color: #555;
    }

    hr {
    border: none;
    border-top: 1px solid #e0e0e0;
    margin: 3em 0;
    }

    table {
    border-collapse: collapse;
    margin: 1.5em 0;
    width: 100%;
    font-size: 0.95em;
    }

    th, td {
    padding: 0.5em 0.7em;
    border-bottom: 1px solid #e5e5e5;
    text-align: left;
    }

    th {
    font-weight: 600;
    }

    img {
    max-width: 100%;
    display: block;
    margin: 1.5em auto;
    }

    small {
    color: #666;
    }

    mjx-container {
    margin: 1em 0;
    }

    ::selection {
    background: #cce2ff;
    }

    </style>
    

<script>
window.MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    processEscapes: true,
    tags: 'ams',
    macros: {
      boldsymbol: ["{\\style{font-weight: bold; font-style: italic;}{#1}}", 1]
    }
  }
};
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

<nav style="margin-bottom: 1.5em;">
    <a href="../index.html" style="display: inline-flex; align-items: center; color: #555; text-decoration: none; font-size: 0.95em;">
        <span style="margin-right: 0.3em;">&larr;</span> Back to Index
    </a>
</nav>

<h1><a href="https://kexue.fm/archives/7105">Cascading Rejection: A Simple and Effective Way to Improve GAN Performance</a></h1>
<p>By 苏剑林 | December 01, 2019</p>

<p>Yesterday while browsing Arxiv, I discovered a paper from South Korea with a very straightforward title: <a href="https://papers.cool/arxiv/1911.10979">"A Simple yet Effective Way for Improving the Performance of GANs"</a>. Upon opening it, I found the content to be very concise, proposing a method to strengthen the GAN discriminator that can lead to certain improvements in generation metrics.</p>

<p>The authors call this method "Cascading Rejection." I wasn't quite sure how to translate it, but Baidu Translate suggested "级联抑制" (Cascading Suppression/Rejection), which seems to fit the logic, so I will refer to it as such for now. I am introducing this method not because it is exceptionally powerful, but because its geometric meaning is very interesting and seems to offer some inspiration.</p>

<h2>Orthogonal Decomposition</h2>

<p>A GAN discriminator generally produces a fixed-length vector $\boldsymbol{v}$ through multiple layers of convolution followed by flattening or pooling. This vector is then used in an inner product with a weight vector $\boldsymbol{w}$ to obtain a scalar score (ignoring bias terms and activation functions for simplicity):</p>

\begin{equation}D(\boldsymbol{x})=\langle \boldsymbol{v},\boldsymbol{w}\rangle\end{equation}

<p>In other words, $\boldsymbol{v}$ is used as the representation of the input image, and the degree of "realness" of the image is judged by the magnitude of the inner product between $\boldsymbol{v}$ and $\boldsymbol{w}$.</p>

<p>However, $\langle \boldsymbol{v},\boldsymbol{w}\rangle$ only depends on the projection component of $\boldsymbol{v}$ onto $\boldsymbol{w}$. In other words, when $\langle \boldsymbol{v},\boldsymbol{w}\rangle$ and $\boldsymbol{w}$ are fixed, $\boldsymbol{v}$ can still vary significantly, as shown in the left figure below.</p>

<p>
  <a href="https://kexue.fm/usr/uploads/2019/11/873030710.png">
    <img src="https://kexue.fm/usr/uploads/2019/11/873030710.png" alt="Vectors v with the same inner product with w can be very different" title="Vectors v with the same inner product with w can be very different">
  </a>
  <br>
  <em>Vectors v with the same inner product with w can be very different</em>
</p>

<p>
  <a href="https://kexue.fm/usr/uploads/2019/11/361353465.png">
    <img src="https://kexue.fm/usr/uploads/2019/11/361353465.png" alt="Projection component and perpendicular component of v" title="Projection component and perpendicular component of v">
  </a>
  <br>
  <em>Projection component and perpendicular component of v</em>
</p>

<p>If we believe an image is "real" when $\langle \boldsymbol{v},\boldsymbol{w}\rangle$ equals a certain value, the problem is that since $\boldsymbol{v}$ can vary so much, does every $\boldsymbol{v}$ truly represent a real image? Not necessarily. This reflects the limitation of scoring via inner product: it only considers the projection component on $\boldsymbol{w}$ and ignores the perpendicular component (as shown in the right figure above):</p>

\begin{equation}\boldsymbol{v}-\Vert \boldsymbol{v}\Vert \cos(\boldsymbol{v},\boldsymbol{w}) \frac{\boldsymbol{w}}{\Vert \boldsymbol{w}\Vert}=\boldsymbol{v}- \frac{\langle\boldsymbol{v},\boldsymbol{w}\rangle}{\Vert \boldsymbol{w}\Vert^2}\boldsymbol{w}\end{equation}

<p>Given this, a natural idea is: can we use another parameter vector to perform classification again on this perpendicular component? Clearly, we can. Furthermore, this second classification of the perpendicular component will also result in a new perpendicular component, so this process can be iterated:</p>

\begin{equation}
\left\{
\begin{aligned}
&\boldsymbol{v}_1=\boldsymbol{v}\\
&D_1(\boldsymbol{x})=\langle \boldsymbol{v}_1,\boldsymbol{w}_1\rangle\\
&\boldsymbol{v}_2 = \boldsymbol{v}_1- \frac{\langle\boldsymbol{v}_1,\boldsymbol{w}_1\rangle}{\Vert \boldsymbol{w}_1\Vert^2}\boldsymbol{w}_1\\
&D_2(\boldsymbol{x})=\langle \boldsymbol{v}_2,\boldsymbol{w}_2\rangle\\
&\boldsymbol{v}_3 = \boldsymbol{v}_2- \frac{\langle\boldsymbol{v}_2,\boldsymbol{w}_2\rangle}{\Vert \boldsymbol{w}_2\Vert^2}\boldsymbol{w}_2\\
&D_3(\boldsymbol{x})=\langle \boldsymbol{v}_3,\boldsymbol{w}_3\rangle\\
&\boldsymbol{v}_4 = \boldsymbol{v}_3- \frac{\langle\boldsymbol{v}_3,\boldsymbol{w}_3\rangle}{\Vert \boldsymbol{w}_3\Vert^2}\boldsymbol{w}_3\\
&\qquad\vdots\\
&D_N(\boldsymbol{x})=\langle \boldsymbol{v}_N,\boldsymbol{w}_N\rangle\\
\end{aligned}
\right.
\end{equation}

<h2>Analysis and Reflection</h2>

<p>Essentially, the core idea of the original paper has been explained; the rest involves some implementation details. First, since there are now $N$ scores $D_1(\boldsymbol{x}),D_2(\boldsymbol{x}),\dots,D_N(\boldsymbol{x})$, each score can be applied to the discriminator's loss (either directly using hinge loss or with a sigmoid activation followed by cross-entropy). Finally, a weighted average of these $N$ losses is taken as the final discriminator loss. This alone can bring performance improvements to the GAN. The authors also extended this to CGANs and obtained good results.</p>

<p>
  <a href="https://kexue.fm/usr/uploads/2019/11/1864282304.png">
    <img src="https://kexue.fm/usr/uploads/2019/11/1864282304.png" alt="Experimental results of the proposed GAN technique" title="Experimental results of the proposed GAN technique">
  </a>
  <br>
  <em>Experimental results of the proposed GAN technique</em>
</p>

<p>Compared to the experimental results, I believe the deeper significance of this technique is more worthy of attention. In principle, this idea could be applied to general classification problems, not just GANs. By iteratively incorporating perpendicular components into the prediction, we can consider the parameters $\boldsymbol{w}_1,\boldsymbol{w}_2,\dots,\boldsymbol{w}_N$ as representing $N$ different perspectives, and each classification corresponds to a judgment from a different viewpoint.</p>

<p>Thinking about this, I am reminded of Hinton's <a href="https://kexue.fm/tag/Capsule/">Capsule</a>. Although the form is different, the underlying intention seems similar. Capsules aim to represent an entity with a vector rather than a scalar. This "Cascading Rejection" also provides multiple classification results through continuous perpendicular decomposition. In other words, to determine if a vector belongs to a class, it must provide multiple scores rather than just one. This also has the flavor of "using vectors rather than scalars."</p>

<p>Regrettably, when I performed a simple experiment (on CIFAR-10) using this approach, I found that the classification accuracy on the validation set decreased slightly (note that this does not contradict the GAN results; GAN performance improves because it increases the difficulty for the discriminator, whereas supervised classification models do not benefit from increased discrimination difficulty). However, on the bright side, the degree of overfitting decreased (i.e., the gap between training and validation accuracy narrowed). Of course, my experiment was too simple to draw a rigorous conclusion. Nevertheless, I still feel that due to its distinct geometric meaning, this technique is worth further consideration.</p>

<h2>Summary</h2>

<p>This article introduced a technique with distinct geometric significance for improving GAN performance and further discussed its potential value.</p>

<p>
  <strong>Original address of this article:</strong> 
  <a href="https://kexue.fm/archives/7105">https://kexue.fm/archives/7105</a>
</p>
<hr>
<footer style="margin-top: 3em; padding: 1.5em; background: #f5f5f5; border-radius: 8px; font-size: 0.9em; color: #555;">
    <p style="margin: 0 0 0.5em 0;"><strong>Citation</strong></p>
    <p style="margin: 0 0 0.5em 0;">
        This is a machine translation of the original Chinese article:<br>
        <a href="https://kexue.fm/archives/7105" style="color: #005fcc;">https://kexue.fm/archives/7105</a>
    </p>
    <p style="margin: 0 0 0.5em 0;">
        Original author: 苏剑林 (Su Jianlin)<br>
        Original publication: <a href="https://kexue.fm" style="color: #005fcc;">科学空间 (Scientific Spaces)</a>
    </p>
    <p style="margin: 0; font-style: italic;">
        Translated using Gemini 3 Flash. Please refer to the original for authoritative content.
    </p>
</footer>
