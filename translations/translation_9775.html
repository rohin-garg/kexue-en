
    <style type="text/css">

    body {
    margin: 48px auto;
    max-width: 68ch;              /* character-based width reads better */
    padding: 0 16px;

    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                Roboto, "Helvetica Neue", Arial, sans-serif;
    font-size: 18px;
    line-height: 1.65;
    color: #333;
    background: #fafafa;
    }

    h1, h2, h3, h4 {
    line-height: 1.25;
    margin-top: 2.2em;
    margin-bottom: 0.6em;
    font-weight: 600;
    }

    h1 {
    font-size: 2.1em;
    margin-top: 0;
    }

    h2 {
    font-size: 1.6em;
    border-bottom: 1px solid #e5e5e5;
    padding-bottom: 0.3em;
    }

    h3 {
    font-size: 1.25em;
    }

    h4 {
    font-size: 1.05em;
    color: #555;
    }

    /* Paragraphs and lists */
    p {
    margin: 1em 0;
    }

    ul, ol {
    margin: 1em 0 1em 1.5em;
    }

    li {
    margin: 0.4em 0;
    }

    a {
    color: #005fcc;
    text-decoration: none;
    }

    a:hover {
    text-decoration: underline;
    }

    code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.95em;
    background: #f2f2f2;
    padding: 0.15em 0.35em;
    border-radius: 4px;
    }

    pre {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.9em;
    background: #f5f5f5;
    padding: 1em 1.2em;
    overflow-x: auto;
    border-radius: 6px;
    line-height: 1.45;
    }

    pre code {
    background: none;
    padding: 0;
    }

    blockquote {
    margin: 1.5em 0;
    padding-left: 1em;
    border-left: 4px solid #ddd;
    color: #555;
    }

    hr {
    border: none;
    border-top: 1px solid #e0e0e0;
    margin: 3em 0;
    }

    table {
    border-collapse: collapse;
    margin: 1.5em 0;
    width: 100%;
    font-size: 0.95em;
    }

    th, td {
    padding: 0.5em 0.7em;
    border-bottom: 1px solid #e5e5e5;
    text-align: left;
    }

    th {
    font-weight: 600;
    }

    img {
    max-width: 100%;
    display: block;
    margin: 1.5em auto;
    }

    small {
    color: #666;
    }

    mjx-container {
    margin: 1em 0;
    }

    ::selection {
    background: #cce2ff;
    }

    </style>
    

<script>
window.MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    tags: 'ams',
    processEscapes: true,
    packages: {'[+]': ['ams']}
  },
  options: {
    renderActions: {
      findScript: [10, function (doc) {
        for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
          const display = !!node.type.match(/; *mode=display/);
          const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
          const text = document.createTextNode('');
          node.parentNode.replaceChild(text, node);
          math.start = {node: text, delim: '', n: 0};
          math.end = {node: text, delim: '', n: 0};
          doc.math.push(math);
        }
      }, '']
    }
  }
};
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<article>
    <h1><a href="https://kexue.fm/archives/9775">The Minimum Value of $a+b+c$ When $N=ab+c$ in the Set of Natural Numbers</a></h1>

    <p>By 苏剑林 | September 20, 2023</p>


    <p>The night before last, a member in a WeChat group posed a question: For an arbitrary integer $N > 100$, find an approximate algorithm to find $N=a \times b+c$ (where $a, b, c$ are non-negative integers) such that $a+b+c$ is as small as possible. At first glance, my initial reaction was, "Is an algorithm even necessary for this?" It seemed like there was so much freedom that an analytical solution should exist. After a brief analysis, I offered an "answer," but a group member quickly provided a counterexample. It was then that I realized the problem was not so trivial. After formally deriving it, I finally arrived at a viable algorithm. Just as I thought the problem was settled, a member of another mathematics group elegantly constructed a new parameterization, proving that the algorithm's complexity could be further reduced! The entire process was full of twists and turns, yielding significant insights, which I have recorded here to share with everyone.</p>

    <h2>A Careless Mistake</h2>
    <p>Setting aside the constraint $N > 100$, the original problem can be equivalently transformed into: Given $a, b \in \mathbb{N}$ and $ab \leq N$, find the minimum value of $S = N - ab + a + b$. Clearly, when $N$ is sufficiently large, $ab$ should be the dominant term. Intuitively, $ab$ should be as close to $N$ as possible, and $a, b$ should be as close to each other as possible. Based on this, I hastily proposed a solution: "Choose between $a=b=\lfloor\sqrt{N}\rfloor$ and $a=\lfloor\sqrt{N}\rfloor, b=\lfloor\sqrt{N}\rfloor+1$." However, a group member quickly pointed out a counterexample: when $N=130$, the minimum value of $S$ is achieved at $a=10, b=13$ ($S = 130 - 130 + 10 + 13 = 23$), whereas my formula would give $a=b=11$ ($S = 130 - 121 + 11 + 11 = 31$), which is clearly not optimal.</p>

    <p>Upon reflection, I realized I had underestimated this problem, so I set out to derive it carefully.</p>

    <h2>Direct Analysis</h2>
    <p>Without loss of generality, let $a \leq b$. First, $S$ can be transformed as follows:</p>
    \begin{equation}S = N - (\sqrt{ab}-1)^2 + (\sqrt{a}-\sqrt{b})^2\end{equation}
    <p>It can be seen that minimizing $S$ generally involves two directions: 1. Making $ab$ as large as possible (close to $N$); 2. Making $a$ and $b$ as close as possible. To this end, let us set</p>
    \begin{equation}b = \left\lfloor\frac{N}{a}\right\rfloor = \frac{N}{a} - \left\{\frac{N}{a}\right\}\end{equation}
    <p>Then</p>
    \begin{equation}S = N - a\left(\frac{N}{a} - \left\{\frac{N}{a}\right\}\right)+ a + \frac{N}{a} - \left\{\frac{N}{a}\right\} = (a-1)\left\{\frac{N}{a}\right\} + a + \frac{N}{a}\label{eq:S}\end{equation}
    <p>Consider two extremes: 1. In the ideal case where $\left\{\frac{N}{a}\right\}=0$, the minimum value of $a + \frac{N}{a}$ is reached at $a=\sqrt{N}$. 2. In the least ideal case, $\left\{\frac{N}{a}\right\}$ can be infinitely close to 1, i.e.,</p>
    \begin{equation}S \to a - 1 + a + \frac{N}{a} = 2a + \frac{N}{a} - 1\end{equation}
    <p>In this case, the minimum is reached at $a=\sqrt{N/2}$. Based on these two points, we can propose an algorithm: iterate $a$ through all integers in the interval $\big(\sqrt{N/2}, \sqrt{N}\big]$, set $b=\left\lfloor N/a\right\rfloor$, and find the minimum $S$. Obviously, this is an algorithm with complexity $\mathcal{O}(\sqrt{N})$, similar in complexity to large integer factorization. When I first derived this, I was quite surprised that such an unassuming problem would have the same complexity as large number factorization.</p>

    <h2>New Parameterization</h2>
    <p>Later, I shared the problem in a math group, and after some guidance from experts there, I realized my previous analysis was still too superficial. It turns out the complexity of the algorithm can be significantly reduced. The key to reducing complexity is to introduce a new parameterization and refine the inequality bounds to narrow the search range. Assuming $a, b$ have the same parity, we can set $a=x-y$ and $b=x+y$, where $x, y \in \mathbb{N}$. We then get</p>
    \begin{equation}N + y^2 = x^2 + c,\quad S = 2x + c \end{equation}
    <p>The key to this new parameterization is that it changes the product $ab$ into the difference $x^2-y^2$, allowing us to see the direction of change more clearly and permitting finer bounding. If $a, b$ have different parity, we simply replace $x$ with $x+\frac{1}{2}$ and $y$ with $y+\frac{1}{2}$. The derivation is similar; we discuss both below.</p>

    <h3>Same Parity</h3>
    <p>Furthermore, we have</p>
    \begin{equation}S = 2x + c = 2x + (N + y^2 - x^2)= N + y^2 + 1 - (x - 1)^2\end{equation}
    <p>and $N + y^2 \geq x^2$. If $x$ is fixed, then clearly $y$ should be minimized to minimize $S$. Next, we discuss two cases. In the first case, $x^2 \leq N$, then the minimum value of $y^2 \geq x^2 - N$ is clearly $y=0$. In this case, $S=N+1-(x-1)^2$, and as $x$ increases, $S$ decreases. Since $x^2 \leq N$, the maximum possible $x$ is $x=\left\lfloor \sqrt{N}\right\rfloor$.</p>

    <p>In the second case, $x^2 \geq N$, the minimum value of $y^2 \geq x^2 - N$ is $y=\left\lceil \sqrt{x^2 - N}\right\rceil$. At this point,</p>
    \begin{equation}\begin{aligned} 
    S =&\, 2x + (N + y^2 - x^2)\\ 
    \leq&\, 2x + \left[N + \left(\sqrt{x^2 - N} + 1\right)^2 - x^2\right]\\ 
    =&\,2x + 1 + 2\sqrt{x^2 - N} 
    \end{aligned}\label{eq:S1}\end{equation}
    <p>The final expression is monotonically increasing with respect to $x$, so to minimize it, $x$ should be as small as possible. Combined with $x^2 \geq N$, we take $x=\left\lceil \sqrt{N}\right\rceil$. Note that this is calculated based on an upper bound of $S$; the actual minimum of $S$ might not be at $x=\left\lceil \sqrt{N}\right\rceil$, but we can use this result to narrow the search range. Substituting into the inequality above, we further obtain</p>
    \begin{equation}\begin{aligned} 
    S \leq&\,2x + 1 + 2\sqrt{x^2 - N} \\ 
    \leq&\,2(\sqrt{N}+1) + 1 + 2\sqrt{(\sqrt{N}+1)^2 - N} \\ 
    =&\,2\sqrt{N}+ 3+ 2\sqrt{1+ 2\sqrt{N}} \\ 
    \end{aligned}\label{eq:S2}\end{equation}
    <p>This provides an upper bound for the minimum value of $S$. Suppose the minimum of $S$ occurs at $x=x^*, c=c^*$. Then we have</p>
    \begin{equation}\begin{array}{c} S = 2x^* + c^* \leq 2\sqrt{N}+ 3+ 2\sqrt{1+ 2\sqrt{N}} \\ 
    \Downarrow\\ 
    x^*\leq \sqrt{N} + \frac{3}{2} + \sqrt{1+ 2\sqrt{N}} = \sqrt{N} + \mathcal{O}(\sqrt[4]{N}) 
    \end{array}\end{equation}
    <p>This means we only need to search the integers in the interval $\big[\sqrt{N}, \sqrt{N} + \frac{3}{2} + \sqrt{1+ 2\sqrt{N}}\big]$ to find the optimal solution. The complexity is $\mathcal{O}(\sqrt[4]{N})$ rather than $\mathcal{O}(\sqrt{N})$!</p>

    <h3>Different Parity</h3>
    <p>Assuming $a, b$ have different parity, we can set $a=\left(x+\frac{1}{2}\right)-\left(y+\frac{1}{2}\right)$ and $b=\left(x+\frac{1}{2}\right)+\left(y+\frac{1}{2}\right)$, where $x, y \in \mathbb{N}$. We then get</p>
    \begin{equation}\begin{aligned} 
    &\,N + \left(y+\frac{1}{2}\right)^2 = \left(x+\frac{1}{2}\right)^2 + c \\ 
    &\,S = 2\left(x + \frac{1}{2}\right) + c = N + \left(y+\frac{1}{2}\right)^2 + 1 - \left(x-\frac{1}{2}\right)^2 
    \end{aligned}\end{equation}
    <p>Similarly, we discuss two cases. First, when $\left(x+\frac{1}{2}\right)^2 \leq N$, a result similar to the previous section is $y=0$ and $x=\left\lfloor \sqrt{N}-\frac{1}{2}\right\rfloor$. Second, when $\left(x+\frac{1}{2}\right)^2 \geq N$, the minimum value of $y$ is $y=\left\lceil \sqrt{\left(x+\frac{1}{2}\right)^2 - N}-\frac{1}{2}\right\rceil$. By reasoning identical to $\eqref{eq:S1}$ and $\eqref{eq:S2}$ and substituting $x=\left\lceil \sqrt{N}-\frac{1}{2}\right\rceil$, we have</p>
    \begin{equation}\begin{aligned} 
    S =&\, 2\left(x + \frac{1}{2}\right) + \left[N + \left(y + \frac{1}{2}\right)^2 - \left(x+\frac{1}{2}\right)^2\right] \\ 
    \leq&\, 2\left(x + \frac{1}{2}\right) + \left[N + \left(\sqrt{\left(x 
    + \frac{1}{2}\right)^2 - N} + 1\right)^2 - \left(x+\frac{1}{2}\right)^2\right]\\ 
    =&\,2\left(x 
    + \frac{1}{2}\right) + 1 + 2\sqrt{\left(x 
    + \frac{1}{2}\right)^2 - N} \\ 
    \leq&\,2(\sqrt{N}+1) + 1 + 2\sqrt{(\sqrt{N}+1)^2 - N} \\ 
    =&\,2\sqrt{N}+ 3+ 2\sqrt{1+ 2\sqrt{N}} \\ 
    \end{aligned}\end{equation}
    <p>Therefore:</p>
    \begin{equation}\begin{array}{c} S = 2\left(x^*+\frac{1}{2}\right) + c^* \leq 2\sqrt{N}+ 3+ 2\sqrt{1+ 2\sqrt{N}} \\ 
    \Downarrow\\ 
    x^*\leq \sqrt{N} + 1 + \sqrt{1+ 2\sqrt{N}} = \sqrt{N} + \mathcal{O}(\sqrt[4]{N}) 
    \end{array}\end{equation}

    <h2>Summary of Results</h2>
    <p>Compiling the results from the two sections above, the process for finding the minimum of $S$ can be organized as follows:</p>
    <ol>
        <li>If $N$ is a perfect square, return $x=\sqrt{N}, y=0$ (so $a=b=\sqrt{N}, c=0$);</li>
        <li>Otherwise, calculate $S$ for both ($x=\lfloor \sqrt{N}\rfloor, y=0$) and ($x=\lfloor \sqrt{N}-\frac{1}{2}\rfloor+\frac{1}{2}, y=\frac{1}{2}$), and record the one that gives the smaller $S$;</li>
        <li>Iterate through all integers $m$ in the interval $\big(\sqrt{N}-1/2, \sqrt{N} + \frac{3}{2} + \sqrt{1+ 2\sqrt{N}}\big]$. Let $x=m$ and $y=\lceil \sqrt{m^2 - N}\rceil$, as well as $x=m+\frac{1}{2}$ and $y=\lceil \sqrt{(m+\frac{1}{2})^2 - N}-\frac{1}{2}\rceil + \frac{1}{2}$. If either corresponds to a smaller $S$, update the recorded $x, y$.</li>
        <li>Return $a=x-y, b=x+y, c=N-ab$.</li>
    </ol>

    <h2>Another Perspective</h2>
    <p>After the article was published, an expert noted that discussing the parity of $a, b$ separately was somewhat cumbersome and proposed a different parameterization: Let $p=a+b$ and $q=b-a$. Then</p>
    \begin{equation}4N - p^2 + q^2 = 4c, \quad S = p + c \end{equation}
    <p>Note that $p$ and $q$ must have the same parity to ensure that $c$ is an integer. The analysis then follows the same logic. Since $c \geq 0$, $q^2 \geq p^2 - 4N$. For a fixed $p$, minimizing $S$ is equivalent to minimizing $c$, which is equivalent to minimizing $q$. If $p^2 \leq 4N$, the minimum $q$ is 0 or 1, determined by the parity of $p$. Then from</p>
    \begin{equation}4S = 4p+4c = 4p + 4N - p^2 + q^2 = 4N + q^2 + 4 - (p - 2)^2 \end{equation}
    <p>Minimizing $S$ corresponds to maximizing $p$. Combined with $p^2 \leq 4N$, we have $p=\left\lfloor 2\sqrt{N}\right\rfloor$.</p>

    <p>If $p^2 \geq 4N$, the minimum $q$ is $q=\left\lceil \sqrt{p^2 - 4N} \right\rceil + \varepsilon$, where $\varepsilon \in \{0, 1\}$ is determined by parity. Expanding this:</p>
    \begin{equation}\begin{aligned} 
    4S =&\, 4p + 4N - p^2 + q^2 \\ 
    \leq &\, 4p + 4N - p^2 + \left( \sqrt{p^2 - 4N} + \varepsilon + 1\right)^2 \\ 
    =&\, 4p + (\varepsilon + 1)^2 + 2(\varepsilon + 1)\sqrt{p^2 - 4N} 
    \end{aligned}\end{equation}
    <p>By substituting $p=\left\lceil 2\sqrt{N}\right\rceil$, we can derive an upper bound for the minimum $4S$:</p>
    \begin{equation}\begin{aligned} 
    4S \leq&\, 4p + (\varepsilon + 1)^2 + 2(\varepsilon + 1)\sqrt{p^2 - 4N} \\ 
    \leq&\, 4(2\sqrt{N} + 1) + (\varepsilon + 1)^2 + 2(\varepsilon + 1)\sqrt{(2\sqrt{N} + 1)^2 - 4N} \\ 
    =&\, 4(2\sqrt{N} + 1) + (\varepsilon + 1)^2 + 2(\varepsilon + 1)\sqrt{1 + 4\sqrt{N}} \\ 
    \leq&\, 4(2\sqrt{N} + 1) + 4 + 4\sqrt{1 + 4\sqrt{N}} \\ 
    \\ 
    \Rightarrow S \leq&\,2\sqrt{N} + 2 + \sqrt{1 + 4\sqrt{N}} 
    \end{aligned}\end{equation}
    <p>Since $S = p + c \geq p$, this also serves as an upper bound for $p$.</p>

    <p>In summary, the new process for minimizing $S$ is as follows:</p>
    <ol>
        <li>If $N$ is a perfect square, return $p=2\sqrt{N}, q=0$ (so $a=b=\sqrt{N}, c=0$);</li>
        <li>Otherwise, set $p = \left\lfloor 2\sqrt{N}\right\rfloor$. If $p$ is even, then $q=0$; otherwise $q=1$. Calculate $S$.</li>
        <li>Iterate $p$ through all integers in the interval $\big(2\sqrt{N}, 2\sqrt{N} + 2 + \sqrt{1 + 4\sqrt{N}}\big]$. For each, set $q=\left\lceil \sqrt{p^2 - 4N} \right\rceil + \varepsilon$, where $\varepsilon \in \{0, 1\}$ ensures $p, q$ have the same parity. If the resulting $S$ is smaller, update the record.</li>
        <li>Return $a=\frac{p-q}{2}, b=\frac{p+q}{2}, c=N-ab$.</li>
    </ol>

    <h2>Conclusion</h2>
    <p>This article shared the thinking and learning process for an algorithm problem that I "initially thought was a Bronze but turned out to be a King."</p>

    <hr>
    <p>
        Address for reprinting: <a href="translation_9775.html">https://kexue.fm/archives/9775</a><br>
        For more detailed reprinting matters, please refer to: <a href="https://kexue.fm/faq.html">Scientific Space FAQ</a>
    </p>

    <p>If you have any doubts or suggestions, please continue the discussion in the comments section below.</p>

    <p>If you need to cite this article, please refer to:</p>
    <p>
        Su Jianlin. (Sep. 20, 2023). "The Minimum Value of a + b + c When N = ab + c in the Set of Natural Numbers" [Blog post]. Retrieved from <a href="translation_9775.html">https://kexue.fm/archives/9775</a>
    </p>
    </article>
<hr>
<footer style="margin-top: 3em; padding: 1.5em; background: #f5f5f5; border-radius: 8px; font-size: 0.9em; color: #555;">
    <p style="margin: 0 0 0.5em 0;"><strong>Citation</strong></p>
    <p style="margin: 0 0 0.5em 0;">
        This is a machine translation of the original Chinese article:<br>
        <a href="translation_9775.html" style="color: #005fcc;">https://kexue.fm/archives/9775</a>
    </p>
    <p style="margin: 0 0 0.5em 0;">
        Original author: 苏剑林 (Su Jianlin)<br>
        Original publication: <a href="https://kexue.fm" style="color: #005fcc;">科学空间 (Scientific Spaces)</a>
    </p>
    <p style="margin: 0; font-style: italic;">
        Translated using Gemini 3 Flash. Please refer to the original for authoritative content.
    </p>
</footer>
