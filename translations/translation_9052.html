
    <style type="text/css">

    body {
    margin: 48px auto;
    max-width: 68ch;              /* character-based width reads better */
    padding: 0 16px;

    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                Roboto, "Helvetica Neue", Arial, sans-serif;
    font-size: 18px;
    line-height: 1.65;
    color: #333;
    background: #fafafa;
    }

    h1, h2, h3, h4 {
    line-height: 1.25;
    margin-top: 2.2em;
    margin-bottom: 0.6em;
    font-weight: 600;
    }

    h1 {
    font-size: 2.1em;
    margin-top: 0;
    }

    h2 {
    font-size: 1.6em;
    border-bottom: 1px solid #e5e5e5;
    padding-bottom: 0.3em;
    }

    h3 {
    font-size: 1.25em;
    }

    h4 {
    font-size: 1.05em;
    color: #555;
    }

    /* Paragraphs and lists */
    p {
    margin: 1em 0;
    }

    ul, ol {
    margin: 1em 0 1em 1.5em;
    }

    li {
    margin: 0.4em 0;
    }

    a {
    color: #005fcc;
    text-decoration: none;
    }

    a:hover {
    text-decoration: underline;
    }

    code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.95em;
    background: #f2f2f2;
    padding: 0.15em 0.35em;
    border-radius: 4px;
    }

    pre {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.9em;
    background: #f5f5f5;
    padding: 1em 1.2em;
    overflow-x: auto;
    border-radius: 6px;
    line-height: 1.45;
    }

    pre code {
    background: none;
    padding: 0;
    }

    blockquote {
    margin: 1.5em 0;
    padding-left: 1em;
    border-left: 4px solid #ddd;
    color: #555;
    }

    hr {
    border: none;
    border-top: 1px solid #e0e0e0;
    margin: 3em 0;
    }

    table {
    border-collapse: collapse;
    margin: 1.5em 0;
    width: 100%;
    font-size: 0.95em;
    }

    th, td {
    padding: 0.5em 0.7em;
    border-bottom: 1px solid #e5e5e5;
    text-align: left;
    }

    th {
    font-weight: 600;
    }

    img {
    max-width: 100%;
    display: block;
    margin: 1.5em auto;
    }

    small {
    color: #666;
    }

    mjx-container {
    margin: 1em 0;
    }

    ::selection {
    background: #cce2ff;
    }

    </style>
    

<script>
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']],
      tags: 'ams',
      packages: {'[+]': ['ams']}
    }
  };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<article>
  <nav style="margin-bottom: 1.5em;">
    <a href="../index.html" style="display: inline-flex; align-items: center; color: #555; text-decoration: none; font-size: 0.95em;">
        <span style="margin-right: 0.3em;">&larr;</span> Back to Index
    </a>
</nav>

  <h1><a href="https://kexue.fm/archives/9052">GAU-α: Experiencing the "Faster, Better, and More Efficient" Next-Generation Attention</a></h1>
  <p>By 苏剑林 | April 22, 2022</p>

  <p>In <a href="translation_8934.html">"FLASH: Probably the Most Interesting Efficient Transformer Design Recently"</a>, we introduced the GAU (Gated Attention Unit). I am personally inclined to call it the "most promising next-generation Attention design" because it truly achieves the characteristics of being "faster (speed), better (performance), and more efficient (memory)."</p>

  <p>However, some readers have obtained opposite results in their own tests, such as slower convergence or worse performance, which differs greatly from my own testing results. This article aims to share my own training experience and release a "taster" version, "GAU-α," for everyone to test.</p>

  <blockquote>
    <strong>Open Source Address: <a href="https://github.com/ZhuiyiTechnology/GAU-alpha">https://github.com/ZhuiyiTechnology/GAU-alpha</a></strong>
  </blockquote>

  <h2>GAU-α</h2>

  <p>First, let's introduce the scorecard of the open-sourced "GAU-α" on CLUE tasks:</p>

  \[\small{\begin{array}{c|ccccccccccc}
  \hline
  & \text{iflytek} & \text{tnews} & \text{afqmc} & \text{cmnli} & \text{ocnli} & \text{wsc} & \text{csl} & \text{cmrc2018} & \text{c3} & \text{chid} & \text{cluener}\\
  \hline
  \text{BERT} & 60.06 & 56.80 & 72.41 & 79.56 & 73.93 & 78.62 & 83.93 & 56.17 & 60.54 & 85.69 & 79.45 \\
  \text{RoBERTa} & 60.64 & \textbf{58.06} & 74.05 & 81.24 & 76.00 & \textbf{87.50} & 84.50 & 56.54 & 67.66 & 86.71 & 79.47\\
  \text{RoFormer} & 60.91 & 57.54 & 73.52 & 80.92 & \textbf{76.07} & 86.84 & 84.63 & 56.26 & 67.24 & 86.57 & 79.72\\
  \text{RoFormerV2}^\ast & 60.87 & 56.54 & 72.75 & 80.34 & 75.36 & 80.92 & 84.67 & 57.91 & 64.62 & 85.09 & \textbf{81.08}\\
  \hline
  \text{GAU-}\alpha & \textbf{61.41} & 57.76 & \textbf{74.17} & \textbf{81.82} & 75.86 & 79.93 & \textbf{85.67} & \textbf{58.09} & \textbf{68.24} & \textbf{87.91} & 80.01\\
  \hline
  \end{array}}\]

  <p>All models are the Base version. The table above displays the results on the validation sets of CLUE tasks; the execution methods and comparisons for everyone are fair, making this a reasonable relative comparison. Additionally, the RoFormerV2* here is not the multi-task version mentioned in <a href="translation_8998.html">"RoFormerV2: Exploring the Limits of Natural Language Understanding"</a>, but a version that only underwent MLM pre-training (this specific version was not open-sourced). This comparison is made because GAU-α also only underwent MLM pre-training.</p>

  <p>As can be seen from the table, except for the "outlier" WSC, which has an extremely small amount of data, GAU-α holds an advantage in most tasks and has the best average score excluding WSC. Among them, the comparison between RoFormerV2* and GAU-α is the most fair because their training scripts, training data, and overall structures are identical. The only difference is that GAU-α replaces the Attention+FFN combination in RoFormerV2* with two layers of GAU. This comparison fully demonstrates the "better" characteristic of the GAU design.</p>

  <p>Furthermore, as we introduced in <a href="translation_8998.html">"RoFormerV2: Exploring the Limits of Natural Language Understanding"</a>, RoFormerV2 simplified the structure to achieve faster speeds. GAU-α, sharing the same overall structure, is the same. Therefore, the speed of GAU-α is faster than the BERT, RoBERTa, and RoFormer models in the table, yet its average performance is superior. Further testing shows that when the sequence length exceeds 512, GAU-α's speed begins to surpass the similarly streamlined RoFormerV2, and its memory usage is lower; the longer the sequence, the more advantageous it is for GAU-α.</p>

  <h2>Training</h2>

  <p>Now, let's introduce the training details of the model. The complete code has been open-sourced on GitHub; if you have doubts, you can read it alongside the code.</p>

  <p><strong>Model Architecture:</strong> GAU-α simply replaces the Attention+FFN in RoFormerV2 with two layers of GAU. In a <a href="translation_8934.html">previous article</a>, we compared the computational and parameter costs of two GAU layers to be roughly equivalent to an Attention+FFN combination, so this replacement is reasonable. Characteristics of RoFormerV2 include retaining the Post Norm structure, removing all Bias terms, and replacing Layer Norm with the simplest variant of RMS Norm, all of which are maintained in GAU-α.</p>

  <p><strong>Normalization:</strong> In <a href="translation_9019.html">"I Heard Attention and Softmax Go Better Together~"</a>, we discussed the normalization problem of Attention. For GAU-α, the Attention normalization selects the <a href="translation_8823.html">Entropy-Invariant Softmax</a> (temporarily called softmax_plus in bert4keras), which I proposed and which possesses good extrapolation capabilities.</p>

  <p><strong>Training Method:</strong> Regarding initialization, I followed the adjustments in <a href="translation_8978.html">"What are the Difficulties in Training a 1000-layer Transformer?"</a>. As a result, training can begin directly without the need for Warmup. The optimizer used is LAMB, with a piecewise linear decay learning rate. The pre-training task is full-word MLM, and the tokenization tool is Baidu's LAC. These are all aligned with RoFormerV2.</p>

  <p>It seems there isn't much more worth mentioning; indeed, not many major changes were made. Aside from spending a bit of time testing different normalization methods, not much extra time was spent elsewhere; direct training yielded good results.</p>

  <h2>Summary</h2>

  <p>GAU is what I consider to be the "most promising next-generation Attention design at present." This article has shared some training experiences for GAU and open-sourced a "taster" version, "GAU-α."</p>

  <hr />

  </article>
<hr>
<footer style="margin-top: 3em; padding: 1.5em; background: #f5f5f5; border-radius: 8px; font-size: 0.9em; color: #555;">
    <p style="margin: 0 0 0.5em 0;"><strong>Citation</strong></p>
    <p style="margin: 0 0 0.5em 0;">
        This is a machine translation of the original Chinese article:<br>
        <a href="https://kexue.fm/archives/9052" style="color: #005fcc;">https://kexue.fm/archives/9052</a>
    </p>
    <p style="margin: 0 0 0.5em 0;">
        Original author: 苏剑林 (Su Jianlin)<br>
        Original publication: <a href="https://kexue.fm" style="color: #005fcc;">科学空间 (Scientific Spaces)</a>
    </p>
    <p style="margin: 0; font-style: italic;">
        Translated using Gemini 3 Flash. Please refer to the original for authoritative content.
    </p>
</footer>
