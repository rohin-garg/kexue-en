
    <style type="text/css">

    body {
    margin: 48px auto;
    max-width: 68ch;              /* character-based width reads better */
    padding: 0 16px;

    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                Roboto, "Helvetica Neue", Arial, sans-serif;
    font-size: 18px;
    line-height: 1.65;
    color: #333;
    background: #fafafa;
    }

    h1, h2, h3, h4 {
    line-height: 1.25;
    margin-top: 2.2em;
    margin-bottom: 0.6em;
    font-weight: 600;
    }

    h1 {
    font-size: 2.1em;
    margin-top: 0;
    }

    h2 {
    font-size: 1.6em;
    border-bottom: 1px solid #e5e5e5;
    padding-bottom: 0.3em;
    }

    h3 {
    font-size: 1.25em;
    }

    h4 {
    font-size: 1.05em;
    color: #555;
    }

    /* Paragraphs and lists */
    p {
    margin: 1em 0;
    }

    ul, ol {
    margin: 1em 0 1em 1.5em;
    }

    li {
    margin: 0.4em 0;
    }

    a {
    color: #005fcc;
    text-decoration: none;
    }

    a:hover {
    text-decoration: underline;
    }

    code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.95em;
    background: #f2f2f2;
    padding: 0.15em 0.35em;
    border-radius: 4px;
    }

    pre {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.9em;
    background: #f5f5f5;
    padding: 1em 1.2em;
    overflow-x: auto;
    border-radius: 6px;
    line-height: 1.45;
    }

    pre code {
    background: none;
    padding: 0;
    }

    blockquote {
    margin: 1.5em 0;
    padding-left: 1em;
    border-left: 4px solid #ddd;
    color: #555;
    }

    hr {
    border: none;
    border-top: 1px solid #e0e0e0;
    margin: 3em 0;
    }

    table {
    border-collapse: collapse;
    margin: 1.5em 0;
    width: 100%;
    font-size: 0.95em;
    }

    th, td {
    padding: 0.5em 0.7em;
    border-bottom: 1px solid #e5e5e5;
    text-align: left;
    }

    th {
    font-weight: 600;
    }

    img {
    max-width: 100%;
    display: block;
    margin: 1.5em auto;
    }

    small {
    color: #666;
    }

    mjx-container {
    margin: 1em 0;
    }

    ::selection {
    background: #cce2ff;
    }

    </style>
    

<script>
window.MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    processEscapes: true,
    tags: 'ams',
    packages: {'[+]': ['ams']}
  },
  options: {
    renderActions: {
      findScript: [10, function (doc) {
        for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
          const display = !!node.type.match(/; *mode=display/);
          const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
          const text = document.createTextNode('');
          node.parentNode.replaceChild(text, node);
          math.start = {node: text, delim: '', n: 0};
          math.end = {node: text, delim: '', n: 0};
          doc.math.push(math);
        }
      }, '']
    }
  },
  loader: {load: ['[tex]/ams']}
};
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<article>
    <nav style="margin-bottom: 1.5em;">
    <a href="../index.html" style="display: inline-flex; align-items: center; color: #555; text-decoration: none; font-size: 0.95em;">
        <span style="margin-right: 0.3em;">&larr;</span> Back to Index
    </a>
</nav>

    <h1><a href="https://kexue.fm/archives/4515">【The Incredible Word2Vec】6. Keras Version of Word2Vec</a></h1>
    
    <p>By 苏剑林 | August 06, 2017</p>

    <h2>Preface</h2>
    <p>After seeing the TF version of Word2Vec I wrote before, Yin Shen from the Keras group asked me if there was a Keras version. In fact, before making the TF version, I had written a Keras version, but I didn't keep it, so I rewrote it—it's more efficient, and the code looks better. This is a pure Keras implementation of Word2Vec. The principles are the same as in <a href="translation_4402.html">"【The Incredible Word2Vec】5. Tensorflow Version of Word2Vec"</a>. I'm releasing it now; I think someone will need it. (For example, adding extra inputs yourself to create a better word vector model?)</p>
    <p>Since Keras simultaneously supports multiple backends like TensorFlow, Theano, and CNTK, this is equivalent to implementing Word2Vec for multiple frameworks. Well, it sounds quite high-end when you think about it that way, haha~</p>

    <h2>Code</h2>
    <p><strong>GitHub:</strong> <a href="https://github.com/bojone/tf_word2vec/blob/master/word2vec_keras.py">https://github.com/bojone/tf_word2vec/blob/master/word2vec_keras.py</a></p>

<pre><code class="language-python"></code></pre>

    <h2>Key Points</h2>
    <p>Above is the code for the CBOW model; if you need Skip-Gram, please modify it yourself. Keras code is so simple that it is easy to modify.</p>
    <p>Looking through the code, you will find that the part for building the model takes less than 10 lines. In fact, writing the CBOW model is very simple; the only difficulty lies in implementing a sampled version of softmax (randomly selecting several targets for softmax instead of the full softmax) to improve efficiency. In Keras, this is implemented by manually writing the Dense layer rather than using the built-in Dense layer. The specific steps are: 1. Generate random integers via <code>random_uniform</code>, which serve as the negative sample IDs, and then concatenate them with the target input to form a sample; 2. Use an Embedding layer to store the weights of the softmax; 3. Extract the weights in the sample to form a small matrix, and then use the K backend for matrix multiplication, effectively implementing a sampled version of the Dense layer. Look over the code a few times and you will understand.</p>
    <p>Finally, in terms of running speed, it definitely cannot compete with the Gensim version or the original version of Word2Vec. Using Keras is mainly for its high flexibility—everyone should keep this in mind.</p>
</article>
<hr>
<footer style="margin-top: 3em; padding: 1.5em; background: #f5f5f5; border-radius: 8px; font-size: 0.9em; color: #555;">
    <p style="margin: 0 0 0.5em 0;"><strong>Citation</strong></p>
    <p style="margin: 0 0 0.5em 0;">
        This is a machine translation of the original Chinese article:<br>
        <a href="https://kexue.fm/archives/4515" style="color: #005fcc;">https://kexue.fm/archives/4515</a>
    </p>
    <p style="margin: 0 0 0.5em 0;">
        Original author: 苏剑林 (Su Jianlin)<br>
        Original publication: <a href="https://kexue.fm" style="color: #005fcc;">科学空间 (Scientific Spaces)</a>
    </p>
    <p style="margin: 0; font-style: italic;">
        Translated using Gemini 3 Flash. Please refer to the original for authoritative content.
    </p>
</footer>
