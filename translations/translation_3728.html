
    <style type="text/css">

    body {
    margin: 48px auto;
    max-width: 68ch;              /* character-based width reads better */
    padding: 0 16px;

    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                Roboto, "Helvetica Neue", Arial, sans-serif;
    font-size: 18px;
    line-height: 1.65;
    color: #333;
    background: #fafafa;
    }

    h1, h2, h3, h4 {
    line-height: 1.25;
    margin-top: 2.2em;
    margin-bottom: 0.6em;
    font-weight: 600;
    }

    h1 {
    font-size: 2.1em;
    margin-top: 0;
    }

    h2 {
    font-size: 1.6em;
    border-bottom: 1px solid #e5e5e5;
    padding-bottom: 0.3em;
    }

    h3 {
    font-size: 1.25em;
    }

    h4 {
    font-size: 1.05em;
    color: #555;
    }

    /* Paragraphs and lists */
    p {
    margin: 1em 0;
    }

    ul, ol {
    margin: 1em 0 1em 1.5em;
    }

    li {
    margin: 0.4em 0;
    }

    a {
    color: #005fcc;
    text-decoration: none;
    }

    a:hover {
    text-decoration: underline;
    }

    code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.95em;
    background: #f2f2f2;
    padding: 0.15em 0.35em;
    border-radius: 4px;
    }

    pre {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.9em;
    background: #f5f5f5;
    padding: 1em 1.2em;
    overflow-x: auto;
    border-radius: 6px;
    line-height: 1.45;
    }

    pre code {
    background: none;
    padding: 0;
    }

    blockquote {
    margin: 1.5em 0;
    padding-left: 1em;
    border-left: 4px solid #ddd;
    color: #555;
    }

    hr {
    border: none;
    border-top: 1px solid #e0e0e0;
    margin: 3em 0;
    }

    table {
    border-collapse: collapse;
    margin: 1.5em 0;
    width: 100%;
    font-size: 0.95em;
    }

    th, td {
    padding: 0.5em 0.7em;
    border-bottom: 1px solid #e5e5e5;
    text-align: left;
    }

    th {
    font-weight: 600;
    }

    img {
    max-width: 100%;
    display: block;
    margin: 1.5em auto;
    }

    small {
    color: #666;
    }

    mjx-container {
    margin: 1em 0;
    }

    ::selection {
    background: #cce2ff;
    }

    </style>
    

<script>
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']],
      processEscapes: true,
      tags: 'ams'
    }
  };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<nav style="margin-bottom: 1.5em;">
    <a href="../index.html" style="display: inline-flex; align-items: center; color: #555; text-decoration: none; font-size: 0.95em;">
        <span style="margin-right: 0.3em;">&larr;</span> Back to Index
    </a>
</nav>

<h1><a href="https://kexue.fm/archives/3728">[Memo] Using Raspberry Pi 3 as a Wireless Router</a></h1>

<p>By 苏剑林 | April 12, 2016</p>

<p>The Raspberry Pi 3, released in early March, comes with built-in Wi-Fi and Bluetooth. Combined with its existing Ethernet port, it has essentially become a wireless router. I couldn't resist getting one, intending to use it as both a router and a NAS. There are already many tutorials on using a Raspberry Pi as a router, though most are based on the Raspberry Pi 2. Versions prior to the 3 did not have built-in Wi-Fi, requiring an external wireless adapter. The Raspberry Pi 3 makes configuration much more convenient since Wi-Fi is integrated. I successfully configured it by referring to two foreign tutorials and am recording the process here.</p>

<p>Reference tutorials:<br />
<a href="https://frillip.com/using-your-raspberry-pi-3-as-a-wifi-access-point-with-hostapd/">https://frillip.com/using-your-raspberry-pi-3-as-a-wifi-access-point-with-hostapd/</a><br />
<a href="https://gist.github.com/Lewiscowles1986/fecd4de0b45b2029c390#file-rpi3-ap-setup-sh">https://gist.github.com/Lewiscowles1986/fecd4de0b45b2029c390#file-rpi3-ap-setup-sh</a></p>

<h3>Configuring the Wireless Hotspot</h3>

<p>The main software packages used are <code>hostapd</code> and <code>dnsmasq</code>:</p>

<pre><code></code></pre>

<p>Then, add the following to the end of <code>/etc/dnsmasq.conf</code> (modify the IP and network segment yourself; this file already exists with detailed configuration examples, but all lines are commented out with #):</p>

<blockquote>
  interface=wlan0<br />
  dhcp-range=10.0.0.2,10.0.0.5,255.255.255.0,12h
</blockquote>

<p>Next, create a new file <code>/etc/hostapd/hostapd.conf</code> and add:</p>

<blockquote>
  interface=wlan0<br />
  hw_mode=g<br />
  channel=10<br />
  auth_algs=1<br />
  wpa=2<br />
  wpa_key_mgmt=WPA-PSK<br />
  wpa_pairwise=CCMP<br />
  rsn_pairwise=CCMP<br />
  wpa_passphrase=wifi_password<br />
  ssid=wifi_name
</blockquote>

<p>Then modify <code>/etc/sysctl.conf</code> and change (if this line exists, just remove the #):</p>

<blockquote>
  net.ipv4.ip_forward=1
</blockquote>

<p>Finally, add the following script before <code>exit 0</code> in <code>/etc/rc.local</code>:</p>

<pre><code></code></pre>

<p>After rebooting, you should see the hotspot. It's much simpler! The Wi-Fi signal strength of the Raspberry Pi is similar to the once-famous WR703N router toy.</p>

<h3>Pitfalls and Solutions</h3>

<p>I also configured offline downloading, NAS, automatic cloud synchronization, and more. Being unfamiliar with Linux, I fell into many traps. I want to remind everyone that many commands on the Raspberry Pi require <code>sudo</code>, and <code>sudo</code> on the Raspberry Pi does not require a password. However, with and without <code>sudo</code> are two completely different environments (two different users). For example, after running <code>sudo screen -S sync</code>, you won't see it when running <code>screen -ls</code>; you must run <code>sudo screen -ls</code> to see it. Additionally, if you add commands to <code>/etc/rc.local</code>, they are executed as <code>sudo</code> by default (whether or not you include <code>sudo</code>). I added a <code>screen</code> task there and couldn't find it with <code>screen -ls</code> no matter what I tried, only to realize I needed <code>sudo screen -ls</code>... Also, when running <code>autossh</code> for intranet penetration, you must include a <code>sleep 5</code> command before <code>autossh</code>, otherwise <code>autossh</code> won't work even if it runs.</p>

<p>These were all pitfalls I spent a whole day jumping into.</p>
<hr>
<footer style="margin-top: 3em; padding: 1.5em; background: #f5f5f5; border-radius: 8px; font-size: 0.9em; color: #555;">
    <p style="margin: 0 0 0.5em 0;"><strong>Citation</strong></p>
    <p style="margin: 0 0 0.5em 0;">
        This is a machine translation of the original Chinese article:<br>
        <a href="https://kexue.fm/archives/3728" style="color: #005fcc;">https://kexue.fm/archives/3728</a>
    </p>
    <p style="margin: 0 0 0.5em 0;">
        Original author: 苏剑林 (Su Jianlin)<br>
        Original publication: <a href="https://kexue.fm" style="color: #005fcc;">科学空间 (Scientific Spaces)</a>
    </p>
    <p style="margin: 0; font-style: italic;">
        Translated using Gemini 3 Flash. Please refer to the original for authoritative content.
    </p>
</footer>
