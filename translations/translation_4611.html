
    <style type="text/css">

    body {
    margin: 48px auto;
    max-width: 68ch;              /* character-based width reads better */
    padding: 0 16px;

    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                Roboto, "Helvetica Neue", Arial, sans-serif;
    font-size: 18px;
    line-height: 1.65;
    color: #333;
    background: #fafafa;
    }

    h1, h2, h3, h4 {
    line-height: 1.25;
    margin-top: 2.2em;
    margin-bottom: 0.6em;
    font-weight: 600;
    }

    h1 {
    font-size: 2.1em;
    margin-top: 0;
    }

    h2 {
    font-size: 1.6em;
    border-bottom: 1px solid #e5e5e5;
    padding-bottom: 0.3em;
    }

    h3 {
    font-size: 1.25em;
    }

    h4 {
    font-size: 1.05em;
    color: #555;
    }

    /* Paragraphs and lists */
    p {
    margin: 1em 0;
    }

    ul, ol {
    margin: 1em 0 1em 1.5em;
    }

    li {
    margin: 0.4em 0;
    }

    a {
    color: #005fcc;
    text-decoration: none;
    }

    a:hover {
    text-decoration: underline;
    }

    code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.95em;
    background: #f2f2f2;
    padding: 0.15em 0.35em;
    border-radius: 4px;
    }

    pre {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.9em;
    background: #f5f5f5;
    padding: 1em 1.2em;
    overflow-x: auto;
    border-radius: 6px;
    line-height: 1.45;
    }

    pre code {
    background: none;
    padding: 0;
    }

    blockquote {
    margin: 1.5em 0;
    padding-left: 1em;
    border-left: 4px solid #ddd;
    color: #555;
    }

    hr {
    border: none;
    border-top: 1px solid #e0e0e0;
    margin: 3em 0;
    }

    table {
    border-collapse: collapse;
    margin: 1.5em 0;
    width: 100%;
    font-size: 0.95em;
    }

    th, td {
    padding: 0.5em 0.7em;
    border-bottom: 1px solid #e5e5e5;
    text-align: left;
    }

    th {
    font-weight: 600;
    }

    img {
    max-width: 100%;
    display: block;
    margin: 1.5em auto;
    }

    small {
    color: #666;
    }

    mjx-container {
    margin: 1em 0;
    }

    ::selection {
    background: #cce2ff;
    }

    </style>
    

<script>
window.MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    tags: 'ams',
    macros: {
      bm: ["\\boldsymbol{#1}", 1]
    }
  }
};
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<h1><a href="https://kexue.fm/archives/4611">Image Classification Based on Fine-Tuning (Baidu Dog Classification Competition)</a></h1>

<p>By 苏剑林 | October 13, 2017</p>

<p>In the past two years, Baidu's Big Data competitions were focused on natural language processing. This year, the style changed significantly to fine-grained image classification. The task of the competition was to classify pet dogs into one of 100 categories. This task itself is quite standard, and the approach is conventional, involving three aspects: data augmentation, fine-tuning ImageNet models, and model ensemble. I am not particularly good at model ensemble, so I only performed the first two steps. My results were average (accuracy around 80%), but I feel that some of the code might be helpful to readers, so I am sharing it here. Below is an explanation combined with the code.</p>

<p>Competition official website (may become invalid at any time): <a href="http://js.baidu.com">http://js.baidu.com</a></p>

<h2 id="模型">Model</h2>

<p>The model is mainly implemented using TensorFlow and Keras. First, of course, is importing various modules:</p>

<pre><code class="language-python"># [Code block for importing modules]
</code></pre>

<p>Next is the model. The base model is Xception, followed by the use of the GLU (Gated Linear Unit) activation function to compress features, and finally a Softmax layer for classification. Additionally, Center Loss and auxiliary loss (direct skip connections) were added as auxiliary components; these two terms can be viewed as regularization terms.</p>

<pre><code class="language-python"># [Code block for model definition]
</code></pre>

<p>Regarding the training strategy, training is divided into three steps:</p>

<blockquote>
    1. Freeze all parameters of Xception and train only the additionally added fully connected layers and the Center Loss part using the Adam optimizer;<br>
    2. Unfreeze two blocks of Xception and switch to SGD for fine-tuning;<br>
    3. Remove most of the data augmentation and continue fine-tuning with SGD.
</blockquote>

<p>The code is as follows:</p>

<pre><code class="language-python"># [Code block for training strategies]
</code></pre>

<h2 id="扩增">Augmentation</h2>

<p>Next is the data preparation for this competition. The official organizers eventually provided 18,000 training images.</p>

<pre><code class="language-python"># [Code block for data preparation]
</code></pre>

<p>Following this are some data augmentation codes, written by hand without using any existing libraries. The advantage is high customizability. Of course, it is uncertain whether every single one of these data augmentation methods provides an improvement for the problem.</p>

<pre><code class="language-python"># [Code block for data augmentation]
</code></pre>

<h2 id="迭代器">Iterator</h2>

<p>We write an iterator to generate batches of training and test data:</p>

<pre><code class="language-python"># [Code block for iterator implementation]
</code></pre>

<h2 id="训练">Training</h2>

<p>First, we train the model, then use the model to make predictions. Next, we mix the prediction results with the training set to train together, then obtain new prediction results, which can be iteratively mixed and trained again. This is a transfer learning idea (pseudo-labeling) that can improve performance by about 0.5% to 1%.</p>

<p>Additionally, since the model has two predictions—one predicted using the GLU features and one predicted directly using the Xception features—we can perform a weighted average of the two prediction results to improve performance. The weights are determined by the validation set.</p>

<pre><code class="language-python"># [Code block for training and prediction process]
</code></pre>

<h2 id="总结">Summary</h2>

<p>Although this article is quite long, most of it consists of code. From the perspective of effectiveness, it serves as a baseline, provided only for beginners to learn. Experts are welcome to leave comments and provide guidance. Thank you.</p>

<p>Complete code can be found at: <a href="https://github.com/bojone/baidu_dog_classifier">https://github.com/bojone/baidu_dog_classifier</a></p>
<hr>
<footer style="margin-top: 3em; padding: 1.5em; background: #f5f5f5; border-radius: 8px; font-size: 0.9em; color: #555;">
    <p style="margin: 0 0 0.5em 0;"><strong>Citation</strong></p>
    <p style="margin: 0 0 0.5em 0;">
        This is a machine translation of the original Chinese article:<br>
        <a href="https://kexue.fm/archives/4611" style="color: #005fcc;">https://kexue.fm/archives/4611</a>
    </p>
    <p style="margin: 0 0 0.5em 0;">
        Original author: 苏剑林 (Su Jianlin)<br>
        Original publication: <a href="https://kexue.fm" style="color: #005fcc;">科学空间 (Scientific Spaces)</a>
    </p>
    <p style="margin: 0; font-style: italic;">
        Translated using Gemini 3 Flash. Please refer to the original for authoritative content.
    </p>
</footer>
