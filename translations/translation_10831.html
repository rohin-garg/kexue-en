
    <style type="text/css">

    body {
    margin: 48px auto;
    max-width: 68ch;              /* character-based width reads better */
    padding: 0 16px;

    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                Roboto, "Helvetica Neue", Arial, sans-serif;
    font-size: 18px;
    line-height: 1.65;
    color: #333;
    background: #fafafa;
    }

    h1, h2, h3, h4 {
    line-height: 1.25;
    margin-top: 2.2em;
    margin-bottom: 0.6em;
    font-weight: 600;
    }

    h1 {
    font-size: 2.1em;
    margin-top: 0;
    }

    h2 {
    font-size: 1.6em;
    border-bottom: 1px solid #e5e5e5;
    padding-bottom: 0.3em;
    }

    h3 {
    font-size: 1.25em;
    }

    h4 {
    font-size: 1.05em;
    color: #555;
    }

    /* Paragraphs and lists */
    p {
    margin: 1em 0;
    }

    ul, ol {
    margin: 1em 0 1em 1.5em;
    }

    li {
    margin: 0.4em 0;
    }

    a {
    color: #005fcc;
    text-decoration: none;
    }

    a:hover {
    text-decoration: underline;
    }

    code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.95em;
    background: #f2f2f2;
    padding: 0.15em 0.35em;
    border-radius: 4px;
    }

    pre {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.9em;
    background: #f5f5f5;
    padding: 1em 1.2em;
    overflow-x: auto;
    border-radius: 6px;
    line-height: 1.45;
    }

    pre code {
    background: none;
    padding: 0;
    }

    blockquote {
    margin: 1.5em 0;
    padding-left: 1em;
    border-left: 4px solid #ddd;
    color: #555;
    }

    hr {
    border: none;
    border-top: 1px solid #e0e0e0;
    margin: 3em 0;
    }

    table {
    border-collapse: collapse;
    margin: 1.5em 0;
    width: 100%;
    font-size: 0.95em;
    }

    th, td {
    padding: 0.5em 0.7em;
    border-bottom: 1px solid #e5e5e5;
    text-align: left;
    }

    th {
    font-weight: 600;
    }

    img {
    max-width: 100%;
    display: block;
    margin: 1.5em auto;
    }

    small {
    color: #666;
    }

    mjx-container {
    margin: 1em 0;
    }

    ::selection {
    background: #cce2ff;
    }

    </style>
    

<script>
window.MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    tags: 'ams',
    packages: {'[+]': ['ams']}
  },
  options: {
    renderActions: {
      findScript: [10, function (doc) {
        for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
          const display = !!node.type.match(/; *mode=display/);
          const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
          const text = document.createTextNode('');
          node.parentNode.replaceChild(text, node);
          math.start = {node: text, delim: '', n: 0};
          math.end = {node: text, delim: '', n: 0};
          doc.math.push(math);
        }
      }, '']
    }
  }
};
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

<article>
<h1><a href="https://kexue.fm/archives/10831">Finding a Substitute for Normalization via Gradient Approximation</a></h1>

<p>By 苏剑林 | April 02, 2025</p>

<p>I wonder if everyone noticed the paper <a href="https://papers.cool/arxiv/2503.10622">《Transformers without Normalization》</a> that came out recently? This paper attempts to replace the Normalization layers in Transformer models with an element-wise operation called DyT, aiming to improve speed while maintaining performance. The theme of fundamental architecture itself carries a certain level of attraction, and with the names of big names like Kaiming He and Yann LeCun attached, the paper caused quite a stir when it was released, receiving both praise and criticism.</p>

<p>Coincidentally, a new paper last week titled <a href="https://papers.cool/arxiv/2503.21708">《The Mathematical Relationship Between Layer Normalization and Dynamic Activation Functions》</a> interpreted DyT from the perspective of gradient analysis and differential equations, and proposed new alternatives. Personally, I feel this perspective is very fundamental, so I have studied it and would like to share it here.</p>

<h2>Write at the Front</h2>

<p>DyT stands for Dynamic Tanh, which replaces the Normalization layer with the following operation:</p>

\begin{equation}\mathop{\text{DyT}}(\boldsymbol{x}) = \boldsymbol{\gamma} \odot \tanh(\alpha \boldsymbol{x}) + \boldsymbol{\beta}\end{equation}

<p>Where $\alpha, \boldsymbol{\beta}, \boldsymbol{\gamma}$ are all learnable parameters. Since $\boldsymbol{\beta}$ and $\boldsymbol{\gamma}$ are already part of the standard Normalization layer, the key here is using $\tanh(\alpha \boldsymbol{x})$ to replace the Normalize operation. $\tanh$ is an element-wise operation, which eliminates the calculation of the two statistics: mean and variance.</p>

<p>Regarding DyT, I previously expressed some views on Zhihu in the thread <a href="https://www.zhihu.com/question/14925347536/answer/124434065689">"How to evaluate Meta's new paper Transformers without Normalization?"</a>. Simply put, I am not very optimistic. The reason is that Normalization mindlessly stabilizes the model's forward propagation, leaving more degrees of freedom and possibilities for other aspects of the model (such as performance). Therefore, I do not believe that a universal operation simplified further than Normalization can achieve better results (No Free Lunch).</p>

<p>In fact, as far back as 2021 in <a href="https://kexue.fm/archives/8620#%E6%AE%8B%E5%B7%AE%E8%BF%9E%E6%8E%A5">"Brief Discussion on Initialization, Parameterization and Standardization of Transformers"</a>, we discussed the topic of removing Normalization. Related works include <a href="https://papers.cool/arxiv/2002.10444">SkipInit</a>, <a href="https://papers.cool/arxiv/2003.04887">ReZero</a>, and <a href="https://papers.cool/arxiv/1901.09321">Fixup</a>. At that time, I tried some schemes and found that even if they could match Normalization in some respects, they would still have deficiencies in others—for example, pre-training results were okay, but fine-tuning performance was poor—so I didn't pursue it further.</p>

<p>Therefore, I now view similar works only as limit explorations in the dimension of simplification, much like <a href="https://papers.cool/arxiv/2410.01131">"nGPT: Normalized Transformer with Representation Learning on the Hypersphere"</a>, which adds Normalization almost everywhere it can be added. They all belong to limit explorations in a certain direction.</p>

<h2>Gradient Calculation</h2>

<p>Of course, just because I am not optimistic doesn't mean we can't learn and analyze. To find a substitute or approximation for Normalization, the most direct approach is to start with the gradient. After all, deep learning boils down to forward and backward propagation, and backward propagation is all about calculating gradients, which often plays a more fundamental role.</p>

<p>Next, let's only consider RMS Norm. Its key operation is:</p>

\begin{equation}\boldsymbol{y} = \frac{\boldsymbol{x}}{\Vert\boldsymbol{x}\Vert_{RMS}} = \sqrt{d}\times \frac{\boldsymbol{x}}{\Vert\boldsymbol{x}\Vert}\label{eq:rms-norm}\end{equation}

<p>Where $\boldsymbol{x}\in\mathbb{R}^d$, and</p>

\begin{equation}\Vert\boldsymbol{x}\Vert_{RMS} = \frac{\Vert\boldsymbol{x}\Vert}{\sqrt{d}},\qquad \Vert\boldsymbol{x}\Vert = \sqrt{\boldsymbol{x}^2} = \sqrt{\sum_{i=1}^d x_i^2}\end{equation}

<p>So, calculating the gradient of $\boldsymbol{x} / \Vert\boldsymbol{x}\Vert_{RMS}$ is equivalent to calculating the gradient of $\boldsymbol{x} / \Vert\boldsymbol{x}\Vert$, which we can compute in the following way:</p>

\begin{equation}\frac{\boldsymbol{x}+\Delta\boldsymbol{x}}{\Vert\boldsymbol{x}+\Delta\boldsymbol{x}\Vert} = \frac{\boldsymbol{x}}{\Vert\boldsymbol{x}+\Delta\boldsymbol{x}\Vert} + \frac{\Delta\boldsymbol{x}}{\Vert\boldsymbol{x}+\Delta\boldsymbol{x}\Vert} \approx \frac{\boldsymbol{x}}{\Vert\boldsymbol{x}+\Delta\boldsymbol{x}\Vert} + \frac{\Delta\boldsymbol{x}}{\Vert\boldsymbol{x}\Vert}\label{eq:exp-1}\end{equation}

<p>The complicated part is expanding $\Vert\boldsymbol{x}+\Delta\boldsymbol{x}\Vert = \sqrt{(\boldsymbol{x}+\Delta\boldsymbol{x})^2}$:</p>

\begin{equation}\begin{aligned}
&\,\sqrt{(\boldsymbol{x}+\Delta\boldsymbol{x})^2} \\
\approx&\, \sqrt{\Vert\boldsymbol{x}\Vert^2+2\boldsymbol{x}\cdot\Delta\boldsymbol{x}} \\
=&\, \Vert\boldsymbol{x}\Vert\sqrt{1+2\boldsymbol{x}\cdot\Delta\boldsymbol{x}/\Vert\boldsymbol{x}\Vert^2} \\
=&\, \Vert\boldsymbol{x}\Vert (1+\boldsymbol{x}\cdot\Delta\boldsymbol{x}/\Vert\boldsymbol{x}\Vert^2)
\end{aligned} \quad \Rightarrow \quad
\begin{aligned}
\frac{\boldsymbol{x}}{\Vert\boldsymbol{x}+\Delta\boldsymbol{x}\Vert} \approx&\, \frac{\boldsymbol{x}}{\Vert\boldsymbol{x}\Vert}(1-\boldsymbol{x}\cdot\Delta\boldsymbol{x}/\Vert\boldsymbol{x}\Vert^2)
\end{aligned}\end{equation}

<p>Substituting into Equation $\eqref{eq:exp-1}$: </p>

\begin{equation}\frac{\boldsymbol{x}+\Delta\boldsymbol{x}}{\Vert\boldsymbol{x}+\Delta\boldsymbol{x}\Vert} - \frac{\boldsymbol{x}}{\Vert\boldsymbol{x}\Vert} \approx \frac{\Delta\boldsymbol{x}}{\Vert\boldsymbol{x}\Vert} - \frac{(\boldsymbol{x}\cdot\Delta\boldsymbol{x})\boldsymbol{x}}{\Vert\boldsymbol{x}\Vert^3}\quad\Rightarrow\quad\nabla_{\boldsymbol{x}} \frac{\boldsymbol{x}}{\Vert\boldsymbol{x}\Vert} = \frac{\boldsymbol{I}}{\Vert\boldsymbol{x}\Vert} - \frac{\boldsymbol{x}\boldsymbol{x}^{\top}}{\Vert\boldsymbol{x}\Vert^3}\end{equation}

<p>Finally, substituting back into Equation $\eqref{eq:rms-norm}$ yields:</p>

\begin{equation}\nabla_{\boldsymbol{x}} \boldsymbol{y} = \sqrt{d}\left(\frac{\boldsymbol{I}}{\Vert\boldsymbol{x}\Vert} - \frac{\boldsymbol{x}\boldsymbol{x}^{\top}}{\Vert\boldsymbol{x}\Vert^3}\right) = \frac{1}{\Vert\boldsymbol{x}\Vert_{RMS}}\left(\boldsymbol{I} - \frac{\boldsymbol{y}\boldsymbol{y}^{\top}}{d}\right)\label{eq:rms-norm-grad}\end{equation}

<h2>DyT Appears!</h2>

<p>Note that both $\boldsymbol{x}$ and $\boldsymbol{y}$ are vectors, so $\nabla_{\boldsymbol{x}} \boldsymbol{y}$ is a matrix (the Jacobian matrix). Now we search for an element-wise approximation for RMS Norm, meaning each component is operated on independently:</p>

\begin{equation}f(\boldsymbol{x}) = [f(x_1),f(x_2),\cdots,f(x_d)]\end{equation}

<p>This independence means its Jacobian matrix must be a diagonal matrix! We want this approximation to preserve the gradient of RMS Norm as much as possible, so we consider preserving only the diagonal part of Equation $\eqref{eq:rms-norm-grad}$:</p>

\begin{equation}\frac{dy_i}{dx_i} = \frac{1}{\Vert\boldsymbol{x}\Vert_{RMS}}\left(1 - \frac{y_i^2}{d}\right)\label{eq:ode-1}\end{equation}

<p>If we further assume that $\rho = \Vert\boldsymbol{x}\Vert_{RMS}$ is a constant, then we can directly solve the above differential equation to obtain:</p>

\begin{equation}y_i = \sqrt{d}\tanh\left(\frac{x_i}{\rho\sqrt{d}}\right)\end{equation}

<p>In this way, we obtain the "T" in DyT ($\tanh$), where the initial condition $y_i(0)=0$ was selected during the solution process.</p>

<p>DyT essentially absorbs the previous $\sqrt{d}$ into the $\boldsymbol{\gamma}$ parameter and treats the term $\frac{1}{\rho\sqrt{d}}$ inside the parentheses as the training parameter $\alpha$, which alleviates the limitation caused by the assumption that "$\rho = \Vert\boldsymbol{x}\Vert_{RMS}$ is a constant". However, from my perspective, explicitly retaining $\sqrt{d}$ might be more valuable, as long as the $\frac{1}{\rho}$ part is treated as a trainable parameter.</p>

<h2>DyISRU</h2>

<p>I wonder if you noticed that for RMS Norm, we consistently have $y_i = x_i / \Vert\boldsymbol{x}\Vert_{RMS}$, so we can replace $\Vert\boldsymbol{x}\Vert_{RMS}$ in Equation $\eqref{eq:ode-1}$ with $x_i/y_i$, thus obtaining:</p>

\begin{equation}\frac{dy_i}{dx_i} = \frac{y_i}{x_i}\left(1 - \frac{y_i^2}{d}\right)\label{eq:ode-2}\end{equation}

<p>This is an equation containing only $x_i$ and $y_i$, eliminating the need for an approximate treatment of $\Vert\boldsymbol{x}\Vert_{RMS}$. Solving this equation gives:</p>

\begin{equation}y_i = \frac{\sqrt{d}x_i}{\sqrt{x_i^2 + C}}\end{equation}

<p>Where $C$ is an arbitrary constant. This form is known as ISRU (Inverse Square Root Unit, which we previously called <a href="https://kexue.fm/archives/10563#SoftSign">SoftSign</a>), originating from the paper <a href="https://papers.cool/arxiv/1710.09967">《Improving Deep Learning by Inverse Square Root Linear Units (ISRLUs)》</a>. If $C$ is treated as a trainable parameter, it can be called DyISRU (Dynamic ISRU) by analogy with DyT.</p>

<p>Looking at the path from gradient $\eqref{eq:rms-norm-grad}$ to equation $\eqref{eq:ode-1}$ and then to $\eqref{eq:ode-2}$, DyISRU is the best result we can achieve using an element-wise function, because no additional approximations were made besides the diagonal assumption. Formally, DyISRU is actually more intuitive than DyT because $\Vert\boldsymbol{x}\Vert_{RMS}^2$ is $\mathbb{E}[x_i^2]$. Since we are seeking an element-wise operation, we are forced to replace $\mathbb{E}[x_i^2]$ with $x_i^2$. Adding $C$ and multiplying by $\sqrt{d}$ are smoothing operations:</p>

\begin{equation}\frac{x_i}{\sqrt{\color{red}{\frac{1}{d}\sum\limits_{i=1}^d x_i^2}}}\quad\to\quad \frac{x_i}{\sqrt{\color{green}{x_i^2}}}\quad\to\quad \frac{\color{orange}{\sqrt{d}} x_i}{\sqrt{\color{green}{x_i^2} + \color{orange}{C}}}\end{equation}

<h2>Related Work</h2>

<p>Both $\tanh$ and ISRU can be viewed as smooth approximations of the sign function. Based on them, we can construct smooth approximations of the $\mathop{\text{clip}}$ operation, for example:</p>

\begin{equation}\mathop{\text{clip}}(x, -t, t) = \left\{
\begin{aligned}t,&\,\,\, x > t \\ x,&\,\,\, x\in[-t,t] \\ -t,&\,\,\, x < -t\end{aligned}
\right.\quad\approx\quad t\tanh\left(\frac{x}{t}\right)\triangleq \mathop{\text{softcap}}(x, t)\end{equation}

<p>From this, we can also understand DyT as introducing a (smooth) $\mathop{\text{clip}}$ operation to prevent the explosion of forward propagation, thereby stabilizing the model.</p>

<p>$\mathop{\text{softcap}}$ was proposed by Google in <a href="https://papers.cool/arxiv/2408.00118">Gemma 2</a>. Its purpose at the time was to be applied to the Attention Logits matrix before the Softmax to prevent excessively large Logits values. However, in our actual tests, we found that although the Logits after $\mathop{\text{softcap}}$ do not explode, the Logits before $\mathop{\text{softcap}}$ still face the risk of explosion. Therefore, using $\mathop{\text{softcap}}$ to prevent Logits explosion merely shifts the problem to another source; it treats the symptoms but not the root cause.</p>

<p>It's unclear whether Google later realized this issue as well, but in their latest <a href="https://papers.cool/arxiv/2503.19786">Gemma 3</a>, they chose to remove $\mathop{\text{softcap}}$ and use <a href="translation_9859.html">QK-norm</a> instead. Our own experiments also show that QK-norm can better suppress the growth of Attention Logits. This change and conclusion actually indirectly convey a pessimistic signal: operations like DyT's $\mathop{\text{softcap}}$ are difficult to use as a full replacement for Normalization in practice.</p>

<h2>Summary</h2>

<p>This article analyzes what kind of element-wise activation functions can (to some extent) replace Normalization layers from the perspective of gradient approximation. From this, we can derive DyT as well as new results.</p>
</article>
<hr>
<footer style="margin-top: 3em; padding: 1.5em; background: #f5f5f5; border-radius: 8px; font-size: 0.9em; color: #555;">
    <p style="margin: 0 0 0.5em 0;"><strong>Citation</strong></p>
    <p style="margin: 0 0 0.5em 0;">
        This is a machine translation of the original Chinese article:<br>
        <a href="https://kexue.fm/archives/10831" style="color: #005fcc;">https://kexue.fm/archives/10831</a>
    </p>
    <p style="margin: 0 0 0.5em 0;">
        Original author: 苏剑林 (Su Jianlin)<br>
        Original publication: <a href="https://kexue.fm" style="color: #005fcc;">科学空间 (Scientific Spaces)</a>
    </p>
    <p style="margin: 0; font-style: italic;">
        Translated using Gemini 3 Flash. Please refer to the original for authoritative content.
    </p>
</footer>
