
    <style type="text/css">

    body {
    margin: 48px auto;
    max-width: 68ch;              /* character-based width reads better */
    padding: 0 16px;

    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                Roboto, "Helvetica Neue", Arial, sans-serif;
    font-size: 18px;
    line-height: 1.65;
    color: #333;
    background: #fafafa;
    }

    h1, h2, h3, h4 {
    line-height: 1.25;
    margin-top: 2.2em;
    margin-bottom: 0.6em;
    font-weight: 600;
    }

    h1 {
    font-size: 2.1em;
    margin-top: 0;
    }

    h2 {
    font-size: 1.6em;
    border-bottom: 1px solid #e5e5e5;
    padding-bottom: 0.3em;
    }

    h3 {
    font-size: 1.25em;
    }

    h4 {
    font-size: 1.05em;
    color: #555;
    }

    /* Paragraphs and lists */
    p {
    margin: 1em 0;
    }

    ul, ol {
    margin: 1em 0 1em 1.5em;
    }

    li {
    margin: 0.4em 0;
    }

    a {
    color: #005fcc;
    text-decoration: none;
    }

    a:hover {
    text-decoration: underline;
    }

    code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.95em;
    background: #f2f2f2;
    padding: 0.15em 0.35em;
    border-radius: 4px;
    }

    pre {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.9em;
    background: #f5f5f5;
    padding: 1em 1.2em;
    overflow-x: auto;
    border-radius: 6px;
    line-height: 1.45;
    }

    pre code {
    background: none;
    padding: 0;
    }

    blockquote {
    margin: 1.5em 0;
    padding-left: 1em;
    border-left: 4px solid #ddd;
    color: #555;
    }

    hr {
    border: none;
    border-top: 1px solid #e0e0e0;
    margin: 3em 0;
    }

    table {
    border-collapse: collapse;
    margin: 1.5em 0;
    width: 100%;
    font-size: 0.95em;
    }

    th, td {
    padding: 0.5em 0.7em;
    border-bottom: 1px solid #e5e5e5;
    text-align: left;
    }

    th {
    font-weight: 600;
    }

    img {
    max-width: 100%;
    display: block;
    margin: 1.5em auto;
    }

    small {
    color: #666;
    }

    mjx-container {
    margin: 1em 0;
    }

    ::selection {
    background: #cce2ff;
    }

    </style>
    

<script>
window.MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    tags: 'ams',
    packages: {'[+]': ['ams']}
  },
  options: {
    renderActions: {
      findScript: [10, function (doc) {
        for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
          const display = !!node.type.match(/; *mode=display/);
          const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
          const text = document.createTextNode('');
          node.parentNode.replaceChild(text, node);
          math.start = {node: text, delim: '', n: 0};
          math.end = {node: text, delim: '', n: 0};
          doc.math.push(math);
        }
      }, '']
    }
  }
};
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

<h1><a href="https://kexue.fm/archives/3696">An Implicit Solution to a Nonlinear Difference Equation</a></h1>

    <p>By 苏剑林 | April 09, 2016</p>


<h3>Problem Source</h3>
<p>A thread on the Mathematics Research Forum, which I frequent, discussed the asymptotic solution for the following nonlinear difference equation:</p>
$$a_{n+1}=a_n+\frac{1}{a_n^2},\, a_1=1$$
<p>The original post is <a href="http://bbs.emath.ac.cn/thread-5290-1-1.html">here</a>. I benefited a lot from that thread and learned many new techniques. The main idea is through cubing both sides and then setting $x_n=a_n^3$, transforming it into an equivalent recurrence problem:</p>
$$x_{n+1}=x_n+3+\frac{3}{x_n}+\frac{1}{x_n^2},\,x_1=1$$
<p>Then, by using clever techniques, the asymptotic expansion can be obtained:</p>
$$x_n = 3n+\ln n+a+\frac{\frac{1}{3}(\ln n+a)-\frac{5}{18}}{n}+\dots$$
<p>I will not mention the specific process here; readers can go to the aforementioned post to learn on their own. However, although this form of the solution is exquisite, there are some aspects that I am not entirely satisfied with:</p>
<p>1. The solution is an asymptotic series, which means the radius of convergence is actually 0;<br>
2. It is a solution in the form of $n^{-k}$, which makes it difficult to calculate for small $n$, making high-precision calculation relatively difficult;<br>
3. Of course, the original purpose of the problem was asymptotic calculation, but there seems to be no need for the asymptotic analysis to expand into so many terms;<br>
4. It contains a limit value $a$ that is inherently difficult to calculate;<br>
5. The solving process seems slightly unintuitive.</p>
<p>Of course, some of the above shortcomings are a bit like nitpicking. However, it is precisely these shortcomings that prompted me to look for a better form of the solution, which eventually led to this article.</p>

<h3>Implicit Solution</h3>
<p>The recurrence</p>
$$x_{n+1}=x_n+3+\frac{3}{x_n}+\frac{1}{x_n^2},\,x_1=1$$
<p>The first-level asymptotic solution is obtained by omitting the subsequent $\frac{3}{x_n}+\frac{1}{x_n^2}$, yielding $x_{n+1}=x_n+3$, so $x_n=3n-2$. There are many subsequent ideas, such as iteration or undetermined coefficients, which can all find the asymptotic solution, but I tried another path: finding an implicit solution. First, we consider:</p>
$$x_{n+1}+f(x_{n+1})=x_n+3+\frac{3}{x_n}+\frac{1}{x_n^2}+f\left(x_n+3+\frac{3}{x_n}+\frac{1}{x_n^2}\right)$$
<p>Expanding the last term at $x_n$ to the first order:</p>
$$x_{n+1}+f(x_{n+1})=x_n+3+\frac{3}{x_n}+\frac{1}{x_n^2}+f(x_n)+f'(x_n)\left(3+\frac{3}{x_n}+\frac{1}{x_n^2}\right)$$
<p>Taking $1/x_n$ as the order and omitting second-order terms, we get</p>
$$x_{n+1}+f(x_{n+1})=x_n+f(x_n)+3+3\left[\frac{1}{x_n}+f'(x_n)\right]$$
<p>If we let $f(x_n)=-\ln x_n$, then the square bracket becomes 0, so we obtain</p>
$$x_{n+1}-\ln x_{n+1}=x_n-\ln x_n+3$$
<p>The accuracy of this equality is $\mathcal{O}(x_n^{-2})$. To balance simplicity and accuracy, it is better to start from $x_2=8$, so</p>
$$x_n - \ln x_n = 3(n-2)+8-\ln 8$$
<p>This is an implicit (approximate) solution with an accuracy of $\mathcal{O}(x_n^{-1})$. It maintains almost the same accuracy for nearly all $n$. The key here is to introduce a new term so that it becomes a linear recurrence (an arithmetic progression). This process can continue. Based on the previous work, by introducing a new function and continuing to expand it to the second order, we calculate:</p>
$$x_{n+1}-\ln x_{n+1}+\frac{5}{6x_{n+1}}=x_n-\ln x_n+\frac{5}{6x_n}+3$$
<p>It has $\mathcal{O}(x_n^{-3})$ accuracy, from which an implicit solution with $\mathcal{O}(x_n^{-2})$ accuracy can be solved.</p>

<h3>Why Implicit Solution?</h3>
<p>Why look for implicit solutions? There are roughly the following advantages. Under normal circumstances, traditional asymptotic solutions are obtained through Taylor series expansions. Taylor series expansions themselves have limitations (requiring differentiability and finite derivatives), so asymptotic solutions tend to appear; even if they are not asymptotic, the radius of convergence may be small. Implicit function solutions, generally speaking, are more stable and have better convergence. Although they may still be asymptotic, the divergence rate will be much lower. For example, $x=\sqrt{1+t}$, expanded as a power series, has a radius of convergence of only 1, but it can be expressed in the implicit function form $x^2-1=t$, maintaining both accuracy and simplicity.</p>
<p>In short, if an explicit expansion can do it, an implicit function can basically do it too; and for things an explicit expansion cannot do, an implicit function might still succeed. Therefore, implicit functions clearly perform better. In addition, for the recurrence in this article, the implicit function solution is more concise and does not involve the difficult-to-calculate $a$ everywhere. Readers may feel that solving a nonlinear equation every time $x_n$ is needed is complicated. In fact, if one wishes, the explicit solution can be obtained from the implicit solution directly through the inverse function, but this returns to asymptotic series and is not very necessary.</p>

<h3>Recurrence Format Conducive to Programming</h3>
<p>The two terms calculated earlier were just an introductory demonstration. Since the order was not high, the calculation was not difficult. However, to calculate further, especially for programming purposes, it is necessary to construct a recursive format that is easy to understand, much like the recursive calculation of the perturbation method. Suppose the introduced $f(x_n)$ is exact, then clearly, for an exact $f(x)$, it must satisfy:</p>
$$\frac{3}{x}+\frac{1}{x^2}+f\left(x+3+\frac{3}{x}+\frac{1}{x^2}\right)-f(x)=0$$
<p>At this time, the original recurrence becomes</p>
$$x_{n+1}+f(x_{n+1})=x_{n}+f(x_{n})+3$$
<p>Solving becomes much easier. After analysis, a parameter $q$ can be artificially introduced, and $f(x)$ can be treated as a binary function $f(x,q)$ of $x$ and $q$. After solving for the series solution of $f(x,q)$, we let $q=1$ to get $f(x)=f(x,1)$. The introduced format is as follows:</p>
$$\frac{3q}{x}+\frac{q^2}{x^2}+f\left(x+3q+\frac{3q^2}{x}+\frac{q^3}{x^2},q\right)-f(x,q)=0$$
<p>The idea behind this introduction is: take $x^{-1}$ as the infinitesimal order and let $f^{(n)}(x)$ also have the order of $x^{-n}$. Therefore, inside $f()$, $x^{-n} \to q^{n+1}x^{-n}$, and outside $f()$, there is $x^{-n} \to q^n x^{-n}$. At this time, software like Mathematica can be used to expand it quickly:</p>
<pre><code>Series[f[x + 3*q + 3*q^2/x + q^3/x^2, q] - f[x, q] + 3*q/x + q^2/x^2, {q, 0, 5}]</code></pre>
<p>The result is:</p>
\begin{aligned}&q \left(3 f^{(1,0)}(x,0)+\frac{3}{x}\right)\\ 
+&q^2 \left(\frac{3 f^{(1,0)}(x,0)}{x}+3 f^{(1,1)}(x,0)+\frac{9}{2} f^{(2,0)}(x,0)+\frac{1}{x^2}\right)\\ 
+&q^3 \left(\frac{f^{(1,0)}(x,0)}{x^2}+\frac{3 f^{(1,1)}(x,0)}{x}+\frac{3}{2} f^{(1,2)}(x,0)\right.\\ 
&\qquad\qquad\left.+\frac{9 f^{(2,0)}(x,0)}{x}+\frac{9}{2} f^{(2,1)}(x,0)+\frac{9}{2} f^{(3,0)}(x,0)\right)\\ 
+&\dots 
\end{aligned}
<p>Setting the coefficients of each order of $q$ to 0, we solve successively:</p>
\begin{aligned}&f^{(0,0)}(x,0)=-\ln x\\ 
&f^{(0,1)}(x,0)=\frac{5}{6x}\\ 
&f^{(0,2)}(x,0)=\frac{4}{3 x^2}\\ 
&\dots 
\end{aligned}
<p>Therefore,</p>
$$f(x)=f(x,1)=-\ln x+\frac{5}{6x}+\frac{2}{3 x^2}+\dots$$
<p>That is,</p>
\begin{aligned}&x_{n+1}-\ln x_{n+1}+\frac{5}{6x_{n+1}}+\frac{2}{3 x_{n+1}^2}\\ 
=&x_{n}-\ln x_{n}+\frac{5}{6x_{n}}+\frac{2}{3 x_{n}^2}+3\end{aligned}
<p>resulting in</p>
\begin{aligned}&x_{n}-\ln x_{n}+\frac{5}{6x_{n}}+\frac{2}{3 x_{n}^2}\\ 
=&3(n-2)+8-\ln 8+\frac{5}{6\times 8}+\frac{2}{3\times 8^2}\end{aligned}
<p>This has $\mathcal{O}(x_n^{-3})$ accuracy. Slightly changing the idea, we can write an automatic calculation program in Mathematica:</p>
<pre><code>g[x_] = 0; 
ff[x_] = 3*1/x + 1/x^2 
Do[e = q^n; 
g[x_] = g[x] + 
q^n*Integrate[-D[ 
f[x + 3*q*e + ff[x/q]*e*q, q] - f[x, q] + 
g[x + 3*q + ff[x/q]*q] - g[x] + ff[x/q], {q, 
n + 1}] /. {q -> 0, f -> 0} // Simplify, x]/ 
3/(n + 1)!;, {n, 0, 5}] 
h[x_] = g[x] /. {q -> 1} // Expand</code></pre>
<p>By modifying 5 in {n, 0, 5}, the accuracy can be increased or decreased. The above code gives:</p>
$$f(x)=-\ln x+\frac{5}{6 x}+\frac{2}{3 x^2}+\frac{77}{108 x^3}+\frac{133}{240 x^4}-\frac{2669}{5400 x^5} + \dots$$

<h3>Asymptotic Results and Limit Value</h3>
<p>At this point, we solve</p>
$$x_n+f(x_n)=3(n-k)+x_k+f(x_k),\,\text{given } x_k \text{ as the initial value}$$
<p>Let</p>
$$a=x_k+f(x_k)-3k+\ln 3$$
<p>we get</p>
$$x_n + f(x_n)=3n+a-\ln 3$$
<p>To obtain an explicit asymptotic expression, an iterative formula can be built based on the above equation:</p>
$$x^{(k+1)}_n=3n+a-\ln 3 -f(x^{(k)}_n)$$
<p>Here $x^{(k)}_n$ refers to the $k$-th order approximation of $x_n$. Taking $x^{(0)}_n=3n+a-\ln 3$ as the initial value, iterating and expanding gives:</p>
\begin{aligned}x_n=&3n+a+\ln n+\frac{6 a+6 \ln n-5}{18 n}+\\ 
&\frac{-3 a^2-6 a \ln n+11 a-3 \ln ^2 n+11 \ln n-9}{54 n^2}+\dots\end{aligned}
<p>This is the same as the asymptotic expression given by mathe on the research forum. The Mathematica code for the iteration is (continued from before):</p>
<pre><code>p[n_] = 3*n + a - Log[3]; 
Do[p[n_] = 
Normal[Series[-h[p[n]] + 3*n + a - Log[3], {n, Infinity, 5}]], {i, 
0, 5}] 
Series[p[n], {n, Infinity, 5}]</code></pre>
<p>From this, it is found that $a$ here is exactly the limit value $a$:</p>
$$a=\lim_{n\to\infty} (x_n - 3n - \ln n)$$
<p>This also provides an asymptotic expression for calculating $a$ at the same time:</p>
$$x_k+f(x_k)-3k+\ln 3$$
<p>Using $x_{10^9}$ calculated by wayne and substituting it into the above formula, we get</p>
$$a=1.1352558473155037141953943477479\dots$$

<hr />
<p>
If you need to cite this article, please refer to:<br>
Su Jianlin. (Apr. 09, 2016). "An Implicit Function Solution to a Nonlinear Difference Equation" [Blog post]. Retrieved from https://kexue.fm/archives/3696
</p>
<hr>
<footer style="margin-top: 3em; padding: 1.5em; background: #f5f5f5; border-radius: 8px; font-size: 0.9em; color: #555;">
    <p style="margin: 0 0 0.5em 0;"><strong>Citation</strong></p>
    <p style="margin: 0 0 0.5em 0;">
        This is a machine translation of the original Chinese article:<br>
        <a href="translation_3696.html" style="color: #005fcc;">https://kexue.fm/archives/3696</a>
    </p>
    <p style="margin: 0 0 0.5em 0;">
        Original author: 苏剑林 (Su Jianlin)<br>
        Original publication: <a href="https://kexue.fm" style="color: #005fcc;">科学空间 (Scientific Spaces)</a>
    </p>
    <p style="margin: 0; font-style: italic;">
        Translated using Gemini 3 Flash. Please refer to the original for authoritative content.
    </p>
</footer>
