
    <style type="text/css">

    body {
    margin: 48px auto;
    max-width: 68ch;              /* character-based width reads better */
    padding: 0 16px;

    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                Roboto, "Helvetica Neue", Arial, sans-serif;
    font-size: 18px;
    line-height: 1.65;
    color: #333;
    background: #fafafa;
    }

    h1, h2, h3, h4 {
    line-height: 1.25;
    margin-top: 2.2em;
    margin-bottom: 0.6em;
    font-weight: 600;
    }

    h1 {
    font-size: 2.1em;
    margin-top: 0;
    }

    h2 {
    font-size: 1.6em;
    border-bottom: 1px solid #e5e5e5;
    padding-bottom: 0.3em;
    }

    h3 {
    font-size: 1.25em;
    }

    h4 {
    font-size: 1.05em;
    color: #555;
    }

    /* Paragraphs and lists */
    p {
    margin: 1em 0;
    }

    ul, ol {
    margin: 1em 0 1em 1.5em;
    }

    li {
    margin: 0.4em 0;
    }

    a {
    color: #005fcc;
    text-decoration: none;
    }

    a:hover {
    text-decoration: underline;
    }

    code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.95em;
    background: #f2f2f2;
    padding: 0.15em 0.35em;
    border-radius: 4px;
    }

    pre {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 0.9em;
    background: #f5f5f5;
    padding: 1em 1.2em;
    overflow-x: auto;
    border-radius: 6px;
    line-height: 1.45;
    }

    pre code {
    background: none;
    padding: 0;
    }

    blockquote {
    margin: 1.5em 0;
    padding-left: 1em;
    border-left: 4px solid #ddd;
    color: #555;
    }

    hr {
    border: none;
    border-top: 1px solid #e0e0e0;
    margin: 3em 0;
    }

    table {
    border-collapse: collapse;
    margin: 1.5em 0;
    width: 100%;
    font-size: 0.95em;
    }

    th, td {
    padding: 0.5em 0.7em;
    border-bottom: 1px solid #e5e5e5;
    text-align: left;
    }

    th {
    font-weight: 600;
    }

    img {
    max-width: 100%;
    display: block;
    margin: 1.5em auto;
    }

    small {
    color: #666;
    }

    mjx-container {
    margin: 1em 0;
    }

    ::selection {
    background: #cce2ff;
    }

    </style>
    

<script>
window.MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    tags: 'ams',
    packages: {'[+]': ['ams']}
  }
};
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

<nav style="margin-bottom: 1.5em;">
    <a href="../index.html" style="display: inline-flex; align-items: center; color: #555; text-decoration: none; font-size: 0.95em;">
        <span style="margin-right: 0.3em;">&larr;</span> Back to Index
    </a>
</nav>

<h1><a href="https://kexue.fm/archives/3567">“Entropy” Can't Afford It: From Entropy and the Maximum Entropy Principle to the Maximum Entropy Model (Part 3)</a></h1>

    <p>By 苏剑林 | December 20, 2015</p>


<h2>Recap of the Previous Episode <a href="#上集回顾" id="上集回顾">#</a></h2>

<p>In the <a href="translation_3552.html">previous article</a>, I shared my understanding of the Maximum Entropy Principle, including its significance, methods for solving it, and some simple yet common applications. At the end of the previous post, we also derived the Normal distribution using the Maximum Entropy Principle to illustrate its profound implications and broad significance.</p>

<p>In this article, I will introduce a model based on the Maximum Entropy Principle — the Maximum Entropy Model. This article introduces the Maximum Entropy Model through the lens of a <strong>supervised classification problem</strong>. "Supervised" means that the model is built based on data that has already been labeled.</p>

<p>In fact, the Maximum Entropy Principle discussed in the second article is the primary concept; the Maximum Entropy Model is essentially just an extension or application of that principle.</p>

<h2>Maximum Entropy Model <a href="#最大熵模型" id="最大熵模型">#</a></h2>

<h3>Classification: What Does It Mean? <a href="#分类：意味着什么？" id="分类：意味着什么？">#</a></h3>

<p>Before introducing the Maximum Entropy Model, let's discuss what a classification problem entails. Suppose we have a batch of labeled data:</p>

<p>
$$\begin{array}{c|cccccccc}
\hline
\text{Data } x & 1 & 2 & 3 & 4 & 5 & 6 & \dots & 100 \\
\hline
\text{Label } y & 1 & 0 & 1 & 0 & 1 & 0 & \dots & 0\\
\hline \end{array}$$
</p>

<p>A classification problem means providing a model where, if I tell the model $x$, the model can tell me the corresponding $y$. Therefore, it is natural to view the classification problem as a <strong>fitting problem</strong> — that is, finding a function $y=f(x)$ to fit this batch of data. Many functions can be used for fitting, ranging from simple linear functions (linear regression) and Logistic functions (Logistic regression) to complex multilayer neural networks. All of these resolve classification by treating it as a fitting problem.</p>

<p>However, this is not the only perspective. We can also look at classification from a <strong>probabilistic</strong> point of view. Since there is almost nothing certain in this world, when we input $x$, the output value $y$ is not deterministic. For example, in the data above, when we input 1, it outputs 1 or 0 with a certain probability, it's just that the probability of 1 is higher. In this case, the classification problem becomes a matter of finding the probability distribution of $y$ given $x$, which is to find the conditional distribution $p(Y|X)$.</p>

<p>As we learned in the previous article, the Maximum Entropy Principle is naturally designed to find probability distributions. Therefore, the Maximum Entropy Principle naturally integrates with classification problems to produce the Maximum Entropy Model.</p>

<h3>Maximum Entropy Model <a href="#最大熵模型-1" id="最大熵模型-1">#</a></h3>

<p>Now, the classification problem has been transformed into finding the conditional distribution $p(Y|X)$. We still use the Maximum Entropy Principle to solve it. The difference is that since we are dealing with a conditional distribution, the entropy we need to maximize is the conditional entropy (refer to <a href="translation_3534.html">Part 1</a>):</p>

\begin{equation}
S(Y|X)=S[p(x,y)]-S[p(x)] \tag{37}
\end{equation}

<p>And since</p>

\begin{equation}
p(y|x)=\frac{p(x,y)}{p(x)} \tag{38}
\end{equation}

<p>Finding $p(x,y)$ and $p(x)$ allows us to find the conditional distribution $p(Y|X)$. Here, both $p(x,y)$ and $p(x)$ are unknown. However, we assume that through extensive statistics, we can derive the empirical distribution $\tilde{p}(x)$ of $x$ (since $x$ is merely the data collected, this statistical estimation is theoretically feasible). Thus, the only unknown distribution is $p(x,y)$. We concentrate on solving for it. At this point, maximizing equation $(37)$ is equivalent to maximizing $S[p(x,y)]$.</p>

<p>How do we determine the relationship between $x$ and $y$? Simple: <strong>Statistics</strong>! By analyzing the labeled data, we can derive the probabilistic relationships between them. To describe this mathematically, we need to define <strong>feature functions</strong>:</p>

\begin{equation}
\chi(x,y)=\left\{\begin{aligned}&1,\quad x,y \text{ satisfy a certain fact}\\
&0,\quad x,y \text{ do not satisfy a certain fact}\end{aligned}\right. \tag{39}
\end{equation}

<p>For example, in the labeled data table provided above, we notice that when $x$ is odd, $y=1$, and when $x$ is even, $y=0$. Thus, we suspect the result is related to parity. Therefore, we can define a feature function:</p>

\begin{equation}
\chi(x,y)=\left\{\begin{aligned}&1,\quad \text{when } x \text{ is odd and } y=1\\
&0,\quad \text{otherwise}\end{aligned}\right. \tag{40}
\end{equation}

<p>Next, we count the number of instances $N_{\chi}$ that satisfy the feature function and divide by the total number of samples $N$ to get $\tau = N_{\chi}/N$. We believe that when there is enough data, this "count" represents the average result:</p>

\begin{equation}
E[\chi(x,y)]=\sum_{x,y} p(x,y)\chi(x,y)=\tau \tag{41}
\end{equation}

<p>We can define multiple features to obtain multiple feature functions and multiple statistical results:</p>

\begin{equation}
\left\{\begin{aligned}&E[\chi_1(x,y)]=\sum_{x,y} p(x,y)\chi_1(x,y)=\tau_1\\
&\vdots\\
&E[\chi_k(x,y)]=\sum_{x,y} p(x,y)\chi_k(x,y)=\tau_k\end{aligned}\right. \tag{42}
\end{equation}

<p>These become constraints for the maximum entropy. Thus, it becomes a <strong>constrained maximization problem</strong>. In the second part, we already provided the result (similar to equation $(20)$):</p>

\begin{equation}
p(x,y)=\frac{1}{Z}\exp\left(-\sum_{i=1}^k \lambda_i \chi_i (x,y)\right) \tag{43}
\end{equation}

<p>where</p>

\begin{equation}
Z=\sum_{x,y} \exp\left(-\sum_{i=1}^k \lambda_i \chi_i (x,y)\right) \tag{44}
\end{equation}

<p>Note that we have solved for $p(x,y)$ here. If we are only interested in $p(y|x)$, it is better to convert it to the $p(y|x)$ form, namely:</p>

\begin{equation}
p(y|x)=\frac{p(x,y)}{p(x)}=\frac{1}{Z(x)}\exp\left(-\sum_{i=1}^k \lambda_i \chi_i (x,y)\right) \tag{45}
\end{equation}

<p>Here, $Z(x)=Z \times p(x)$ is the normalization factor related to $x$.</p>

<h2>A Brief Discussion on Model Application <a href="#浅谈模型的应用" id="浅谈模型的应用">#</a></h2>

<p>Next is the issue of model solving. As mentioned, models related to the Maximum Entropy Principle have characteristics such as simple forms and strong adaptability. However, it has a fatal flaw — it is difficult to solve, and generally can only be solved through numerical methods. I do not have particular insights in this area, so I won't go into detail. Interested readers can refer to other literature, such as <a href="http://blog.csdn.net/itplus/article/details/26550369">here</a>.</p>

<p>Let's talk more carefully about how to use the Maximum Entropy Model. Suppose we extract a feature, and this feature has $N$ possible values (for example, the feature is the part-of-speech of a word, with values like verb, noun, adjective, etc.), and we are performing binary classification (such as sentiment analysis, positive or negative). In that case, we can actually construct $2N$ feature functions (verb-positive, noun-positive, verb-negative, noun-negative, and other combinations). Furthermore, if multiple features are extracted, the number of feature functions will be quite substantial. Therefore, the main work of the Maximum Entropy Model lies in (manual) feature extraction. Once feature extraction is completed, the Maximum Entropy Model provides an optimal scheme for utilizing those features (the entropy maximization scheme).</p>

<p><strong>Therefore, although the Maximum Entropy Model has strong adaptability (because it can solve for probability distributions based on any arbitrary constraints we propose, with no theoretical limit on the number of constraints) and yields very good results (if it can be solved, the effects are usually excellent), its application is relatively narrow because we lack general means to extract features effectively. Consequently, the Maximum Entropy Model is rarely used directly for general classification problems. Especially after deep learning algorithms became popular, the powerful fitting capabilities and excellent performance of multilayer neural networks mean that we almost never use the Maximum Entropy Model in standard classification problems anymore.</strong></p>

<p>So when is this Maximum Entropy Model used? We generally "pick out" problems suitable for the Maximum Entropy Model (generally, where the feature values are binary or there aren't many features). In these cases, it is suitable to use the Maximum Entropy Model, and as a standalone model, its results are generally better than other models (please recall the significance of maximum entropy).</p>

<h2>Conclusion <a href="#结束语" id="结束语">#</a></h2>

<p><strong>This series concludes here. Many online articles or books also explain the derivation and solving of the Maximum Entropy Model, but I still feel that the way it's taught in textbooks is not clear or explicit enough. Aspects such as the definition of entropy, the meaning of entropy, the significance of maximum entropy, and the derivation of the Maximum Entropy Model were not entirely satisfying to me. Therefore, combining my own understanding, I wrote these three brief articles, both as my own notes and as a way to share my understanding with everyone. If there are any inaccuracies, I welcome corrections from readers.</strong></p>

<p><strong>In this series, the Maximum Entropy Model served only as a springboard. In fact, the focus of the three articles is the concept of entropy and the Maximum Entropy Principle; they are what TRULY deserve repeated contemplation. Entropy quantifies information and uncertainty, and we can use it to do many things. Although this series has ended, content regarding information and entropy will still appear frequently in future posts on this blog, because there is simply too much wonderful and necessary content to say about entropy.</strong></p>

<p>Regarding the Maximum Entropy Model, readers can also refer to Mr. Wu Jun's "The Beauty of Mathematics" (数学之美). The book contains two chapters introducing the Maximum Entropy Model, along with many other data analysis materials and stories, all of which are well worth reading.</p>
<hr>
<footer style="margin-top: 3em; padding: 1.5em; background: #f5f5f5; border-radius: 8px; font-size: 0.9em; color: #555;">
    <p style="margin: 0 0 0.5em 0;"><strong>Citation</strong></p>
    <p style="margin: 0 0 0.5em 0;">
        This is a machine translation of the original Chinese article:<br>
        <a href="https://kexue.fm/archives/3567" style="color: #005fcc;">https://kexue.fm/archives/3567</a>
    </p>
    <p style="margin: 0 0 0.5em 0;">
        Original author: 苏剑林 (Su Jianlin)<br>
        Original publication: <a href="https://kexue.fm" style="color: #005fcc;">科学空间 (Scientific Spaces)</a>
    </p>
    <p style="margin: 0; font-style: italic;">
        Translated using Gemini 3 Flash. Please refer to the original for authoritative content.
    </p>
</footer>
